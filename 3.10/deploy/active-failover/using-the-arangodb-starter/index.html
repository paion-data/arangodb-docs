<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta property="og:url" content="http://localhost/3.10/deploy/active-failover/using-the-arangodb-starter/"><meta property="og:title" content="Create an Active Failover deployment using the ArangoDB Starter"><meta property="og:type" content="website"><meta property="og:description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta name=docsearch:version content="3.10"><title>Create an Active Failover deployment using the ArangoDB Starter | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.10"><a itemprop=item class=link href=/3.10/><span itemprop=name class=breadcrumb-entry>3.10.14</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Deploy"><a itemprop=item class=link href=/3.10/deploy/><span itemprop=name class=breadcrumb-entry>Deploy</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Active Failover"><a itemprop=item class=link href=/3.10/deploy/active-failover/><span itemprop=name class=breadcrumb-entry>Active Failover</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Using the ArangoDB Starter"><a itemprop=item class=link href=/3.10/deploy/active-failover/using-the-arangodb-starter/><span itemprop=name class=breadcrumb-entry>Using the ArangoDB Starter</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.10 reached End of Life (EOL) and is no longer supported.</p><p>This documentation is outdated. Please see the most recent <a href=/3.12/ class=link>stable version</a>.</p></div></div></div></div><hgroup><h1>Create an Active Failover deployment using the ArangoDB Starter</h1></hgroup><p>This section describes how to start an Active Failover setup the tool <a href=/3.10/components/tools/arangodb-starter/ class=link><em>Starter</em></a>
(the <em>arangodb</em> binary program).</p><p>As a precondition you should create a <em>secret</em> to activate authentication. The <em>Starter</em> provides a handy
functionality to generate such a file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>arangodb create jwt-secret --secret<span class=o>=</span>arangodb.secret
</span></span></code></pre></div><p>Set appropriate privilege on the generated <em>secret</em> file, e.g. on Linux:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>400</span> arangodb.secret
</span></span></code></pre></div><h2 id=local-active-failover-test-deployment>Local Active Failover test deployment <a href=/3.10/deploy/active-failover/using-the-arangodb-starter/#local-active-failover-test-deployment class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>If you want to start a local <em>Active Failover</em> setup quickly, use the <code>--starter.local</code>
option of the <em>Starter</em>. This will start all servers within the context of a single
starter process:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>arangodb --starter.local --starter.mode<span class=o>=</span>activefailover --starter.data-dir<span class=o>=</span>./localdata --auth.jwt-secret<span class=o>=</span>/etc/arangodb.secret --agents.agency.supervision-grace-period<span class=o>=</span><span class=m>30</span>
</span></span></code></pre></div><p>Please adapt the path to your <em>secret</em> file accordingly.</p><p>Note that to avoid unnecessary failovers, it may make sense to increase the value
for the startup option <code>--agents.agency.supervision-grace-period</code> to a value
beyond 30 seconds.</p><p><strong>Note:</strong> When you restart the <em>Starter</em>, it remembers the original <code>--starter.local</code> flag.</p><h2 id=multiple-machines>Multiple Machines <a href=/3.10/deploy/active-failover/using-the-arangodb-starter/#multiple-machines class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>If you want to start an Active Failover setup using the <em>Starter</em>, you need to copy the
<em>secret</em> file to every machine and use the <code>--starter.mode=activefailover</code> option of the
<em>Starter</em>. A 3 &ldquo;machine&rdquo; <em>Agency</em> is started as well as 3 single servers,
that perform asynchronous replication and failover:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>arangodb --starter.mode<span class=o>=</span>activefailover --starter.data-dir<span class=o>=</span>./data --auth.jwt-secret<span class=o>=</span>/etc/arangodb.secret --agents.agency.supervision-grace-period<span class=o>=</span><span class=m>30</span> --starter.join A,B,C
</span></span></code></pre></div><p>Please adapt the path to your <em>secret</em> file accordingly.</p><p>Note that to avoid unnecessary failovers, it may make sense to increase the value
for the startup option <code>--agents.agency.supervision-grace-period</code> to a value
beyond 30 seconds.</p><p>Run the above command on machine A, B & C.</p><p>Once all the processes started by the <em>Starter</em> are up and running, and joined the
Active Failover setup (this may take a while depending on your system), the <em>Starter</em> will inform
you where to connect the Active Failover from a Browser, shell or your program.</p><p>For a full list of options of the <em>Starter</em> please refer to <a href=/3.10/components/tools/arangodb-starter/options/ class=link>this</a>
section.</p><h2 id=using-the-arangodb-starter-in-docker>Using the ArangoDB Starter in Docker <a href=/3.10/deploy/active-failover/using-the-arangodb-starter/#using-the-arangodb-starter-in-docker class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The <em>Starter</em> can also be used to launch an Active Failover setup based on <em>Docker</em>
containers. To do this, you can use the normal Docker arguments, combined with
<code>--starter.mode=activefailover</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>IP</span><span class=o>=</span>&lt;IP of docker host&gt;
</span></span><span class=line><span class=cl>docker volume create arangodb
</span></span><span class=line><span class=cl>docker run -it --name<span class=o>=</span>adb --rm -p 8528:8528 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v arangodb:/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v /var/run/docker.sock:/var/run/docker.sock <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    arangodb/arangodb-starter <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --agents.agency.supervision-grace-period<span class=o>=</span><span class=m>30</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.address<span class=o>=</span><span class=nv>$IP</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.mode<span class=o>=</span>activefailover <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.join<span class=o>=</span>A,B,C <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker.net-mode<span class=o>=</span>default
</span></span></code></pre></div><p>Run the above command on machine A, B & C.</p><p>Note that to avoid unnecessary failovers, it may make sense to increase the value
for the startup option <code>--agents.agency.supervision-grace-period</code> to a value
beyond 30 seconds.</p><p>The <em>Starter</em> will decide on which 2 machines to run a single server instance.
To override this decision (only valid while bootstrapping), add a
<code>--cluster.start-single=false</code> to the machine where the single server
instance should <em>not</em> be started.</p><p>If you use the Enterprise Edition Docker image, you have to set the license key
in an environment variable by adding this option to the above <code>docker</code> command:</p><pre tabindex=0><code>    -e ARANGO_LICENSE_KEY=&lt;the-key&gt;
</code></pre><p>You can get a free evaluation license key by visiting:</p><p><a href=https://www.arangodb.com/download-arangodb-enterprise/ target=_blank rel="noopener noreferrer" class=link>www.arangodb.com/download-arangodb-enterprise/</a>&nbsp;<i class="fas fa-external-link-alt"></i></p><p>Then replace <code>&lt;the-key></code> above with the actual license key. The start
will then hand on the license key to the Docker containers it launches
for ArangoDB.</p><h3 id=tls-verified-docker-services>TLS verified Docker services <a href=/3.10/deploy/active-failover/using-the-arangodb-starter/#tls-verified-docker-services class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Oftentimes, one needs to harden Docker services using client certificate
and TLS verification. The Docker API allows subsequently only certified access.
As the ArangoDB starter starts the ArangoDB cluster instances using this Docker API,
it is mandatory that the ArangoDB starter is deployed with the proper certificates
handed to it, so that the above command is modified as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>IP</span><span class=o>=</span>&lt;IP of docker host&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DOCKER_TLS_VERIFY</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DOCKER_CERT_PATH</span><span class=o>=</span>/path/to/certificate
</span></span><span class=line><span class=cl>docker volume create arangodb
</span></span><span class=line><span class=cl>docker run -it --name<span class=o>=</span>adb --rm -p 8528:8528 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v arangodb:/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v /var/run/docker.sock:/var/run/docker.sock <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v /path/to/certificate:/path/to/certificate
</span></span><span class=line><span class=cl>    arangodb/arangodb-starter <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --agents.agency.supervision-grace-period<span class=o>=</span><span class=m>30</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.address<span class=o>=</span><span class=nv>$IP</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.mode<span class=o>=</span>activefailover <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.join<span class=o>=</span>A,B,C <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker.net-mode<span class=o>=</span>default
</span></span></code></pre></div><p>Note that the environment variables <code>DOCKER_TLS_VERIFY</code> and <code>DOCKER_CERT_PATH</code>
as well as the additional mountpoint containing the certificate have been added above.
directory. The assignment of <code>DOCKER_CERT_PATH</code> is optional, in which case it
is mandatory that the certificates are stored in <code>$HOME/.docker</code>. So
the command would then be as follows</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>IP</span><span class=o>=</span>&lt;IP of docker host&gt;
</span></span><span class=line><span class=cl>docker volume create arangodb
</span></span><span class=line><span class=cl>docker run -it --name<span class=o>=</span>adb --rm -p 8528:8528 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v arangodb:/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v /var/run/docker.sock:/var/run/docker.sock <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v /path/to/cert:/root/.docker <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=nv>DOCKER_TLS_VERIFY</span><span class=o>=</span><span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    arangodb/arangodb-starter <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --agents.agency.supervision-grace-period<span class=o>=</span><span class=m>30</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.address<span class=o>=</span><span class=nv>$IP</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.mode<span class=o>=</span>activefailover <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --starter.join<span class=o>=</span>A,B,C <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker.net-mode<span class=o>=</span>default
</span></span></code></pre></div><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.10/deploy/active-failover/manual-start/><i class="fas fa-chevron-left fa-fw"></i><p>Manual Start</p></a></span><span class=next><a class="nav nav-next link" href=/3.10/deploy/active-failover/administration/><p>Administration</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.10/deploy/active-failover/using-the-arangodb-starter.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#local-active-failover-test-deployment>Local Active Failover test deployment</a></div><div class=level-2><a href=#multiple-machines>Multiple Machines</a></div><div class=level-2><a href=#using-the-arangodb-starter-in-docker>Using the ArangoDB Starter in Docker</a></div><div class=level-3><a href=#tls-verified-docker-services>TLS verified Docker services</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>