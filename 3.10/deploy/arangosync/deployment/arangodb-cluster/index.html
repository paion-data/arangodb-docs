<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta property="og:url" content="http://localhost/3.10/deploy/arangosync/deployment/arangodb-cluster/"><meta property="og:title" content="Set up ArangoDB clusters for Datacenter-to-Datacenter Replication"><meta property="og:type" content="website"><meta property="og:description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta name=docsearch:version content="3.10"><title>Set up ArangoDB clusters for Datacenter-to-Datacenter Replication | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.10"><a itemprop=item class=link href=/3.10/><span itemprop=name class=breadcrumb-entry>3.10.14</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Deploy"><a itemprop=item class=link href=/3.10/deploy/><span itemprop=name class=breadcrumb-entry>Deploy</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Datacenter-to-Datacenter Replication"><a itemprop=item class=link href=/3.10/deploy/arangosync/><span itemprop=name class=breadcrumb-entry>Datacenter-to-Datacenter Replication</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Deployment"><a itemprop=item class=link href=/3.10/deploy/arangosync/deployment/><span itemprop=name class=breadcrumb-entry>Deployment</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="ArangoDB Cluster"><a itemprop=item class=link href=/3.10/deploy/arangosync/deployment/arangodb-cluster/><span itemprop=name class=breadcrumb-entry>ArangoDB Cluster</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.10 reached End of Life (EOL) and is no longer supported.</p><p>This documentation is outdated. Please see the most recent <a href=/3.12/ class=link>stable version</a>.</p></div></div></div></div><hgroup><h1>Set up ArangoDB clusters for Datacenter-to-Datacenter Replication</h1></hgroup><p>There are several ways to start an ArangoDB cluster. This section focuses
on the recommended way to start ArangoDB: the ArangoDB <em>Starter</em>.</p><p>For other possibilities to deploy an ArangoDB cluster see
<a href=/3.10/deploy/cluster/deployment/ class=link>Cluster Deployment</a>.</p><p>The <em>Starter</em> simplifies things for the operator and coordinates a distributed
cluster startup across several machines and assign cluster roles automatically.</p><p>When started on several machines and enough machines have joined, the <em>Starters</em>
start <em>Agents</em>, <em>Coordinators</em> and <em>DB-Servers</em> on these machines.</p><p>The <em>Starter</em> supervises its child tasks (namely <em>Coordinators</em>,
<em>DB-Servers</em> and <em>Agents</em>) and restarts them in case of failures.</p><p>Datacenter-to-Datacenter Replication (DC2DC) requires a normal ArangoDB cluster in both datacenters
and one or more (<code>arangosync</code>) syncmasters & syncworkers in both datacenters.
The Starter enables you to run these syncmasters & syncworkers in combination with your normal
cluster.</p><p>To run a starter with DC2DC support, you set the following arguments in addition to the
commands to start a cluster with the Starter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--auth.jwt-secret<span class=o>=</span>&lt;path of file containing JWT secret <span class=k>for</span> communication in <span class=nb>local</span> cluster&gt;
</span></span><span class=line><span class=cl>--starter.address<span class=o>=</span>&lt;publicly visible address of this machine&gt;
</span></span><span class=line><span class=cl>--starter.sync
</span></span><span class=line><span class=cl>--sync.master.jwt-secret<span class=o>=</span>&lt;path of file containing JWT secret used <span class=k>for</span> communication between <span class=nb>local</span> syncmaster <span class=p>&amp;</span> workers&gt;
</span></span><span class=line><span class=cl>--sync.server.keyfile<span class=o>=</span>&lt;path of keyfile containing TLS certificate <span class=p>&amp;</span> key <span class=k>for</span> <span class=nb>local</span> syncmaster&gt;
</span></span><span class=line><span class=cl>--sync.server.client-cafile<span class=o>=</span>&lt;path of file containing CA certificate <span class=k>for</span> syncmaster client authentication&gt;
</span></span></code></pre></div><p>See <a href=/3.10/deploy/arangosync/security/ class=link>Securing Datacenter-to-Datacenter Replication</a>
for instructions how to create all certificates and keyfiles.</p><p>To start the cluster using a <code>systemd</code> unit file (and start DC2DC replication
later manually), use the following:</p><pre tabindex=0><code class=language-conf data-lang=conf>[Unit]
Description=Run the ArangoDB Starter
After=network.target

[Service]
Restart=on-failure
EnvironmentFile=/etc/arangodb.env
EnvironmentFile=/etc/arangodb.env.local
Environment=DATADIR=/var/lib/arangodb/cluster
ExecStartPre=/usr/bin/sh -c &#34;mkdir -p ${DATADIR}&#34;
ExecStart=/usr/bin/arangodb \
    --starter.address=${PRIVATEIP} \
    --starter.data-dir=${DATADIR} \
    --starter.join=${STARTERENDPOINTS} \
    --auth.jwt-secret=${CLUSTERSECRETPATH}
TimeoutStopSec=60
LimitNOFILE=1048576

[Install]
WantedBy=multi-user.target
</code></pre><h2 id=cluster-authentication>Cluster authentication <a href=/3.10/deploy/arangosync/deployment/arangodb-cluster/#cluster-authentication class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The communication between the cluster nodes use a token (JWT) to authenticate.
This must be shared between cluster nodes.</p><p>Sharing secrets is obviously a very delicate topic. The above workflow assumes
that the operator puts a secret in a file named <code>${CLUSTERSECRETPATH}</code>.</p><p>We recommend to use a dedicated system for managing secrets like HashiCorp&rsquo;s <code>Vault</code>.</p><h2 id=required-ports>Required ports <a href=/3.10/deploy/arangosync/deployment/arangodb-cluster/#required-ports class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>As soon as enough machines have joined, the <em>Starter</em> begins starting <em>Agents</em>,
<em>Coordinators</em> and <em>DB-Servers</em>.</p><p>Each of these tasks needs a port to communicate. Please make sure that the following
ports are available on all machines:</p><ul><li><code>8529</code> for Coordinators</li><li><code>8530</code> for DB-Servers</li><li><code>8531</code> for Agents</li></ul><p>The <em>Starter</em> itself uses port <code>8528</code>.</p><h2 id=recommended-deployment-environment>Recommended deployment environment <a href=/3.10/deploy/arangosync/deployment/arangodb-cluster/#recommended-deployment-environment class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Since the <em>Agents</em> are so critical to the availability of both the ArangoDB and
the ArangoSync cluster, it is recommended to run <em>Agents</em> on dedicated machines.
They run a real-time system for the elections and bad performance can negatively
affect the availability of the whole cluster.</p><p><em>DB-Servers</em> are also important and you do not want to lose them, but
depending on your replication factor, the system can tolerate some
loss and bad performance slows things down but not stop things from
working.</p><p><em>Coordinators</em> can be deployed on other machines, since they do not hold
persistent state. They might have some in-memory state about running
transactions or queries, but losing a Coordinator does not lose any
persisted data. Furthermore, new Coordinators can be added to a cluster
without much effort.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.10/deploy/arangosync/deployment/><i class="fas fa-chevron-left fa-fw"></i><p>Deployment</p></a></span><span class=next><a class="nav nav-next link" href=/3.10/deploy/arangosync/deployment/arangosync-master/><p>ArangoSync Master</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.10/deploy/arangosync/deployment/arangodb-cluster.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#cluster-authentication>Cluster authentication</a></div><div class=level-2><a href=#required-ports>Required ports</a></div><div class=level-2><a href=#recommended-deployment-environment>Recommended deployment environment</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>