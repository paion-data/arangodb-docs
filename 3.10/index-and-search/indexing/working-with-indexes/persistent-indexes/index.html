<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743775370></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="The persistent index type is a generic kind of index you can define over a single or multiple document attributes, as well as arrays"><meta property="og:url" content="http://localhost/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/"><meta property="og:title" content="Persistent indexes"><meta property="og:type" content="website"><meta property="og:description" content="The persistent index type is a generic kind of index you can define over a single or multiple document attributes, as well as arrays"><meta name=docsearch:version content="3.10"><title>Persistent indexes | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743775370 defer></script>
<script src=/js/featherlight.min.js?1743775370 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743775370 defer></script>
<script src=/js/theme.js?1743775370 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.10"><a itemprop=item class=link href=/3.10/><span itemprop=name class=breadcrumb-entry>3.10.14</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Index and Search"><a itemprop=item class=link href=/3.10/index-and-search/><span itemprop=name class=breadcrumb-entry>Index and Search</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Indexing"><a itemprop=item class=link href=/3.10/index-and-search/indexing/><span itemprop=name class=breadcrumb-entry>Indexing</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Working with Indexes"><a itemprop=item class=link href=/3.10/index-and-search/indexing/working-with-indexes/><span itemprop=name class=breadcrumb-entry>Working with Indexes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Persistent Indexes"><a itemprop=item class=link href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/><span itemprop=name class=breadcrumb-entry>Persistent Indexes</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.10 reached End of Life (EOL) and is no longer supported.</p><p>This documentation is outdated. Please see the most recent <a href=/3.12/index-and-search/indexing/working-with-indexes/persistent-indexes/ class=link>stable version</a>.</p></div></div></div></div><hgroup><h1>Persistent indexes</h1><p class=lead>The persistent index type is a generic kind of index you can define over a single or multiple document attributes, as well as arrays</p></hgroup><p>It is possible to define a persistent index on one or more document attributes
(or attribute paths).
The index is then used in queries to locate documents with a specific index attribute value
or to find documents whose index attribute value(s) are in a given range.</p><p>For example, you can create a persistent index on the attributes <code>value1</code> and
<code>value2</code> with the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>collection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>]</span> <span class=p>});</span></span></span></code></pre></div><p>If you declare an index to be <code>unique</code>, then no two documents are allowed to have
the same set of attribute values. Creating a new document or updating a document
will fail if the uniqueness is violated:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>collection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>],</span> <span class=nx>unique</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span></span></span></code></pre></div><p>If you declare an index to be <code>sparse</code>, a document will be excluded from the index
and no uniqueness checks will be performed if any index attribute value is not
set or has a value of <code>null</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>collection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>],</span> <span class=nx>sparse</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span></span></span></code></pre></div><p>To store additional attributes in the index, you can set the <code>storedValues</code>
option:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>collection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>],</span> <span class=nx>storedValues</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value3&#34;</span><span class=p>]</span> <span class=p>});</span></span></span></code></pre></div><p>To enable in-memory caching of index entries, which can be used when doing point
lookups on the index, you can set the <code>cacheEnabled</code> option:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>collection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span> <span class=p>],</span> <span class=nx>cacheEnabled</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span></span></span></code></pre></div><h2 id=storing-additional-values-in-indexes>Storing additional values in indexes <a href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/#storing-additional-values-in-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p><small>Introduced in: v3.10.0</small></p><p>Persistent indexes allow you to store additional attributes in the index that
can be used to satisfy projections of the document. They cannot be used for
index lookups or for sorting, but for projections only. They allow persistent
indexes to fully cover more queries and avoid extra document lookups. This can
have a great positive effect on index scan performance if the number of scanned
index entries is large.</p><p>You can set the <code>storedValues</code> option and specify the additional attributes as
an array of attribute paths when creating a new persistent index, similar to
the <code>fields</code> option:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>storedValues</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>This will index the <code>value1</code> attribute in the traditional sense, so that the index
can be used for looking up by <code>value1</code> or for sorting by <code>value1</code>. The index also
supports projections on <code>value1</code> as usual.</p><p>In addition, due to <code>storedValues</code> being used here, the index can now also
supply the values for the <code>value2</code> attribute for projections without having to
look up the full document. Non-existing attributes are stored as <code>null</code> values.</p><p>The maximum number of attributes that you can use in <code>storedValues</code> is 32.
You cannot specify the same attribute path in both, the <code>fields</code> and the
<code>storedValues</code> option. If there is an overlap, the index creation will abort
with an error message.</p><p>In unique indexes, only the index attributes in <code>fields</code> are checked for
uniqueness. The index attributes in <code>storedValues</code> are not checked for their
uniqueness.</p><p>You cannot create multiple persistent indexes with the same <code>fields</code> attributes
and uniqueness option but different <code>storedValues</code> settings. That means the
value of <code>storedValues</code> is not considered by calls to <code>ensureIndex()</code> when
checking if an index is already present or needs to be created.</p><h2 id=caching-of-index-values>Caching of index values <a href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/#caching-of-index-values class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p><small>Introduced in: v3.10.0</small></p><p>You can optionally put an in-memory hash cache in front of persistent indexes.
By default, persistent indexes will not have an in-memory cache. You can enable
it when creating an index by setting the <code>cacheEnabled</code> option to <code>true</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>cacheEnabled</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>You cannot create multiple persistent indexes with the same <code>fields</code> attributes
and uniqueness option but different <code>cacheEnabled</code> settings. That means the
value of <code>cacheEnabled</code> is not considered by calls to <code>ensureIndex()</code> when
checking if an index is already present or needs to be created.</p><p>The in-memory cache for an index will be initially empty, even if the index
contains data. The cache will be populated lazily upon querying data from the
index when using equality lookups for all index attributes. Cache entries get
invalidated when modifying data in the underlying collection. Only the affected
index entries will get invalidated.</p><p>As the cache is hash-based and unsorted, it cannot be used for full or partial
range scans, for sorting, or for lookups that do not include all index attributes.</p><p>Filling the caches upon cache misses during lookups and upon writing to the
collection can mean extra overhead, so it is recommended to use an in-memory cache
only for collections that are accessed mostly for reading via equality lookups,
and that are not often written to.</p><p>For AQL queries that will use indexes with an enabled in-memory cache and that are
known to not benefit from using using the cache, you may turn off the usage of
the cache for individual query parts. This can be achieved
via the <code>useCache</code> hint that can be provided to an AQL <code>FOR</code> loop:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>collection</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>useCache</span><span class=o>:</span> <span class=kc>false</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=nv>@lookup</span>
</span></span><span class=line><span class=cl>  <span class=o>..</span><span class=p>.</span></span></span></code></pre></div><p>Using the <code>useCache</code> option will have no effect for indexes that do not have a
cache enabled, or for queries that are not eligible to use caches.</p><p>The number of index cache hits and misses is also reported when profiling queries.
You can use this information to assess the effectiveness of the cache for
particular queries.</p><p>You can control the maximum combined memory usage of all in-memory caches via
the existing <code>--cache.size</code> startup option, which not only controls the maximum
memory usage for all edge caches, but additionally also the memory usage for all
caches for persistent indexes.</p><h2 id=accessing-persistent-indexes-from-the-shell>Accessing Persistent Indexes from the Shell <a href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/#accessing-persistent-indexes-from-the-shell class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Ensures that a unique persistent index exists:</p><p><code>collection.ensureIndex({ type: "persistent", fields: [ "field1", ..., "fieldn" ], unique: true })</code></p><p>Creates a unique persistent index on all documents using <code>field1</code>, &mldr; <code>fieldn</code>
as attribute paths. At least one attribute path has to be given. The index will
be non-sparse by default.</p><p>All documents in the collection must differ in terms of the indexed
attributes. Creating a new document or updating an existing document will
will fail if the attribute uniqueness is violated.</p><hr><p>To create a sparse unique index, set the <code>sparse</code> attribute to <code>true</code>:</p><p><code>collection.ensureIndex({ type: "persistent", fields: [ "field1", ..., "fieldn" ], unique: true, sparse: true })</code></p><p>In a sparse index all documents will be excluded from the index that do not
contain at least one of the specified index attributes or that have a value
of <code>null</code> in any of the specified index attributes. Such documents will
not be indexed, and not be taken into account for uniqueness checks.</p><p>In a non-sparse index, these documents will be indexed (for non-present
indexed attributes, a value of <code>null</code> will be used) and will be taken into
account for uniqueness checks.</p><p>In case that the index was successfully created, an object with the index
details, including the index-identifier, is returned.</p><p><strong>Examples</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;myId&#34;</span> <span class=p>],</span> <span class=nx>unique</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;myId&#34;</span><span class=o>:</span> <span class=mi>123</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;myId&#34;</span><span class=o>:</span> <span class=mi>456</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;myId&#34;</span><span class=o>:</span> <span class=mi>789</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;myId&#34;</span><span class=o>:</span> <span class=mi>123</span> <span class=p>});</span>  
</span></span></code></pre></div><div class=expand><a class=expand-label onclick=toggleExpandShortcode(event)>Show output</a><div class=expand-content style=display:none><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;cacheEnabled&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;deduplicate&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;estimates&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;fields&#34;</span> <span class=o>:</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;myId&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>],</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82115&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;isNewlyCreated&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=s2>&#34;idx_1795421255581564928&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;selectivityEstimate&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;sparse&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span> <span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;unique&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;code&#34;</span> <span class=o>:</span> <span class=mi>201</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82119&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82119&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4PK---&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82121&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82121&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4PK--_&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82123&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82123&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4PK--A&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>ArangoError</span> <span class=mi>1210</span><span class=o>:</span> <span class=nx>unique</span> <span class=nx>constraint</span> <span class=nx>violated</span> <span class=o>-</span> <span class=k>in</span> <span class=nx>index</span> <span class=nx>idx_1795421255581564928</span> <span class=k>of</span> <span class=nx>type</span> <span class=nx>persistent</span> <span class=nx>over</span> <span class=s1>&#39;myId&#39;</span><span class=p>;</span> <span class=nx>conflicting</span> <span class=nx>key</span><span class=o>:</span> <span class=mi>82119</span><span class=p>]</span></span></span></code></pre></div></div></div><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;name.first&#34;</span><span class=p>,</span> <span class=s2>&#34;name.last&#34;</span> <span class=p>],</span> <span class=nx>unique</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;hans&#34;</span><span class=p>,</span> <span class=s2>&#34;last&#34;</span><span class=o>:</span> <span class=s2>&#34;hansen&#34;</span> <span class=p>}});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;jens&#34;</span><span class=p>,</span> <span class=s2>&#34;last&#34;</span><span class=o>:</span> <span class=s2>&#34;jensen&#34;</span> <span class=p>}});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;hans&#34;</span><span class=p>,</span> <span class=s2>&#34;last&#34;</span><span class=o>:</span> <span class=s2>&#34;jensen&#34;</span> <span class=p>}});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>ids</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;hans&#34;</span><span class=p>,</span> <span class=s2>&#34;last&#34;</span><span class=o>:</span> <span class=s2>&#34;hansen&#34;</span> <span class=p>}});</span>  
</span></span></code></pre></div><div class=expand><a class=expand-label onclick=toggleExpandShortcode(event)>Show output</a><div class=expand-content style=display:none><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;cacheEnabled&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;deduplicate&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;estimates&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;fields&#34;</span> <span class=o>:</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name.first&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;name.last&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>],</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82133&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;isNewlyCreated&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=s2>&#34;idx_1795421255603585025&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;selectivityEstimate&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;sparse&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span> <span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;unique&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;code&#34;</span> <span class=o>:</span> <span class=mi>201</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82137&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82137&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Qe---&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82139&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82139&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Qe--_&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;ids/82141&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82141&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Qi---&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>ArangoError</span> <span class=mi>1210</span><span class=o>:</span> <span class=nx>unique</span> <span class=nx>constraint</span> <span class=nx>violated</span> <span class=o>-</span> <span class=k>in</span> <span class=nx>index</span> <span class=nx>idx_1795421255603585025</span> <span class=k>of</span> <span class=nx>type</span> <span class=nx>persistent</span> <span class=nx>over</span> <span class=s1>&#39;name.first, name.last&#39;</span><span class=p>;</span> <span class=nx>conflicting</span> <span class=nx>key</span><span class=o>:</span> <span class=mi>82137</span><span class=p>]</span></span></span></code></pre></div></div></div><br><hr><p>Ensures that a non-unique persistent index exists:</p><p><code>collection.ensureIndex({ type: "persistent", fields: [ "field1", ..., "fieldn" ] })</code></p><p>Creates a non-unique persistent index on all documents using <code>field1</code>, &mldr;
<code>fieldn</code> as attribute paths. At least one attribute path has to be given.
The index will be non-sparse by default.</p><p>To create a sparse unique index, set the <code>sparse</code> attribute to <code>true</code>.</p><p>In case that the index was successfully created, an object with the index
details, including the index-identifier, is returned.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;first&#34;</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;Tim&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;Tom&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;John&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;Tim&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>names</span><span class=p>.</span><span class=nx>save</span><span class=p>({</span> <span class=s2>&#34;first&#34;</span> <span class=o>:</span> <span class=s2>&#34;Tom&#34;</span> <span class=p>});</span></span></span></code></pre></div><div class=expand><a class=expand-label onclick=toggleExpandShortcode(event)>Show output</a><div class=expand-content style=display:none><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;cacheEnabled&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;deduplicate&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;estimates&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;fields&#34;</span> <span class=o>:</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;first&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>],</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82151&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;isNewlyCreated&#34;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=s2>&#34;idx_1795421255639236608&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;selectivityEstimate&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;sparse&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span> <span class=o>:</span> <span class=s2>&#34;persistent&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;unique&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;code&#34;</span> <span class=o>:</span> <span class=mi>201</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82155&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82155&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Si--_&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82157&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82157&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Sm---&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82159&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82159&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Sm--_&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82161&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82161&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Sm--A&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_id&#34;</span> <span class=o>:</span> <span class=s2>&#34;names/82163&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_key&#34;</span> <span class=o>:</span> <span class=s2>&#34;82163&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;_rev&#34;</span> <span class=o>:</span> <span class=s2>&#34;_holf4Sm--B&#34;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><br><h3 id=query-by-example-using-a-persistent-index>Query by example using a persistent index <a href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/#query-by-example-using-a-persistent-index class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Constructs a query-by-example using a persistent index:</p><p><code>collection.byExample(example)</code></p><p>Selects all documents from the collection that match the specified example
and returns a cursor. A persistent index will be used if present.</p><p>You can use <code>toArray()</code>, <code>next()</code>, or <code>hasNext()</code> to access the
result. The result can be limited using the <code>skip()</code> and <code>limit()</code>
operator.</p><p>An attribute name of the form <code>a.b</code> is interpreted as attribute path,
not as attribute. If you use</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;c&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span> <span class=p>}</span>
</span></span></code></pre></div><p>as example, then you will find all documents, such that the attribute
<code>a</code> contains a document of the form <code>{ "c" : 1 }</code>. For example the document</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;c&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>},</span> <span class=nt>&#34;b&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span>
</span></span></code></pre></div><p>will match, but the document</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;c&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nt>&#34;b&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span> <span class=p>}</span>
</span></span></code></pre></div><p>will not.</p><p>However, if you use</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a.c&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span>
</span></span></code></pre></div><p>then you will find all documents, which contain a sub-document in <code>a</code>
that has an attribute <code>c</code> of value <code>1</code>. Both the following documents</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;c&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>},</span> <span class=nt>&#34;b&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span>
</span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span> <span class=nt>&#34;a&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;c&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nt>&#34;b&#34;</span> <span class=p>:</span> <span class=mi>1</span> <span class=p>}</span> <span class=p>}</span>
</span></span></code></pre></div><p>will match.</p><h2 id=persistent-indexes-and-server-language>Persistent Indexes and Server Language <a href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/#persistent-indexes-and-server-language class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The order of index entries in persistent indexes adheres to the configured
<a href=/3.10/components/arangodb-server/options/#--default-language class=link>server language</a>.
If, however, the server is restarted with a different language setting as when
the persistent index was created, not all documents may be returned anymore and
the sort order of those which are returned can be wrong (whenever the persistent
index is consulted).</p><p>To fix persistent indexes after a language change, delete and re-create them.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.10/index-and-search/indexing/working-with-indexes/><i class="fas fa-chevron-left fa-fw"></i><p>Working with Indexes</p></a></span><span class=next><a class="nav nav-next link" href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/><p>Inverted Indexes</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#storing-additional-values-in-indexes>Storing additional values in indexes</a></div><div class=level-2><a href=#caching-of-index-values>Caching of index values</a></div><div class=level-2><a href=#accessing-persistent-indexes-from-the-shell>Accessing Persistent Indexes from the Shell</a></div><div class=level-3><a href=#query-by-example-using-a-persistent-index>Query by example using a persistent index</a></div><div class=level-2><a href=#persistent-indexes-and-server-language>Persistent Indexes and Server Language</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>