<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743775370></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="You can use inverted indexes to speed up a broad range of AQL queries, from simple to complex, including full-text search"><meta property="og:url" content="http://localhost/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/"><meta property="og:title" content="Inverted indexes"><meta property="og:type" content="website"><meta property="og:description" content="You can use inverted indexes to speed up a broad range of AQL queries, from simple to complex, including full-text search"><meta name=docsearch:version content="3.10"><title>Inverted indexes | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743775370 defer></script>
<script src=/js/featherlight.min.js?1743775370 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743775370 defer></script>
<script src=/js/theme.js?1743775370 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.10"><a itemprop=item class=link href=/3.10/><span itemprop=name class=breadcrumb-entry>3.10.14</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Index and Search"><a itemprop=item class=link href=/3.10/index-and-search/><span itemprop=name class=breadcrumb-entry>Index and Search</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Indexing"><a itemprop=item class=link href=/3.10/index-and-search/indexing/><span itemprop=name class=breadcrumb-entry>Indexing</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Working with Indexes"><a itemprop=item class=link href=/3.10/index-and-search/indexing/working-with-indexes/><span itemprop=name class=breadcrumb-entry>Working with Indexes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Inverted Indexes"><a itemprop=item class=link href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/><span itemprop=name class=breadcrumb-entry>Inverted Indexes</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.10 reached End of Life (EOL) and is no longer supported.</p><p>This documentation is outdated. Please see the most recent <a href=/3.12/index-and-search/indexing/working-with-indexes/inverted-indexes/ class=link>stable version</a>.</p></div></div></div></div><hgroup><h1>Inverted indexes</h1><p class=lead>You can use inverted indexes to speed up a broad range of AQL queries, from simple to complex, including full-text search</p></hgroup><p>Documents hold attributes, mapping attribute keys to values.
Inverted indexes store mappings from values (of document attributes) to their
locations in collections. You can create these indexes to accelerate queries
like value lookups, range queries, accent- and case-insensitive search,
wildcard and fuzzy search, nested search, as well as for
sophisticated full-text search with the ability to search for words, phrases,
and more.</p><p>You can use inverted indexes as follows:</p><ul><li><p>Stand-alone in <code>FILTER</code> operations of AQL queries.</p></li><li><p>Add them to <a href=/3.10/index-and-search/arangosearch/#getting-started-with-arangosearch class=link><code>search-alias</code> Views</a>
to search multiple collections at once and to rank search results by relevance.</p></li></ul><h2 id=defining-inverted-indexes>Defining inverted indexes <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#defining-inverted-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Inverted indexes are defined per collection. You can add an arbitrary number of
document attributes to each index. Every attribute can optionally be processed
with an <a href=/3.10/index-and-search/analyzers/ class=link>Analyzer</a>, for instance, to tokenize text into words.</p><h3 id=basic-definition>Basic definition <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#basic-definition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>For example, you can create an inverted index for the attributes <code>value1</code> and
<code>value2</code> with the following command in arangosh:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>You should give inverted indexes easy-to-remember names because you need to
refer to them with <code>indexHint</code> in queries to
<a href=#utilizing-inverted-indexes-in-queries class=link>utilize inverted indexes</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inverted_index_name&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><h3 id=processing-fields-with-analyzers>Processing fields with Analyzers <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#processing-fields-with-analyzers class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The fields are processed by the <code>identity</code> Analyzer by default, which indexes
the attribute values as-is. To define a different Analyzer, you can pass an
object with the field settings instead. For example, you can use the default
Analyzer for <code>value1</code> and the built-in <code>text_en</code> Analyzer for <code>value2</code>.
You can also overwrite the <code>features</code> of an Analyzer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;value1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;value2&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en&#34;</span><span class=p>,</span> <span class=nx>features</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;frequency&#34;</span><span class=p>,</span> <span class=s2>&#34;norm&#34;</span><span class=p>,</span> <span class=s2>&#34;position&#34;</span><span class=p>,</span> <span class=s2>&#34;offset&#34;</span> <span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>You can define default <code>analyzer</code> and <code>features</code> value at the top-level of the
index property. In the following example, both fields are indexed with the
<code>text_en</code> Analyzer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en&#34;</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>If no <code>features</code> are defined in <code>fields</code> nor at the top-level, then the features
defined by the Analyzer itself are used.</p><h3 id=indexing-sub-attributes>Indexing sub-attributes <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#indexing-sub-attributes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To index a sub-attribute, like <code>{ "attr": { "sub": "value" } }</code>, use the
<code>.</code> character for the description of the attribute path:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;attr.sub&#34;</span><span class=p>]</span> <span class=p>});</span></span></span></code></pre></div><p>For <code>SEARCH</code> queries using a <code>search-alias</code> View, you can also index all
sub-attribute of an attribute with the <code>includeAllFields</code> options. It has no
effect on <code>FILTER</code> queries that use an inverted index directly, however. You can
enable the option for specific attributes in the <code>fields</code> definition, or for the
entire document by setting the option at the top-level of the index properties:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;attr&#34;</span><span class=p>,</span> <span class=nx>includeAllFields</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>includeAllFields</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span></span></span></code></pre></div><p>With the <code>includeAllFields</code> option enabled at the top-level, the otherwise
mandatory <code>fields</code> property becomes optional.</p><p>The <code>includeAllFields</code> option only includes the remaining fields that are not
separately specified in the <code>fields</code> definition, including their sub-attributes.</p><h3 id=indexing-array-values>Indexing array values <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#indexing-array-values class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>You can expand an attribute with an array as value so that its elements get
indexed individually by using <code>[*]</code> in the attribute path. For example, to
index the string values of a document like
<code>{ "arr": [ { "name": "foo" }, { "name": "bar" } ] }</code>, use <code>arr[*].name</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;arr[*].name&#34;</span><span class=p>]</span> <span class=p>});</span></span></span></code></pre></div><p>You can only expand one level of arrays.</p><p>If you want to use the inverted index in a <code>search-alias</code> View and index primitive
and array values like <code>arangosearch</code> Views do by default, then you can enable the
<code>searchField</code> option for specific attributes in the <code>fields</code> definition, or by
default using the top-level option with the same name. You may want to combine
it with the <code>includeAllFields</code> option to index sub-objects without explicit
definition:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;arr&#34;</span><span class=p>,</span> <span class=nx>searchField</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>includeAllFields</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;arr&#34;</span><span class=p>,</span> <span class=s2>&#34;arr.name&#34;</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>searchField</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>To index array values but preserve the array indexes for a <code>search-alias</code> View,
which you then also need to specify in queries, enable the <code>trackListPositions</code>
option (requires <code>searchField</code> to be <code>true</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;arr&#34;</span><span class=p>,</span> <span class=nx>searchField</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>trackListPositions</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>includeAllFields</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;arr&#34;</span><span class=p>,</span> <span class=s2>&#34;arr.name&#34;</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>searchField</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>trackListPositions</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><h3 id=storing-additional-values-in-indexes>Storing additional values in indexes <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#storing-additional-values-in-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Inverted indexes allow you to store additional attributes in the index that
can be used to satisfy projections of the document. They cannot be used for
index lookups, but for projections and sorting only. They allow inverted
indexes to fully cover more queries and avoid extra document lookups. This can
have a great positive effect on index scan performance if the number of scanned
index entries is large.</p><p>You can set the <code>storedValues</code> option when creating a new inverted index and
specify the additional attributes as an array of objects, each with a <code>fields</code>
attribute defining the attribute paths to add to the index:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>storedValues</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=s2>&#34;value2&#34;</span><span class=p>]</span> <span class=p>}</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>This indexes the <code>value1</code> attribute in the traditional sense, so that the index
can be used for looking up by <code>value1</code> or for sorting by <code>value1</code>.</p><p>In addition, due to <code>storedValues</code> being used here, the index can also supply
the values for the <code>value1</code> and <code>value2</code> attributes for projections without
having to look up the document. The values can be read from the index instead.
Non-existing attributes are stored as <code>null</code> values.</p><p>You may specify the same attribute paths in both the <code>fields</code> and the
<code>storedValues</code> option. This is useful if you want to filter by an attribute and
also return it using an AQL query. The attribute values indexed by <code>fields</code>
cannot be utilized for projections because the index representation does not
match the original values as stored in the documents.</p><p>Attribute paths specified in the <code>primarySort</code> option can be utilized for
projections. Therefore, you don&rsquo;t need to add them to <code>storedValues</code>, too.</p><p>For each object in the <code>storedValues</code> array, you can additionally set a
<code>compression</code> (<code>lz4</code> by default) and <code>cache</code> option (<code>false</code> by default):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>storedValues</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value1&#34;</span><span class=p>],</span> <span class=nx>compression</span><span class=o>:</span> <span class=s2>&#34;lz4&#34;</span><span class=p>,</span> <span class=nx>cache</span><span class=o>:</span> <span class=kc>false</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;value2&#34;</span><span class=p>],</span> <span class=nx>compression</span><span class=o>:</span> <span class=s2>&#34;none&#34;</span><span class=p>,</span> <span class=nx>cache</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>See <a href=/3.10/index-and-search/arangosearch/performance/#stored-values class=link>Optimizing View and inverted index query performance</a>
for details.</p><p>You may use the following shorthand notations on index creation instead of
an array of objects as described above. The default compression and cache
settings are used in this case:</p><ul><li><p>An array of strings, like <code>["attr1", "attr2"]</code>, to place each attribute into
a separate column of the index (introduced in v3.10.3).</p></li><li><p>An array of arrays of strings, like <code>[["attr1", "attr2"]]</code>, to place the
attributes into a single column of the index, or <code>[["attr1"], ["attr2"]]</code>
to place each attribute into a separate column. You can also mix it with the
full form:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=s2>&#34;attr1&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=s2>&#34;attr2&#34;</span><span class=p>,</span> <span class=s2>&#34;attr3&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;attr4&#34;</span><span class=p>,</span> <span class=s2>&#34;attr5&#34;</span><span class=p>],</span> <span class=nt>&#34;cache&#34;</span><span class=p>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div></li></ul><h3 id=additional-configuration-options>Additional configuration options <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#additional-configuration-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>See the full list of options in the <a href=/3.10/develop/http-api/indexes/inverted/ class=link>HTTP API</a>
documentation.</p><h3 id=restrictions>Restrictions <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#restrictions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ul><li>You cannot index the same field twice in a single inverted index. This includes
indexing the same field with and without array expansion (e.g.
<code>fields: ["arr", "arr[*]"]</code>).</li><li>Every field can only be processed by a single Analyzer per index. The benefit
is that you don&rsquo;t need to specify the Analyzers in queries with the <code>ANALYZER()</code>
function, they can be inferred from the index definition.</li></ul><p>If you plan on using inverted indexes in <code>search-alias</code> Views, also consider the
following restrictions in addition:</p><ul><li>All inverted indexes you add to a single <code>search-alias</code> View need to have
matching <code>primarySort</code> and <code>storedValues</code> settings.</li><li>If different inverted indexes index fields with the same name (attribute path),
these fields need to have matching <code>analyzer</code> and <code>searchField</code> settings.</li><li>Fields that are implicitly indexed by <code>includeAllFields</code> must also have
the same <code>analyzer</code> and <code>searchField</code> settings as fields with the same
attribute path indexed by other inverted indexes. You cannot combine inverted
indexes in a <code>search-alias</code> View if these settings would be ambiguous for any
field.</li></ul><h2 id=utilizing-inverted-indexes-in-queries>Utilizing inverted indexes in queries <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#utilizing-inverted-indexes-in-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Unlike other index types in ArangoDB, inverted indexes are not utilized
automatically, even if they are eligible for a query. The reason is that AQL
queries may produce different results with and without an inverted index,
because of differences in how <code>FILTER</code> operations work for inverted indexes,
the eventual-consistent nature of this index type, and for backward compatibility.</p><p>To use an inverted index, add an <code>OPTIONS</code> clause to the <code>FOR</code> operation that
you want to speed up. It needs to be a loop over a collection, not an array or
a View. Specify the desired index as an <code>indexHint</code>, using its name.</p><p>You should enable the <code>forceIndexHint</code> option to prevent unexpected query
results: Index hints are only recommendations you provide to
the optimizer unless you force them, and because <code>FILTER</code> queries behave
differently if an inverted index is used, the results would be inconsistent,
depending on whether or not the index hint is used. Forcing the hint ensures
that an error is raised if the index isn&rsquo;t suitable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>indexHint</span><span class=o>:</span> <span class=s2>&#34;inverted_index_name&#34;</span><span class=p>,</span> <span class=n>forceIndexHint</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=mi>42</span> <span class=kr>AND</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>text</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;meaning&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;life&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>Inverted indexes are eventually consistent. Document changes are not reflected
instantly, but only near-realtime. There is an internal option to wait for the
inverted index to update. This option is intended to be used <strong>in unit tests only</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span> <span class=p>{</span> <span class=n>indexHint</span><span class=o>:</span> <span class=s2>&#34;inv-idx&#34;</span><span class=p>,</span> <span class=n>forceIndexHint</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=n>waitForSync</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>..</span><span class=p>.</span> <span class=c1>// an arbitrary expression that the index can cover
</span></span></span></code></pre></div><p>This is not necessary if you use a single server deployment and populate a
collection with documents before creating an inverted index.</p><p>Also see <a href=/3.10/index-and-search/arangosearch/#dealing-with-eventual-consistency class=link>Dealing with eventual consistency</a>.</p><h2 id=examples>Examples <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#examples class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The following examples demonstrate how you can set up and use inverted indexes
with the JavaScript API of arangosh. See the
<a href=/3.10/index-and-search/indexing/working-with-indexes/#creating-an-index class=link><code>ensureIndex()</code> method</a>
description for details.</p><p>For more in-depth explanations and example data, see the
<a href=/3.10/index-and-search/arangosearch/example-datasets/ class=link>ArangoSearch example datasets</a> and the
corresponding ArangoSearch examples.</p><h3 id=exact-value-matching>Exact value matching <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#exact-value-matching class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Match exact movie title (case-sensitive, full string):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-exact&#34;</span><span class=p>,</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;title&#34;</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-exact&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.title == &#34;The Matrix&#34;
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN KEEP(doc, &#34;title&#34;, &#34;tagline&#34;)`</span><span class=p>);</span></span></span></code></pre></div><p>Match multiple exact movie titles using <code>IN</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-exact&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.title IN [&#34;The Matrix&#34;, &#34;The Matrix Reloaded&#34;]
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN KEEP(doc, &#34;title&#34;, &#34;tagline&#34;)`</span><span class=p>);</span></span></span></code></pre></div><p>Match movies that neither have the title <code>The Matrix</code> nor <code>The Matrix Reloaded</code>,
but ignore documents without a title:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-exact&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.title != null AND doc.title NOT IN [&#34;The Matrix&#34;, &#34;The Matrix Reloaded&#34;]
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc.title`</span><span class=p>);</span></span></span></code></pre></div><h3 id=range-queries>Range queries <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#range-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Match movies with a runtime over <code>300</code> minutes and sort them from longest to
shortest runtime. You can give the index a primary sort order so that the <code>SORT</code>
operation of the query can be optimized away:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-exact-runtime&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;runtime&#34;</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>primarySort</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>field</span><span class=o>:</span> <span class=s2>&#34;runtime&#34;</span><span class=p>,</span> <span class=nx>direction</span><span class=o>:</span> <span class=s2>&#34;desc&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-exact-runtime&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.runtime &gt; 300
</span></span></span><span class=line><span class=cl><span class=sb>  SORT doc.runtime DESC
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN KEEP(doc, &#34;title&#34;, &#34;runtime&#34;)`</span><span class=p>);</span></span></span></code></pre></div><p>Match movies where the name is <code>>= Wu</code> and <code>&lt; Y</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-exact-name&#34;</span><span class=p>,</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;name&#34;</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-exact-name&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER IN_RANGE(doc.name, &#34;Wu&#34;, &#34;Y&#34;, true, false)
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc.name`</span><span class=p>);</span></span></span></code></pre></div><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text>The alphabetical order of characters is not taken into account,
i.e. range queries backed by inverted indexes do not follow the
language rules as per the defined Analyzer locale (except for the
<a href=/3.10/index-and-search/analyzers/#collation class=link><code>collation</code> Analyzer</a>) nor the server language
(startup option <code>--default-language</code>)!
Also see <a href=/3.10/release-notes/version-3.10/known-issues-in-3-10/#arangosearch class=link>Known Issues</a>.</div></div></div></div><h3 id=case-insensitive-search>Case-insensitive search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#case-insensitive-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Match movie titles, ignoring capitalization and using the base characters
instead of accented characters (full string):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;norm_en&#34;</span><span class=p>,</span> <span class=s2>&#34;norm&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>locale</span><span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> <span class=nx>accent</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=k>case</span><span class=o>:</span> <span class=s2>&#34;lower&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-ci&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;title&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;norm_en&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-ci&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.title == TOKENS(&#34;thé mäTRïX&#34;, &#34;norm_en&#34;)[0]
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc.title`</span><span class=p>);</span></span></span></code></pre></div><h3 id=prefix-matching>Prefix matching <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#prefix-matching class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Match movie titles that start with either <code>"the matr"</code> or <code>"harry pot"</code>
(case-insensitive and accent-insensitive, using a custom <code>norm</code> Analyzer),
utilizing the feature of the <code>STARTS_WITH()</code> function that allows you to pass
multiple possible prefixes as array of strings, of which one must match:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;norm_en&#34;</span><span class=p>,</span> <span class=s2>&#34;norm&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>locale</span><span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> <span class=nx>accent</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=k>case</span><span class=o>:</span> <span class=s2>&#34;lower&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-ci&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;title&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;norm_en&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-ci&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER STARTS_WITH(doc.title, [&#34;the matr&#34;, &#34;harry pot&#34;])
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc.title`</span><span class=p>);</span></span></span></code></pre></div><h3 id=wildcard-search>Wildcard search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#wildcard-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Match all titles that starts with <code>the matr</code> (case-insensitive) using <code>LIKE()</code>,
where <code>_</code> stands for a single wildcard character and <code>%</code> for an arbitrary amount:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;norm_en&#34;</span><span class=p>,</span> <span class=s2>&#34;norm&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>locale</span><span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> <span class=nx>accent</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=k>case</span><span class=o>:</span> <span class=s2>&#34;lower&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-ci&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;title&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;norm_en&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-ci&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER LIKE(doc.title, &#34;the matr%&#34;)
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc.title`</span><span class=p>);</span></span></span></code></pre></div><h3 id=full-text-token-search>Full-text token search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#full-text-token-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Search for movies with both <code>dinosaur</code> and <code>park</code> in their description:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;description&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-text&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER TOKENS(&#34;dinosaur park&#34;, &#34;text_en&#34;) ALL == doc.description
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN {
</span></span></span><span class=line><span class=cl><span class=sb>    title: doc.title,
</span></span></span><span class=line><span class=cl><span class=sb>    description: doc.description
</span></span></span><span class=line><span class=cl><span class=sb>  }`</span><span class=p>);</span></span></span></code></pre></div><h3 id=phrase-and-proximity-search>Phrase and proximity search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#phrase-and-proximity-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Search for movies that have the (normalized and stemmed) tokens <code>biggest</code> and
<code>blockbust</code> in their description, in this order:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;description&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-text&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER PHRASE(doc.description, &#34;BIGGEST Blockbuster&#34;)
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN {
</span></span></span><span class=line><span class=cl><span class=sb>    title: doc.title,
</span></span></span><span class=line><span class=cl><span class=sb>    description: doc.description
</span></span></span><span class=line><span class=cl><span class=sb>  }`</span><span class=p>);</span></span></span></code></pre></div><p>Match movies that contain the phrase <code>epic &lt;something> film</code> in their
description, where <code>&lt;something></code> can be exactly one arbitrary token:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-text&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER PHRASE(doc.description, &#34;epic&#34;, 1, &#34;film&#34;, &#34;text_en&#34;)
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN {
</span></span></span><span class=line><span class=cl><span class=sb>    title: doc.title,
</span></span></span><span class=line><span class=cl><span class=sb>    description: doc.description
</span></span></span><span class=line><span class=cl><span class=sb>  }`</span><span class=p>);</span></span></span></code></pre></div><h3 id=fuzzy-search>Fuzzy search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#fuzzy-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Search for the token <code>galxy</code> in the movie descriptions with some fuzziness.
The maximum allowed Levenshtein distance is set to <code>1</code>. Everything with a
Levenshtein distance equal to or lower than this value will be a match and the
respective documents will be included in the search result. The query will find
the token <code>galaxy</code> as the edit distance to <code>galxy</code> is <code>1</code>.</p><p>A custom <code>text</code> Analyzer with stemming disabled is used to improve the accuracy
of the Levenshtein distance calculation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;text_en_no_stem&#34;</span><span class=p>,</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>locale</span><span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> <span class=nx>accent</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=k>case</span><span class=o>:</span> <span class=s2>&#34;lower&#34;</span><span class=p>,</span> <span class=nx>stemming</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>stopwords</span><span class=o>:</span> <span class=p>[]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-text-no-stem&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;description&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en_no_stem&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN imdb_vertices OPTIONS { indexHint: &#34;inv-text-no-stem&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER LEVENSHTEIN_MATCH(
</span></span></span><span class=line><span class=cl><span class=sb>    doc.description,
</span></span></span><span class=line><span class=cl><span class=sb>    TOKENS(&#34;galxy&#34;, &#34;text_en_no_stem&#34;)[0],
</span></span></span><span class=line><span class=cl><span class=sb>    1,    // max distance
</span></span></span><span class=line><span class=cl><span class=sb>    false // without transpositions
</span></span></span><span class=line><span class=cl><span class=sb>  )
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN {
</span></span></span><span class=line><span class=cl><span class=sb>    title: doc.title,
</span></span></span><span class=line><span class=cl><span class=sb>    description: doc.description
</span></span></span><span class=line><span class=cl><span class=sb>  }`</span><span class=p>);</span></span></span></code></pre></div><h3 id=geo-spatial-search>Geo-spatial search <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#geo-spatial-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Using the Museum of Modern Arts as reference location, find restaurants within
a 100 meter radius. Return the matches sorted by distance and include how far
away they are from the reference point in the result:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;geojson&#34;</span><span class=p>,</span> <span class=s2>&#34;geojson&#34;</span><span class=p>,</span> <span class=p>{},</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-rest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;location&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;geojson&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`LET moma = GEO_POINT(-73.983, 40.764)
</span></span></span><span class=line><span class=cl><span class=sb>FOR doc IN restaurants OPTIONS { indexHint: &#34;inv-rest&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER GEO_DISTANCE(doc.location, moma) &lt; 100
</span></span></span><span class=line><span class=cl><span class=sb>  LET distance = GEO_DISTANCE(doc.location, moma)
</span></span></span><span class=line><span class=cl><span class=sb>  SORT distance
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN {
</span></span></span><span class=line><span class=cl><span class=sb>    geometry: doc.location,
</span></span></span><span class=line><span class=cl><span class=sb>    distance
</span></span></span><span class=line><span class=cl><span class=sb>  }`</span><span class=p>);</span></span></span></code></pre></div><h3 id=nested-search-enterprise-edition>Nested search (Enterprise Edition) <a href=/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes/#nested-search-enterprise-edition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Example data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_create</span><span class=p>(</span><span class=s2>&#34;exhibits&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>exhibits</span><span class=p>.</span><span class=nx>save</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dimensions&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;height&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=mi>35</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;width&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=mi>60</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dimensions&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;height&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=mi>47</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;width&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=mi>72</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]);</span></span></span></code></pre></div><p>Match documents with a <code>dimensions</code> array that contains one or two sub-objects
with a <code>type</code> of <code>"height"</code> and a <code>value</code> greater than <code>40</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>exhibits</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-nest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;dimensions&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>nested</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;type&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;value&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN exhibits OPTIONS { indexHint: &#34;inv-nest&#34;, forceIndexHint: true }
</span></span></span><span class=line><span class=cl><span class=sb>  FILTER doc.dimensions[? 1..2 FILTER CURRENT.type == &#34;height&#34; AND CURRENT.value &gt; 40]
</span></span></span><span class=line><span class=cl><span class=sb>  RETURN doc
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>);</span></span></span></code></pre></div><p>Nested search is only available in the Enterprise Edition.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.10/index-and-search/indexing/working-with-indexes/persistent-indexes/><i class="fas fa-chevron-left fa-fw"></i><p>Persistent Indexes</p></a></span><span class=next><a class="nav nav-next link" href=/3.10/index-and-search/indexing/working-with-indexes/ttl-indexes/><p>TTL Indexes</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.10/index-and-search/indexing/working-with-indexes/inverted-indexes.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#defining-inverted-indexes>Defining inverted indexes</a></div><div class=level-3><a href=#basic-definition>Basic definition</a></div><div class=level-3><a href=#processing-fields-with-analyzers>Processing fields with Analyzers</a></div><div class=level-3><a href=#indexing-sub-attributes>Indexing sub-attributes</a></div><div class=level-3><a href=#indexing-array-values>Indexing array values</a></div><div class=level-3><a href=#storing-additional-values-in-indexes>Storing additional values in indexes</a></div><div class=level-3><a href=#additional-configuration-options>Additional configuration options</a></div><div class=level-3><a href=#restrictions>Restrictions</a></div><div class=level-2><a href=#utilizing-inverted-indexes-in-queries>Utilizing inverted indexes in queries</a></div><div class=level-2><a href=#examples>Examples</a></div><div class=level-3><a href=#exact-value-matching>Exact value matching</a></div><div class=level-3><a href=#range-queries>Range queries</a></div><div class=level-3><a href=#case-insensitive-search>Case-insensitive search</a></div><div class=level-3><a href=#prefix-matching>Prefix matching</a></div><div class=level-3><a href=#wildcard-search>Wildcard search</a></div><div class=level-3><a href=#full-text-token-search>Full-text token search</a></div><div class=level-3><a href=#phrase-and-proximity-search>Phrase and proximity search</a></div><div class=level-3><a href=#fuzzy-search>Fuzzy search</a></div><div class=level-3><a href=#geo-spatial-search>Geo-spatial search</a></div><div class=level-3><a href=#nested-search-enterprise-edition>Nested search (Enterprise Edition)</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>