<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743775370></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta property="og:url" content="http://localhost/3.11/deploy/active-failover/manual-start/"><meta property="og:title" content="Start an Active Failover deployment manually"><meta property="og:type" content="website"><meta property="og:description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta name=docsearch:version content="3.11"><title>Start an Active Failover deployment manually | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743775370 defer></script>
<script src=/js/featherlight.min.js?1743775370 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743775370 defer></script>
<script src=/js/theme.js?1743775370 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.11"><a itemprop=item class=link href=/3.11/><span itemprop=name class=breadcrumb-entry>3.11.13</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Deploy"><a itemprop=item class=link href=/3.11/deploy/><span itemprop=name class=breadcrumb-entry>Deploy</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Active Failover"><a itemprop=item class=link href=/3.11/deploy/active-failover/><span itemprop=name class=breadcrumb-entry>Active Failover</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Manual Start"><a itemprop=item class=link href=/3.11/deploy/active-failover/manual-start/><span itemprop=name class=breadcrumb-entry>Manual Start</span></a></li></ol></nav><article class=default><hgroup><h1>Start an Active Failover deployment manually</h1></hgroup><p>An ArangoDB <em>Active Failover</em> setup consists of several running <em>tasks</em> or <em>processes</em>.</p><p>This section describes how to start an <em>Active Failover</em> by manually starting all
the needed processes.</p><p>Before continuing, be sure to read the <a href=/3.11/deploy/active-failover/ class=link>Architecture</a>
section to get a basic understanding of the underlying architecture and the involved
roles in an ArangoDB Active Failover setup.</p><p>We will include commands for a local test (all processes running on a single machine)
and for a more real production scenario, which makes use of 3 different machines.</p><h2 id=local-tests>Local Tests <a href=/3.11/deploy/active-failover/manual-start/#local-tests class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>In this paragraph we will include commands to manually start an Active Failover
with 3 <em>Agents</em>, and two single server instances.</p><p>We will assume that all processes runs on the same machine (127.0.0.1). Such scenario
should be used for testing only.</p><h3 id=local-test-agency>Local Test Agency <a href=/3.11/deploy/active-failover/manual-start/#local-test-agency class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To start up an <em>Agency</em> you first have to activate it. This is done by providing
the option <code>--agency.activate true</code>.</p><p>To start up the <em>Agency</em> in its fault tolerant mode set the <code>--agency.size</code> to <code>3</code>.
You will then have to start at least 3 <em>Agents</em> before the <em>Agency</em> will start operation.</p><p>During initialization the <em>Agents</em> have to find each other. To do so provide at
least one common <code>--agency.endpoint</code>. The <em>Agents</em> will then coordinate startup
themselves. They will announce themselves with their external address which may be
specified using <code>--agency.my-address</code>. This is required in bridged docker setups
or NATed environments.</p><p>So in summary these are the commands to start an <em>Agency</em> of size 3:</p><pre tabindex=0><code>arangod --server.endpoint tcp://0.0.0.0:5001 \
  --agency.my-address=tcp://127.0.0.1:5001 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.endpoint tcp://127.0.0.1:5001 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent1 &amp;
   
arangod --server.endpoint tcp://0.0.0.0:5002 \
  --agency.my-address=tcp://127.0.0.1:5002 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.endpoint tcp://127.0.0.1:5001 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent2 &amp;

arangod --server.endpoint tcp://0.0.0.0:5003 \
  --agency.my-address=tcp://127.0.0.1:5003 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.endpoint tcp://127.0.0.1:5001 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent3 &amp;
</code></pre><p>Note that to avoid unnecessary failovers, it may make sense to increase the value for
the startup option <code>--agency.supervision-grace-period</code> to a value beyond 30 seconds.</p><h3 id=single-server-test-instances>Single Server Test Instances <a href=/3.11/deploy/active-failover/manual-start/#single-server-test-instances class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To start the two single server instances, you can use the following commands:</p><pre tabindex=0><code>arangod --server.authentication false \
  --server.endpoint tcp://127.0.0.1:6001 \
  --cluster.my-address tcp://127.0.0.1:6001 \
  --cluster.my-role SINGLE \
  --cluster.agency-endpoint tcp://127.0.0.1:5001 \
  --cluster.agency-endpoint tcp://127.0.0.1:5002 \
  --cluster.agency-endpoint tcp://127.0.0.1:5003 \ 
  --replication.automatic-failover true \
  --database.directory singleserver6001 &amp;
 
arangod --server.authentication false \
  --server.endpoint tcp://127.0.0.1:6002 \
  --cluster.my-address tcp://127.0.0.1:6002 \
  --cluster.my-role SINGLE \
  --cluster.agency-endpoint tcp://127.0.0.1:5001 \
  --cluster.agency-endpoint tcp://127.0.0.1:5002 \
  --cluster.agency-endpoint tcp://127.0.0.1:5003 \
  --replication.automatic-failover true \
  --database.directory singleserver6002 &amp;
</code></pre><h2 id=multiple-machines>Multiple Machines <a href=/3.11/deploy/active-failover/manual-start/#multiple-machines class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The method from the previous paragraph can be extended to a more real production scenario,
to start an Active Failover on multiple machines. The only changes are that one
has to replace all local addresses <code>127.0.0.1</code> by the actual IP address of the
corresponding server. Obviously, it would no longer be necessary to use different
port numbers on different servers.</p><p>Let&rsquo;s assume that you want to start you Active Failover with 3 <em>Agents</em> and two
single servers on three different machines with IP addresses:</p><pre tabindex=0><code>192.168.1.1
192.168.1.2
192.168.1.3
</code></pre><p>Let&rsquo;s also suppose that each of the above machines runs an <em>Agent</em>, an the first
and second machine run also the single instance.</p><p>If we use:</p><ul><li><em>8531</em> as port of the <em>Agents</em></li><li><em>8529</em> as port of the <em>Coordinators</em></li></ul><p>then the commands you have to use are reported in the following subparagraphs.</p><h3 id=agency>Agency <a href=/3.11/deploy/active-failover/manual-start/#agency class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>On 192.168.1.1:</p><pre tabindex=0><code>arangod --server.endpoint tcp://0.0.0.0:8531 \
  --agency.my-address tcp://192.168.1.1:8531 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent 
</code></pre><p>On 192.168.1.2:</p><pre tabindex=0><code>arangod --server.endpoint tcp://0.0.0.0:8531 \
  --agency.my-address tcp://192.168.1.2:8531 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent
</code></pre><p>On 192.168.1.3:</p><pre tabindex=0><code>arangod --server.endpoint tcp://0.0.0.0:8531 \
  --agency.my-address tcp://192.168.1.3:8531 \
  --server.authentication false \
  --agency.activate true \
  --agency.size 3 \
  --agency.endpoint tcp://192.168.1.1:8531 \
  --agency.endpoint tcp://192.168.1.2:8531 \ 
  --agency.endpoint tcp://192.168.1.3:8531 \
  --agency.supervision true \
  --agency.supervision-grace-period 30 \
  --database.directory agent
</code></pre><p>Note that to avoid unnecessary failovers, it may make sense to increase the value for
the startup option <code>--agency.supervision-grace-period</code> to a value beyond 30 seconds.</p><h3 id=single-server-instances>Single Server Instances <a href=/3.11/deploy/active-failover/manual-start/#single-server-instances class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>On 192.168.1.1:</p><pre tabindex=0><code>arangod --server.authentication=false \
  --server.endpoint tcp://0.0.0.0:8529 \
  --cluster.my-address tcp://192.168.1.1:8529 \
  --cluster.my-role SINGLE \
  --cluster.agency-endpoint tcp://192.168.1.1:8531 \
  --cluster.agency-endpoint tcp://192.168.1.2:8531 \
  --cluster.agency-endpoint tcp://192.168.1.3:8531 \
  --replication.automatic-failover true \
  --database.directory singleserver &amp;
</code></pre><p>On 192.168.1.2:</p><p>Wait until the previous server is fully started, then start the second single server
instance:</p><pre tabindex=0><code>arangod --server.authentication=false \
  --server.endpoint tcp://0.0.0.0:8529 \
  --cluster.my-address tcp://192.168.1.2:8529 \
  --cluster.my-role SINGLE \
  --cluster.agency-endpoint tcp://192.168.1.1:8531 \
  --cluster.agency-endpoint tcp://192.168.1.2:8531 \
  --cluster.agency-endpoint tcp://192.168.1.3:8531 \
  --replication.automatic-failover true \
  --database.directory singleserver &amp;
</code></pre><p><strong>Note:</strong> in the above commands, you can use host names, if they can be resolved,
instead of IP addresses.</p><h2 id=manual-start-in-docker>Manual Start in Docker <a href=/3.11/deploy/active-failover/manual-start/#manual-start-in-docker class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Manually starting an <em>Active Failover</em> via Docker is basically the same as described in the
paragraphs above.</p><p>A bit of extra care has to be invested due to the way in which Docker isolates its network.
By default it fully isolates the network and by doing so an endpoint like <code>--server.endpoint tcp://0.0.0.0:8529</code>
will only bind to all interfaces inside the Docker container which does not include
any external interface on the host machine. This may be sufficient if you just want
to access it locally but in case you want to expose it to the outside you must
facilitate Dockers port forwarding using the <code>-p</code> command line option. Be sure to
check the <a href=https://docs.docker.com/engine/reference/run/ target=_blank rel="noopener noreferrer" class=link>official Docker documentation</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><p>You can simply use the <code>-p</code> flag in Docker to make the individual processes available on the host
machine or you could use Docker&rsquo;s <a href=https://docs.docker.com/engine/reference/run/ target=_blank rel="noopener noreferrer" class=link>links</a>&nbsp;<i class="fas fa-external-link-alt"></i>
to enable process intercommunication.</p><p>An example configuration might look like this:</p><pre tabindex=0><code>docker run -e ARANGO_NO_AUTH=1 -p 192.168.1.1:10000:8529 arangodb/arangodb arangod \
  --server.endpoint tcp://0.0.0.0:8529\
  --cluster.my-address tcp://192.168.1.1:10000 \
  --cluster.my-role SINGLE \
  --cluster.agency-endpoint tcp://192.168.1.1:9001 \
  --cluster.agency-endpoint tcp://192.168.1.2:9001 \
  --cluster.agency-endpoint tcp://192.168.1.3:9001 \
  --replication.automatic-failover true 
</code></pre><p>This will start a single server within a Docker container with an isolated network.
Within the Docker container it will bind to all interfaces (this will be 127.0.0.1:8529
and some internal Docker IP on port 8529). By supplying <code>-p 192.168.1.1:10000:8529</code>
we are establishing a port forwarding from our local IP (192.168.1.1 port 10000 in
this example) to port 8529 inside the container. Within the command we are telling
<em>arangod</em> how it can be reached from the outside <code>--cluster.my-address tcp://192.168.1.1:10000</code>.</p><h3 id=authentication>Authentication <a href=/3.11/deploy/active-failover/manual-start/#authentication class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To start the official Docker container you will have to decide on an authentication
method, otherwise the container will not start.</p><p>Provide one of the arguments to Docker as an environment variable. There are three
options:</p><ol><li><p>ARANGO_NO_AUTH=1</p><p>Disable authentication completely. Useful for local testing or for operating
in a trusted network (without a public interface).</p></li><li><p>ARANGO_ROOT_PASSWORD=password</p><p>Start ArangoDB with the given password for root.</p></li><li><p>ARANGO_RANDOM_ROOT_PASSWORD=1</p><p>Let ArangoDB generate a random root password.</p></li></ol><p>For an in depth guide about Docker and ArangoDB please check the official documentation:
<a href=https://hub.docker.com/r/arangodb/arangodb/ target=_blank rel="noopener noreferrer" class=link>hub.docker.com/r/arangodb/arangodb/</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
Note that we are using the image <code>arangodb/arangodb</code> here which is always the most current one.
There is also the &ldquo;official&rdquo; one called <code>arangodb</code> whose documentation is here:
<a href=https://hub.docker.com/_/arangodb/ target=_blank rel="noopener noreferrer" class=link>hub.docker.com/_/arangodb/</a>&nbsp;<i class="fas fa-external-link-alt"></i></p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.11/deploy/active-failover/><i class="fas fa-chevron-left fa-fw"></i><p>Active Failover</p></a></span><span class=next><a class="nav nav-next link" href=/3.11/deploy/active-failover/using-the-arangodb-starter/><p>Using the ArangoDB Starter</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.11/deploy/active-failover/manual-start.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#local-tests>Local Tests</a></div><div class=level-3><a href=#local-test-agency>Local Test Agency</a></div><div class=level-3><a href=#single-server-test-instances>Single Server Test Instances</a></div><div class=level-2><a href=#multiple-machines>Multiple Machines</a></div><div class=level-3><a href=#agency>Agency</a></div><div class=level-3><a href=#single-server-instances>Single Server Instances</a></div><div class=level-2><a href=#manual-start-in-docker>Manual Start in Docker</a></div><div class=level-3><a href=#authentication>Authentication</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>