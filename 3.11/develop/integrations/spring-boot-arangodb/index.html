<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="The Spring Boot Starter for ArangoDB is a set of convenient dependency descriptors that you can include in your application based on the Spring framework"><meta property="og:url" content="http://localhost/3.11/develop/integrations/spring-boot-arangodb/"><meta property="og:title" content="Spring Boot Starter ArangoDB"><meta property="og:type" content="website"><meta property="og:description" content="The Spring Boot Starter for ArangoDB is a set of convenient dependency descriptors that you can include in your application based on the Spring framework"><meta name=docsearch:version content="3.11"><title>Spring Boot Starter ArangoDB | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.11"><a itemprop=item class=link href=/3.11/><span itemprop=name class=breadcrumb-entry>3.11.13</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Develop"><a itemprop=item class=link href=/3.11/develop/><span itemprop=name class=breadcrumb-entry>Develop</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Integrations"><a itemprop=item class=link href=/3.11/develop/integrations/><span itemprop=name class=breadcrumb-entry>Integrations</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Spring Boot Starter"><a itemprop=item class=link href=/3.11/develop/integrations/spring-boot-arangodb/><span itemprop=name class=breadcrumb-entry>Spring Boot Starter</span></a></li></ol></nav><article class=default><hgroup><h1>Spring Boot Starter ArangoDB</h1><p class=lead>The Spring Boot Starter for ArangoDB is a set of convenient dependency descriptors that you can include in your application based on the Spring framework</p></hgroup><ul><li><a href=https://github.com/arangodb/spring-boot-starter target=_blank rel="noopener noreferrer" class=link>Repository</a>&nbsp;<i class="fas fa-external-link-alt"></i></li><li><a href=https://github.com/arangodb/spring-boot-starter/tree/main/demo target=_blank rel="noopener noreferrer" class=link>Demo</a>&nbsp;<i class="fas fa-external-link-alt"></i></li></ul><h2 id=supported-versions>Supported versions <a href=/3.11/develop/integrations/spring-boot-arangodb/#supported-versions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Spring Boot Starter ArangoDB is compatible with all supported versions of ArangoDB.
For more information, see the <a href=https://www.arangodb.com/subscriptions/end-of-life-notice/ target=_blank rel="noopener noreferrer" class=link>End-of-life announcements</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><p>This integration has multiple versions released, and each one is compatible with
the corresponding versions of Spring Boot, Spring Framework, Spring Data ArangoDB,
and ArangoDB Java Driver:</p><table><thead><tr><th>Spring Boot Starter ArangoDB</th><th>Spring Boot</th><th>Spring Framework</th><th>Spring Data ArangoDB</th><th>ArangoDB Java Driver</th></tr></thead><tbody><tr><td>3.3-x</td><td>3.3</td><td>6.1</td><td>4.2</td><td>7.7</td></tr><tr><td>3.2-x</td><td>3.2</td><td>6.1</td><td>4.2</td><td>7.7</td></tr></tbody></table><p>Note that the adopted versioning scheme does not honor the semantic versioning
rules, i.e. minor or patch releases may introduce new features or breaking
changes. Please refer to <a href=https://github.com/arangodb/spring-boot-starter/releases target=_blank rel="noopener noreferrer" class=link>releases</a>&nbsp;<i class="fas fa-external-link-alt"></i>
for details.</p><h2 id=get-started>Get started <a href=/3.11/develop/integrations/spring-boot-arangodb/#get-started class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>This is an extensive demo on how to use
<a href=https://github.com/arangodb/spring-data target=_blank rel="noopener noreferrer" class=link>Spring Data ArangoDB</a>&nbsp;<i class="fas fa-external-link-alt"></i> with an example
dataset of <strong>Game of Thrones</strong> characters and locations.</p><h3 id=build-a-project-with-maven>Build a project with Maven <a href=/3.11/develop/integrations/spring-boot-arangodb/#build-a-project-with-maven class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>First, you have to set up a project and add every needed dependency.
This demo use Maven and Spring Boot and adds <code>arangodb-spring-boot-starter</code> to
auto-configure Spring Data ArangoDB.</p><p>Create a Maven <code>pom.xml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;project</span> <span class=na>xmlns=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class=line><span class=cl>         <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>         <span class=na>xsi:schemaLocation=</span><span class=s>&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;modelVersion&gt;</span>4.0.0<span class=nt>&lt;/modelVersion&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;parent&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-parent<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;version&gt;</span>3.1.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;relativePath/&gt;</span> <span class=c>&lt;!-- lookup parent from repository --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/parent&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>spring-data-arangodb-tutorial<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.0.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;name&gt;</span>demo<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;description&gt;</span>Demo project for Spring Boot<span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;properties&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;java.version&gt;</span>17<span class=nt>&lt;/java.version&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/properties&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>arangodb-spring-boot-starter<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>3.1-0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;build&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;plugins&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/plugin&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/plugins&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/build&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/project&gt;</span>
</span></span></code></pre></div><p>Substitute the versions with the latest available versions that are compatible.
See the <a href=#supported-versions class=link>Supported versions</a> for details.</p><h3 id=monitor-the-server-health>Monitor the server health <a href=/3.11/develop/integrations/spring-boot-arangodb/#monitor-the-server-health class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoDB health monitoring can be applied to your application by adding
<code>spring-boot-starter-actuator</code> to your project and calling the
<code>GET /actuator/health</code> endpoint against your application.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id=create-an-application-class>Create an Application class <a href=/3.11/develop/integrations/spring-boot-arangodb/#create-an-application-class class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>After you have ensured that you can fetch all the necessary dependencies, you
can create your first classes.</p><p>The <code>DemoApplication</code> class is the main class where you later add certain
<code>CommandLineRunner</code> instances to be executed.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.SpringApplication</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.autoconfigure.SpringBootApplication</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@SpringBootApplication</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DemoApplication</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Class</span><span class=o>&lt;?&gt;[]</span> <span class=n>runner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{};</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=n>SpringApplication</span><span class=o>.</span><span class=na>exit</span><span class=o>(</span><span class=n>SpringApplication</span><span class=o>.</span><span class=na>run</span><span class=o>(</span><span class=n>runner</span><span class=o>,</span> <span class=n>args</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=application-configuration>Application configuration <a href=/3.11/develop/integrations/spring-boot-arangodb/#application-configuration class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>You need to provide the configuration for the database connection.
You can do this by adding to <code>src/main/resources/application.properties</code>
with the properties of
<a href=https://github.com/arangodb/spring-boot-starter/blob/main/src/main/java/com/arangodb/springframework/boot/autoconfigure/ArangoProperties.java target=_blank rel="noopener noreferrer" class=link>ArangoProperties</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><pre tabindex=0><code>arangodb.spring.data.database=spring-demo
arangodb.spring.data.user=root
arangodb.spring.data.password=test
arangodb.spring.data.hosts=localhost:8529
</code></pre><h2 id=data-modeling>Data modeling <a href=/3.11/develop/integrations/spring-boot-arangodb/#data-modeling class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Create your first bean representing a collection in your database. With the
<code>@Document</code> annotation, you define the collection as a document collection.
In this case, the alternative name characters for the collection are also defined.
By default, the collection name is determined by the class name. <code>@Document</code>
also provides additional options for the collection, which is used at the
creation time of the collection.</p><p>Because many operations on documents require a document handle, it&rsquo;s recommended
to add a field of type <code>String</code> annotated with <code>@Id</code> to every entity. The name
doesn&rsquo;t matter. It&rsquo;s further recommended to <strong>not set or change</strong> the id by hand.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.entity</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.Document</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.annotation.Id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Document</span><span class=o>(</span><span class=s>&#34;characters&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Character</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span> <span class=c1>// db document field: _key
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ArangoId</span> <span class=c1>// db document field: _id
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>arangoId</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>surname</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>boolean</span> <span class=n>alive</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Character</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Character</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>surname</span><span class=o>,</span> <span class=kd>final</span> <span class=kt>boolean</span> <span class=n>alive</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>surname</span> <span class=o>=</span> <span class=n>surname</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>alive</span> <span class=o>=</span> <span class=n>alive</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Character</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>surname</span><span class=o>,</span> <span class=kd>final</span> <span class=kt>boolean</span> <span class=n>alive</span><span class=o>,</span> <span class=kd>final</span> <span class=n>Integer</span> <span class=n>age</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>surname</span> <span class=o>=</span> <span class=n>surname</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>alive</span> <span class=o>=</span> <span class=n>alive</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>age</span> <span class=o>=</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// getter &amp; setter
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;Character [id=&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;, name=&#34;</span> <span class=o>+</span> <span class=n>name</span> <span class=o>+</span> <span class=s>&#34;, surname=&#34;</span> <span class=o>+</span> <span class=n>surname</span> <span class=o>+</span> <span class=s>&#34;, alive=&#34;</span> <span class=o>+</span> <span class=n>alive</span> <span class=o>+</span> <span class=s>&#34;, age=&#34;</span> <span class=o>+</span> <span class=n>age</span> <span class=o>+</span> <span class=s>&#34;]&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=crud-operations>CRUD operations <a href=/3.11/develop/integrations/spring-boot-arangodb/#crud-operations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=create-a-repository>Create a repository <a href=/3.11/develop/integrations/spring-boot-arangodb/#create-a-repository class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Now that you have your data model, you want to store data. For this, you create
a repository interface which extends <code>ArangoRepository</code>. This gives you access
to CRUD operations, paging, and query by example mechanics.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Character</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.repository.ArangoRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>CharacterRepository</span> <span class=kd>extends</span> <span class=n>ArangoRepository</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=create-a-commandlinerunner>Create a CommandLineRunner <a href=/3.11/develop/integrations/spring-boot-arangodb/#create-a-commandlinerunner class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To run your demo with Spring Boot, you have to create a class implementing
<code>CommandLineRunner</code>. In this class, you can use the <code>@Autowired</code> annotation to
inject your <code>CharacterRepository</code> – created one step earlier – and also
<code>ArangoOperations</code> which offers a central support for interactions with the
database over a rich feature set. It mostly offers the features from the
<a href=https://github.com/arangodb/arangodb-java-driver target=_blank rel="noopener noreferrer" class=link>ArangoDB Java driver</a>&nbsp;<i class="fas fa-external-link-alt"></i>
with additional exception translation.</p><p>To get the injection successfully running, you have to add <code>@ComponentScan</code> to your
runner to define where Spring can find your configuration class <code>DemoConfiguration</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.core.ArangoOperations</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.annotation.ComponentScan</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.arangodb.spring.demo&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrudRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ArangoOperations</span> <span class=n>operations</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=save-and-read-an-entity>Save and read an entity <a href=/3.11/develop/integrations/spring-boot-arangodb/#save-and-read-an-entity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>It&rsquo;s time to save your first entity in the database. Both the database and the
collection don&rsquo;t have to be created manually. This happens automatically as soon
as you execute a database request with the components involved. You don&rsquo;t have
to leave the Java world to manage your database.</p><p>After you saved a character in the database, the id in the original entity is
updated with the one generated from the database. You can then use this id to
find your persisted entity.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Character</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.core.ArangoOperations</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.annotation.ComponentScan</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Optional</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.arangodb.spring.demo&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CrudRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ArangoOperations</span> <span class=n>operations</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// first drop the database so that we can run this multiple times with the same dataset
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>operations</span><span class=o>.</span><span class=na>dropDatabase</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// save a single entity in the database
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// there is no need of creating the collection first. This happen automatically
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>final</span> <span class=n>Character</span> <span class=n>nedStark</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Ned&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>,</span> <span class=kc>true</span><span class=o>,</span> <span class=mi>41</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>repository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>nedStark</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// the generated id from the database is set in the original entity
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Ned Stark saved in the database with id: &#39;%s&#39;&#34;</span><span class=o>,</span> <span class=n>nedStark</span><span class=o>.</span><span class=na>getId</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// let us take a look whether we can find Ned Stark in the database
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>final</span> <span class=n>Optional</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>foundNed</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findById</span><span class=o>(</span><span class=n>nedStark</span><span class=o>.</span><span class=na>getId</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>assert</span> <span class=n>foundNed</span><span class=o>.</span><span class=na>isPresent</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Found %s&#34;</span><span class=o>,</span> <span class=n>foundNed</span><span class=o>.</span><span class=na>get</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=run-the-demo>Run the demo <a href=/3.11/develop/integrations/spring-boot-arangodb/#run-the-demo class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The last thing you have to do before you can successfully run your demo
application is to add your command line runner <code>CrudRunner</code> to the list of
runners in your main class <code>DemoApplication</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span><span class=n>runner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span><span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>};</span>
</span></span></code></pre></div><p>After executing the demo application, you should see the following lines within
your console output. The id will of course deviate.</p><pre tabindex=0><code>Ned Stark saved in the database with id: &#39;346&#39;
Found Character [id=346, name=Ned, surname=Stark, alive=true, age=41]
</code></pre><h3 id=update-an-entity>Update an entity <a href=/3.11/develop/integrations/spring-boot-arangodb/#update-an-entity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>As everyone probably knows, Ned Stark died in the first season of Game of Thrones.
So, you should to update his &lsquo;alive&rsquo; flag. Thanks to the <code>id</code> field in the
<code>Character</code> class, you can use the <code>save()</code> method of the repository to perform
an upsert with the variable <code>nedStark</code> in which <code>id</code> is already set.</p><p>Add the following lines of code to the end of our <code>run()</code> method in <code>CrudRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>nedStark</span><span class=o>.</span><span class=na>setAlive</span><span class=o>(</span><span class=kc>false</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>repository</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=n>nedStark</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=n>Optional</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>deadNed</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findById</span><span class=o>(</span><span class=n>nedStark</span><span class=o>.</span><span class=na>getId</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=k>assert</span> <span class=n>deadNed</span><span class=o>.</span><span class=na>isPresent</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;The &#39;alive&#39; flag of the persisted Ned Stark is now &#39;%s&#39;&#34;</span><span class=o>,</span><span class=n>deadNed</span><span class=o>.</span><span class=na>get</span><span class=o>().</span><span class=na>isAlive</span><span class=o>()));</span>
</span></span></code></pre></div><p>If you run the demo a second time, the console output should look like this:</p><pre tabindex=0><code>Ned Stark saved in the database with id: &#39;508&#39;
Found Character [id=508, name=Ned, surname=Stark, alive=true, age=41]
The &#39;alive&#39; flag of the persisted Ned Stark is now &#39;false&#39;
</code></pre><h3 id=save-and-read-multiple-entities>Save and read multiple entities <a href=/3.11/develop/integrations/spring-boot-arangodb/#save-and-read-multiple-entities class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>What you can do with a single entity, you can also do with multiple entities.
It&rsquo;s not just a single method call for convenience purpose, it also requires
only one database request.</p><p>The following code is for saving a bunch of characters but only the main cast of
Game of Thrones – that&rsquo;s already a lot. After that, you can fetch all of them
from your collection and count them.</p><p>Extend the <code>run()</code> method with these lines of code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>createCharacters</span> <span class=o>=</span> <span class=n>createCharacters</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Save %s additional characters&#34;</span><span class=o>,</span><span class=n>createCharacters</span><span class=o>.</span><span class=na>size</span><span class=o>()));</span>
</span></span><span class=line><span class=cl><span class=n>repository</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>createCharacters</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>long</span> <span class=n>count</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>count</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;A total of %s characters are persisted in the database&#34;</span><span class=o>,</span> <span class=n>count</span><span class=o>));</span>
</span></span></code></pre></div><p>You also need the <code>createCharacters()</code> method which looks as follow:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>createCharacters</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Robert&#34;</span><span class=o>,</span><span class=s>&#34;Baratheon&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Jaime&#34;</span><span class=o>,</span><span class=s>&#34;Lannister&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>36</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Catelyn&#34;</span><span class=o>,</span><span class=s>&#34;Stark&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>,</span><span class=mi>40</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Cersei&#34;</span><span class=o>,</span><span class=s>&#34;Lannister&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>36</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Daenerys&#34;</span><span class=o>,</span><span class=s>&#34;Targaryen&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>16</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Jorah&#34;</span><span class=o>,</span><span class=s>&#34;Mormont&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Petyr&#34;</span><span class=o>,</span><span class=s>&#34;Baelish&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Viserys&#34;</span><span class=o>,</span><span class=s>&#34;Targaryen&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Jon&#34;</span><span class=o>,</span><span class=s>&#34;Snow&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>16</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Sansa&#34;</span><span class=o>,</span><span class=s>&#34;Stark&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>13</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Arya&#34;</span><span class=o>,</span><span class=s>&#34;Stark&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>11</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Robb&#34;</span><span class=o>,</span><span class=s>&#34;Stark&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Theon&#34;</span><span class=o>,</span><span class=s>&#34;Greyjoy&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>16</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Bran&#34;</span><span class=o>,</span><span class=s>&#34;Stark&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>10</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Joffrey&#34;</span><span class=o>,</span><span class=s>&#34;Baratheon&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>,</span><span class=mi>19</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Sandor&#34;</span><span class=o>,</span><span class=s>&#34;Clegane&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Tyrion&#34;</span><span class=o>,</span><span class=s>&#34;Lannister&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>32</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Khal&#34;</span><span class=o>,</span><span class=s>&#34;Drogo&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Tywin&#34;</span><span class=o>,</span><span class=s>&#34;Lannister&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Davos&#34;</span><span class=o>,</span><span class=s>&#34;Seaworth&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>49</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Samwell&#34;</span><span class=o>,</span><span class=s>&#34;Tarly&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>17</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Stannis&#34;</span><span class=o>,</span><span class=s>&#34;Baratheon&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Melisandre&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Margaery&#34;</span><span class=o>,</span><span class=s>&#34;Tyrell&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Jeor&#34;</span><span class=o>,</span><span class=s>&#34;Mormont&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Bronn&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Varys&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Shae&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Talisa&#34;</span><span class=o>,</span><span class=s>&#34;Maegyr&#34;</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Gendry&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Ygritte&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Tormund&#34;</span><span class=o>,</span><span class=s>&#34;Giantsbane&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Gilly&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Brienne&#34;</span><span class=o>,</span><span class=s>&#34;Tarth&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>,</span><span class=mi>32</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Ramsay&#34;</span><span class=o>,</span><span class=s>&#34;Bolton&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Ellaria&#34;</span><span class=o>,</span><span class=s>&#34;Sand&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Daario&#34;</span><span class=o>,</span><span class=s>&#34;Naharis&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Missandei&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Tommen&#34;</span><span class=o>,</span><span class=s>&#34;Baratheon&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Jaqen&#34;</span><span class=o>,</span><span class=s>&#34;H&#39;ghar&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Roose&#34;</span><span class=o>,</span><span class=s>&#34;Bolton&#34;</span><span class=o>,</span><span class=kc>true</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;The High Sparrow&#34;</span><span class=o>,</span><span class=kc>null</span><span class=o>,</span><span class=kc>true</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span></code></pre></div><p>After executing the demo again, the console should print the following
additional lines:</p><pre tabindex=0><code>Save 42 additional characters
A total of 43 characters are persisted in the database
</code></pre><h3 id=read-with-sorting-and-paging>Read with sorting and paging <a href=/3.11/develop/integrations/spring-boot-arangodb/#read-with-sorting-and-paging class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Next to the normal <code>findAll()</code> method, <code>ArangoRepository</code> also offers the
ability to sort the fetched entities by a given field name. Adding the following
source code at the end of your <code>run()</code> method gives you all characters sorted by
field <code>name</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Return all characters sorted by name&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>allSorted</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>(</span><span class=n>Sort</span><span class=o>.</span><span class=na>by</span><span class=o>(</span><span class=n>Sort</span><span class=o>.</span><span class=na>Direction</span><span class=o>.</span><span class=na>ASC</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>allSorted</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>Furthermore, it&rsquo;s possible to use pagination combined with sorting. With the
following code, you get the first 5 characters sorted by name:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Return the first 5 characters sorted by name&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Page</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>first5Sorted</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>(</span><span class=n>PageRequest</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span> <span class=mi>5</span><span class=o>,</span> <span class=n>Sort</span><span class=o>.</span><span class=na>by</span><span class=o>(</span><span class=n>Sort</span><span class=o>.</span><span class=na>Direction</span><span class=o>.</span><span class=na>ASC</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=n>first5Sorted</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>Your console output should include Arya Stark, Bran Stark, Brienne Tarth, Bronn
and Catelyn Stark.</p><pre tabindex=0><code>## Return the first 5 characters sorted by name
Character [id=1898, name=Arya, surname=Stark, alive=true, age=11]
Character [id=1901, name=Bran, surname=Stark, alive=true, age=10]
Character [id=1921, name=Brienne, surname=Tarth, alive=true, age=32]
Character [id=1913, name=Bronn, surname=null, alive=true, age=null]
Character [id=1890, name=Catelyn, surname=Stark, alive=false, age=40]
</code></pre><h2 id=query-by-example>Query by example <a href=/3.11/develop/integrations/spring-boot-arangodb/#query-by-example class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Since version 1.12, Spring Data provides the <code>QueryByExampleExecutor</code> interface
which is also supported by ArangoDB Spring Data. It allows execution of queries
by <code>Example</code> instances.</p><p>Create a new <code>CommandLineRunner</code> for this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.annotation.ComponentScan</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.domain.Example</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.domain.ExampleMatcher</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Character</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.arangodb.spring.demo&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ByExampleRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;# Query by example&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Add it to your <code>DemoApplication</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span><span class=n>runner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span>
</span></span><span class=line><span class=cl>        <span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ByExampleRunner</span><span class=o>.</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><h3 id=single-entity>Single entity <a href=/3.11/develop/integrations/spring-boot-arangodb/#single-entity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>First, find Ned Stark again. But this time without knowing the id of the
persisted entity. Start with creating a Character with the same property values
as the searched one. Then create an <code>Example</code> instance of it with <code>Example.of(T) and search for it with </code>findOne(Example)<code>from your</code>CharacterRepository`:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>final</span> <span class=n>Character</span> <span class=n>nedStark</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=s>&#34;Ned&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=mi>41</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;## Find character which exactly match %s&#34;</span><span class=o>,</span><span class=n>nedStark</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>Optional</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>foundNedStark</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findOne</span><span class=o>(</span><span class=n>Example</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>nedStark</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Found %s&#34;</span><span class=o>,</span> <span class=n>foundNedStark</span><span class=o>.</span><span class=na>get</span><span class=o>()));</span>
</span></span></code></pre></div><p>If you did everything right, the console output should be as follows:</p><pre tabindex=0><code># Query by example
## Find character which exactly match Character [id=null, name=Ned, surname=Stark, alive=false, age=41]
Found Character [id=1880, name=Ned, surname=Stark, alive=false, age=41]
</code></pre><h3 id=multiple-entities>Multiple entities <a href=/3.11/develop/integrations/spring-boot-arangodb/#multiple-entities class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Now find more than one entity. A lot of Starks die in Game of Thrones, so take a
look who is already dead. For this, you create a new instance of Character with
<code>surname</code> <code>"Stark"</code> and <code>alive</code> <code>false</code>. Because you only need these two fields
in your entity, you have to ignore the other fields in your <code>ExampleMatcher</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all dead Starks&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>allDeadStarks</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>(</span><span class=n>Example</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=kc>null</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>,</span> <span class=kc>false</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=n>allDeadStarks</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>After executing the application, the console output should be as follows:</p><pre tabindex=0><code>## Find all dead Starks
Character [id=1887, name=Ned, surname=Stark, alive=false, age=41]
Character [id=1890, name=Catelyn, surname=Stark, alive=false, age=40]
Character [id=1899, name=Robb, surname=Stark, alive=false, age=null]
</code></pre><p>In addition to searching for specific values of the example entity, you can
search for dynamically depending values. In the next example, search for a Stark
who is 30 years younger than Ned Stark. Instead of changing the age of Ned Stark
in the previously fetched entity, you use a transformer within the <code>ExampleMatcher</code>
and subtract 30 from the age of Ned Stark.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all Starks which are 30 years younger than Ned Stark&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>allYoungerStarks</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>(</span>
</span></span><span class=line><span class=cl>    <span class=n>Example</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>foundNedStark</span><span class=o>.</span><span class=na>get</span><span class=o>(),</span> <span class=n>ExampleMatcher</span><span class=o>.</span><span class=na>matchingAll</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>withMatcher</span><span class=o>(</span><span class=s>&#34;surname&#34;</span><span class=o>,</span> <span class=n>GenericPropertyMatcher</span><span class=o>::</span><span class=n>exact</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>withIgnorePaths</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>,</span> <span class=s>&#34;arangoId&#34;</span><span class=o>,</span> <span class=s>&#34;name&#34;</span><span class=o>,</span> <span class=s>&#34;alive&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>withTransformer</span><span class=o>(</span><span class=s>&#34;age&#34;</span><span class=o>,</span> <span class=n>age</span> <span class=o>-&gt;</span> <span class=n>age</span><span class=o>.</span><span class=na>map</span><span class=o>(</span><span class=n>it</span> <span class=o>-&gt;</span> <span class=o>(</span><span class=kt>int</span><span class=o>)</span> <span class=n>it</span> <span class=o>-</span> <span class=mi>30</span><span class=o>))));</span>
</span></span><span class=line><span class=cl>        <span class=n>allYoungerStarks</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>Because you are using the entity <code>foundNedStark</code> – fetched from the database –
you have to ignore the <code>id</code> field which isn&rsquo;t <code>null</code> in this case.</p><p>The console output should only include Arya Stark.</p><pre tabindex=0><code>## Find all Starks which are 30 years younger than Ned Stark
Character [id=1898, name=Arya, surname=Stark, alive=true, age=11]
</code></pre><p>Aside from searching for exact and transformed values, you can – in case of type
<code>String</code>, also search for other expressions. In this last case, search for every
character whose <code>surname</code> ends with <code>"ark"</code>. The console output should include
every Stark.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all character which surname ends with &#39;ark&#39; (ignore case)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>ark</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>(</span><span class=n>Example</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=k>new</span> <span class=n>Character</span><span class=o>(</span><span class=kc>null</span><span class=o>,</span> <span class=s>&#34;ark&#34;</span><span class=o>,</span> <span class=kc>false</span><span class=o>),</span>
</span></span><span class=line><span class=cl><span class=n>ExampleMatcher</span><span class=o>.</span><span class=na>matchingAll</span><span class=o>().</span><span class=na>withMatcher</span><span class=o>(</span><span class=s>&#34;surname&#34;</span><span class=o>,</span> <span class=n>GenericPropertyMatcher</span><span class=o>::</span><span class=n>endsWith</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>withIgnoreCase</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>withIgnorePaths</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>,</span> <span class=s>&#34;alive&#34;</span><span class=o>,</span> <span class=s>&#34;age&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=n>ark</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><h2 id=derived-queries>Derived queries <a href=/3.11/develop/integrations/spring-boot-arangodb/#derived-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Spring Data ArangoDB supports queries derived from method names by splitting it
into its semantic parts and converting into AQL. The mechanism strips the prefixes
<code>find..By</code>, <code>get..By</code>, <code>query..By</code>, <code>read..By</code>, <code>stream..By</code>, <code>count..By</code>,
<code>exists..By</code>, <code>delete..By</code>, <code>remove..By</code> from the method and parses the rest.
The <code>By</code> acts as a separator to indicate the start of the criteria for the query
to be built. You can define conditions on entity properties and concatenate them
with <code>And</code> and <code>Or</code>.</p><p>You can find the complete list of part types for derived queries in the
<a href=/3.11/develop/integrations/spring-data-arangodb/reference-version-4/repositories/queries/derived-queries/ class=link>reference documentation</a>.</p><h3 id=simple-findby>Simple findBy <a href=/3.11/develop/integrations/spring-boot-arangodb/#simple-findby class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Start with an easy example and find characters based on their <code>surname</code>.</p><p>The only thing you have to do is to add a method <code>findBySurname(String)</code> to your
<code>CharacterRepository</code> with a return type which allows the method to return
multiple instances of <code>Character</code>. For more information on which return types are
possible, see the <a href=/3.11/develop/integrations/spring-data-arangodb/reference-version-4/repositories/queries/#return-types class=link>reference documentation</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>CharacterRepository</span> <span class=kd>extends</span> <span class=n>ArangoRepository</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findBySurname</span><span class=o>(</span><span class=n>String</span> <span class=n>surname</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>After extending your repository, create a new <code>CommandLineRunner</code> and add it to
your <code>DemoApplication</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span><span class=n>runner</span><span class=o>=</span><span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span>
</span></span><span class=line><span class=cl>        <span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ByExampleRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DerivedQueryRunner</span><span class=o>.</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><p>In the <code>run()</code> method, call your new <code>findBySurname(String)</code> method and try to
find all characters with the <code>surname</code> <code>"Lannister"</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.annotation.ComponentScan</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Character</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.arangodb.spring.demo&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DerivedQueryRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;# Derived queries&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all characters with surname &#39;Lannister&#39;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>lannisters</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findBySurname</span><span class=o>(</span><span class=s>&#34;Lannister&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>lannisters</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>After executing the demo application, you should see the following lines in
your console output:</p><pre tabindex=0><code># Derived queries
## Find all characters with surname &#39;Lannister&#39;
Character [id=238, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=240, name=Cersei, surname=Lannister, alive=true, age=36]
Character [id=253, name=Tyrion, surname=Lannister, alive=true, age=32]
Character [id=255, name=Tywin, surname=Lannister, alive=false, age=null]
</code></pre><h3 id=create-an-index>Create an index <a href=/3.11/develop/integrations/spring-boot-arangodb/#create-an-index class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Indexes allow fast access to documents, provided the indexed attribute(s) are
used in a query. To make <code>findBySurname</code> queries faster, you can create an index
on the <code>surname</code> field, adding the <code>@PersistentIndex</code> to the <code>Character</code> class:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Document</span><span class=o>(</span><span class=s>&#34;characters&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@PersistentIndex</span><span class=o>(</span><span class=n>fields</span> <span class=o>=</span> <span class=o>{</span><span class=s>&#34;surname&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Character</span> <span class=o>{</span>
</span></span></code></pre></div><p>Next time you run the demo, the related queries benefit from the index and
avoid performing a full collection scan.</p><h3 id=more-complex-findby>More complex findBy <a href=/3.11/develop/integrations/spring-boot-arangodb/#more-complex-findby class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Create some methods with more parts and have a look at how they fit together.
You can use different return types. Again, simply add the methods in your
<code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findTop2DistinctBySurnameIgnoreCaseOrderByAgeDesc</span><span class=o>(</span><span class=n>String</span> <span class=n>surname</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findBySurnameEndsWithAndAgeBetweenAndNameInAllIgnoreCase</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>suffix</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>lowerBound</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>upperBound</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span><span class=o>[]</span><span class=n>nameList</span><span class=o>);</span>
</span></span></code></pre></div><p>Also add the method calls in <code>DerivedMethodRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find top 2 Lannnisters ordered by age&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>top2</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findTop2DistinctBySurnameIgnoreCaseOrderByAgeDesc</span><span class=o>(</span><span class=s>&#34;lannister&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>top2</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all characters which name is &#39;Bran&#39; or &#39;Sansa&#39; and it&#39;s surname ends with &#39;ark&#39; and are between 10 and 16 years old&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>youngStarks</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findBySurnameEndsWithAndAgeBetweenAndNameInAllIgnoreCase</span><span class=o>(</span><span class=s>&#34;ark&#34;</span><span class=o>,</span> <span class=mi>10</span><span class=o>,</span> <span class=mi>16</span><span class=o>,</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span><span class=s>&#34;Bran&#34;</span><span class=o>,</span> <span class=s>&#34;Sansa&#34;</span><span class=o>});</span>
</span></span><span class=line><span class=cl><span class=n>youngStarks</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>The new methods produce the following console output:</p><pre tabindex=0><code>## Find top 2 Lannnisters ordered by age
Character [id=444, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=446, name=Cersei, surname=Lannister, alive=true, age=36]
## Find all characters which name is &#39;Bran&#39; or &#39;Sansa&#39; and it&#39;s surname ends with &#39;ark&#39; and are between 10 and 16 years old
Character [id=452, name=Sansa, surname=Stark, alive=true, age=13]
Character [id=456, name=Bran, surname=Stark, alive=true, age=10]
</code></pre><h3 id=single-entity-result>Single entity result <a href=/3.11/develop/integrations/spring-boot-arangodb/#single-entity-result class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>With derived queries, you can not only query for multiple entities, but also for
single entities. If you expect only a single entity as the result, you can use
the corresponding return type.</p><p>Because you have a unique persistent index on the fields <code>name</code> and <code>surname</code>,
you can expect only a single entity when querying for both.</p><p>For this example, add the method <code>findByNameAndSurname(String, String)</code> in
<code>CharacterRepository</code>, whose return type is <code>Optional&lt;Character></code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Optional</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findByNameAndSurname</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>String</span> <span class=n>surname</span><span class=o>);</span>
</span></span></code></pre></div><p>Call it from <code>DerivedMethodRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find a single character by name &amp; surname&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Optional</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>tyrion</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Tyrion&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>tyrion</span><span class=o>.</span><span class=na>ifPresent</span><span class=o>(</span><span class=n>c</span> <span class=o>-&gt;</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Found %s&#34;</span><span class=o>,</span> <span class=n>c</span><span class=o>)));</span>
</span></span></code></pre></div><p>The console output should look like this:</p><pre tabindex=0><code>## Find a single character by name &amp; surname
Found Character [id=974, name=Tyrion, surname=Lannister, alive=true, age=32]
</code></pre><h3 id=countby>countBy <a href=/3.11/develop/integrations/spring-boot-arangodb/#countby class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Aside from <code>findBy</code>, there are other supported prefixes like <code>countBy</code>.
In comparison to the previously used <code>operations.collection(Character.class).count();</code>,
the <code>countBy</code> is able to include filter conditions.</p><p>With the following lines of code, you are able to only count characters that
are still alive.</p><p><code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Integer</span> <span class=nf>countByAliveTrue</span><span class=o>();</span>
</span></span></code></pre></div><p><code>DerivedMethodRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Count how many characters are still alive&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Integer</span> <span class=n>alive</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>countByAliveTrue</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;There are %s characters still alive&#34;</span><span class=o>,</span> <span class=n>alive</span><span class=o>));</span>
</span></span></code></pre></div><h3 id=removeby>removeBy <a href=/3.11/develop/integrations/spring-boot-arangodb/#removeby class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The last example for derived queries is <code>removeBy</code>. Here, remove all characters
except those whose surname is &lsquo;Stark&rsquo; and who are still alive.</p><p><code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>void</span> <span class=nf>removeBySurnameNotLikeOrAliveFalse</span><span class=o>(</span><span class=n>String</span> <span class=n>surname</span><span class=o>);</span>
</span></span></code></pre></div><p><code>DerivedMethodRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Remove all characters except of which surname is &#39;Stark&#39; and which are still alive&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>repository</span><span class=o>.</span><span class=na>removeBySurnameNotLikeOrAliveFalse</span><span class=o>(</span><span class=s>&#34;Stark&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>repository</span><span class=o>.</span><span class=na>findAll</span><span class=o>().</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>Only Arya, Bran, and Sansa are expected to be left.</p><pre tabindex=0><code>## Remove all characters except of which surname is &#39;Stark&#39; and which are still alive
Character [id=1453, name=Sansa, surname=Stark, alive=true, age=13]
Character [id=1454, name=Arya, surname=Stark, alive=true, age=11]
Character [id=1457, name=Bran, surname=Stark, alive=true, age=10]
</code></pre><h2 id=relations>Relations <a href=/3.11/develop/integrations/spring-boot-arangodb/#relations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB is a graph database system and Spring Data ArangoDB also supports
features for graphs.</p><p>With the <code>@Relations</code> annotation, you can define relationships between the
entities.</p><p>To demonstrate this, use the previously created <code>Character</code> entity.
Add a <code>children</code> field of type <code>Collection&lt;Character></code> annotated with
<code>@Relations(edges = ChildOf.class, lazy = true)</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Document</span><span class=o>(</span><span class=s>&#34;characters&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@PersistentIndex</span><span class=o>(</span><span class=n>fields</span> <span class=o>=</span> <span class=o>{</span><span class=s>&#34;surname&#34;</span><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Character</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span> <span class=c1>// db document field: _key
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ArangoId</span> <span class=c1>// db document field: _id
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>arangoId</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>surname</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>boolean</span> <span class=n>alive</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>age</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Relations</span><span class=o>(</span><span class=n>edges</span> <span class=o>=</span> <span class=n>ChildOf</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>lazy</span> <span class=o>=</span> <span class=kc>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>children</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Then create an entity for the edge you stated in <code>@Relations</code>. Other than a
normal entity annotated with <code>@Document</code>, this entity is annotated with
<code>@Edge</code>. This allows Spring Data ArangoDB to create an edge collection in
the database. Just like <code>Character</code>, <code>ChildOf</code> also gets a field for its
<code>id</code>. To connect two <code>Character</code> entities, it also gets a field of type
<code>Character</code> annotated with <code>@From</code> and a field of type <code>Character</code> annotated
with <code>@To</code>. <code>ChildOf</code> is persisted in the database with the ids of these
two characters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.entity</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.Edge</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.From</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.To</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.annotation.Id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Edge</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ChildOf</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@From</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Character</span> <span class=n>child</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@To</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Character</span> <span class=n>parent</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>ChildOf</span><span class=o>(</span><span class=kd>final</span> <span class=n>Character</span> <span class=n>child</span><span class=o>,</span> <span class=kd>final</span> <span class=n>Character</span> <span class=n>parent</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>child</span> <span class=o>=</span> <span class=n>child</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>parent</span> <span class=o>=</span> <span class=n>parent</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// setter &amp; getter
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s>&#34;ChildOf [id=&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;, child=&#34;</span> <span class=o>+</span> <span class=n>child</span> <span class=o>+</span> <span class=s>&#34;, parent=&#34;</span> <span class=o>+</span> <span class=n>parent</span> <span class=o>+</span> <span class=s>&#34;]&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>To save instances of <code>ChildOf</code> in the database, create a repository for it the
same way you created <code>CharacterRepository</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.ChildOf</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.repository.ArangoRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>ChildOfRepository</span> <span class=kd>extends</span> <span class=n>ArangoRepository</span><span class=o>&lt;</span><span class=n>ChildOf</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Implement another <code>CommandLineRunner</code> called <code>RelationsRunner</code> and add it to
your <code>DemoApplication</code> like with all the runners before.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span> <span class=n>runner</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span>
</span></span><span class=line><span class=cl>        <span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ByExampleRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DerivedQueryRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>RelationsRunner</span><span class=o>.</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><p>In the newly created <code>RelationsRunner</code>, inject <code>CharacterRepository</code> and
<code>ChildOfRepository</code> and built your relations. First, save some characters
because you removed most of them earlier. To do so, use the static
<code>createCharacter()</code> method of the <code>CrudRunner</code>. After you have successfully
persisted your characters, save some relationships with the edge entity <code>ChildOf</code>.
Because <code>ChildOf</code> requires instances of <code>Character</code> with the <code>id</code> field set by
the database, you first have to find them in your <code>CharacterRepository</code>.
To ensure you find the correct <code>Character</code>, use the derived query method
<code>findByNameAndSurename(String, String)</code> that gives you one specific <code>Character</code>.
Then create instances of <code>ChildOf</code> and save them through <code>ChildOfRepository</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.ChildOf</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.ChildOfRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.context.annotation.ComponentScan</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Arrays</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.arangodb.spring.demo&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RelationsRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>characterRepo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ChildOfRepository</span> <span class=n>childOfRepo</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;# Relations&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>characterRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>CrudRunner</span><span class=o>.</span><span class=na>createCharacters</span><span class=o>());</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>        <span class=c1>// first create some relations for the Starks and Lannisters
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Character</span> <span class=n>ned</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Ned&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>catelyn</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Catelyn&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>robb</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Robb&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>robb</span><span class=o>,</span> <span class=n>ned</span><span class=o>),</span> <span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>robb</span><span class=o>,</span> <span class=n>catelyn</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>sansa</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Sansa&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>sansa</span><span class=o>,</span> <span class=n>ned</span><span class=o>),</span> <span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>sansa</span><span class=o>,</span> <span class=n>catelyn</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>arya</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Arya&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>arya</span><span class=o>,</span> <span class=n>ned</span><span class=o>),</span> <span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>arya</span><span class=o>,</span> <span class=n>catelyn</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>bran</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Bran&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>bran</span><span class=o>,</span> <span class=n>ned</span><span class=o>),</span> <span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>bran</span><span class=o>,</span> <span class=n>catelyn</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>jon</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Jon&#34;</span><span class=o>,</span> <span class=s>&#34;Snow&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>jon</span><span class=o>,</span> <span class=n>ned</span><span class=o>));</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>tywin</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Tywin&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>jaime</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Jaime&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>jaime</span><span class=o>,</span> <span class=n>tywin</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>cersei</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Cersei&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>cersei</span><span class=o>,</span> <span class=n>tywin</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>joffrey</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Joffrey&#34;</span><span class=o>,</span> <span class=s>&#34;Baratheon&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>joffrey</span><span class=o>,</span> <span class=n>jaime</span><span class=o>),</span> <span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>joffrey</span><span class=o>,</span> <span class=n>cersei</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>tyrion</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Tyrion&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>childOfRepo</span><span class=o>.</span><span class=na>save</span><span class=o>(</span><span class=k>new</span> <span class=n>ChildOf</span><span class=o>(</span><span class=n>tyrion</span><span class=o>,</span> <span class=n>tywin</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=read-relations-within-an-entity>Read relations within an entity <a href=/3.11/develop/integrations/spring-boot-arangodb/#read-relations-within-an-entity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>After you add <code>@Relations(edges = ChildOf.class, lazy = true) Collection&lt;Character> children;</code>
in <code>Character</code> you can load all children of a character when you fetch the
character from the database. Use the <code>findByNameAndSurname(String, String)</code>
method again to find one specific character.</p><p>Add the following lines of code to the <code>run()</code> method of <code>RelationsRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Character</span> <span class=n>nedStark</span> <span class=o>=</span> <span class=n>characterRepo</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Ned&#34;</span><span class=o>,</span> <span class=s>&#34;Stark&#34;</span><span class=o>).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;## These are the children of %s:&#34;</span><span class=o>,</span> <span class=n>nedStark</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>nedStark</span><span class=o>.</span><span class=na>getChildren</span><span class=o>().</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>After executing the demo again, you can see the following console output:</p><pre tabindex=0><code>## These are the children of Character [id=2547, name=Ned, surname=Stark, alive=false, age=41]:
Character [id=2488, name=Bran, surname=Stark, alive=true, age=10]
Character [id=2485, name=Arya, surname=Stark, alive=true, age=11]
Character [id=2559, name=Robb, surname=Stark, alive=false, age=null]
Character [id=2556, name=Jon, surname=Snow, alive=true, age=16]
Character [id=2484, name=Sansa, surname=Stark, alive=true, age=13]
</code></pre><h3 id=findby-including-relations>findBy including relations <a href=/3.11/develop/integrations/spring-boot-arangodb/#findby-including-relations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <code>children</code> field is not persisted in the character entity itself, it is
represented by the <code>ChildOf</code> edge. Nevertheless, you can write a derived method
which includes properties of all connected <code>Character</code>.</p><p>With the following two methods – added in <code>CharacterRepository</code> – you can query
for a <code>Character</code> which has a child with a given name or an age between two
given integers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findByChildrenName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Collection</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>findByChildrenAgeBetween</span><span class=o>(</span><span class=kt>int</span> <span class=n>lowerBound</span><span class=o>,</span> <span class=kt>int</span> <span class=n>upperBound</span><span class=o>);</span>
</span></span></code></pre></div><p>Call these methods in <code>RelationsRunner</code> and search for all parents of &lsquo;Sansa&rsquo;
and all parents that have a child between 16 and 20 years old.</p><pre tabindex=0><code>System.out.println(&#34;## These are the parents of &#39;Sansa&#39;&#34;);
Iterable&lt;Character&gt; parentsOfSansa = characterRepo.findByChildrenName(&#34;Sansa&#34;);
parentsOfSansa.forEach(System.out::println);

System.out.println(&#34;## These parents have a child which is between 16 and 20 years old&#34;);
Iterable&lt;Character&gt; childrenBetween16a20 = characterRepo.findByChildrenAgeBetween(16, 20);
childrenBetween16a20.forEach(System.out::println);
</code></pre><p>The console output shows us that Ned and Catelyn are the parents of Sansa and
that Ned, Jamie, and Cersei have at least one child in the age between 16 and
20 years.</p><pre tabindex=0><code>## These are the parents of &#39;Sansa&#39;
Character [id=2995, name=Ned, surname=Stark, alive=false, age=41]
Character [id=2998, name=Catelyn, surname=Stark, alive=false, age=40]
## These parents have a child which is between 16 and 20 years old
Character [id=2995, name=Ned, surname=Stark, alive=false, age=41]
Character [id=2997, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=2999, name=Cersei, surname=Lannister, alive=true, age=36]
</code></pre><h2 id=query-methods>Query methods <a href=/3.11/develop/integrations/spring-boot-arangodb/#query-methods class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>You can have repository methods with self-written AQL queries.</p><p>When it comes to more complex use cases where a derived method would get way too
long and become unreadable, queries using the <a href=/3.11/aql/ class=link>ArangoDB Query Language (AQL)</a>
can be supplied with the <code>@Query</code> annotation on methods in your repositories.</p><p>AQL supports the usage of <a href=/3.11/aql/fundamentals/bind-parameters/ class=link>bind parameters</a>,
thus allowing to separate the query text from literal values used in the query.
There are three ways of passing bind parameters to the query in the <code>@Query</code>
annotation that are described below.</p><h3 id=param-annotation>Param annotation <a href=/3.11/develop/integrations/spring-boot-arangodb/#param-annotation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To pass bind parameters to your query, you can use the <code>@Param</code> annotation.
With the <code>@Param</code> annotation, the argument is placed in the query at the place
corresponding to the value passed to the <code>@Param</code> annotation.</p><p>To demonstrate this, add another method to <code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;FOR c IN characters FILTER c.surname == @surname SORT c.age ASC RETURN c&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>getWithSurname</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;surname&#34;</span><span class=o>)</span> <span class=n>String</span> <span class=n>value</span><span class=o>);</span>
</span></span></code></pre></div><p>Here, the bind parameter is named <code>surname</code> and the method parameter <code>value</code> is
annoated with <code>@Param("surname")</code>. Only the value in the <code>@Param</code> annotation has
to match with your bind parameter, the method parameter name does not matter.</p><p>Note that this uses the collection name <code>characters</code> and not <code>character</code> in your
query. Normally, a collection would be named like the corresponding entity class.
However, you used <code>@Document("characters")</code> in <code>Character</code> which set the
collection name to <code>characters</code>.</p><p>Create a new <code>CommandLineRunner</code> and add it to our <code>DemoApplication</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Character</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.CharacterRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AQLRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;# AQL queries&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>DemoApplication</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span><span class=n>runner</span><span class=o>=</span><span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span>
</span></span><span class=line><span class=cl>        <span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ByExampleRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DerivedQueryRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>RelationsRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>AQLRunner</span><span class=o>.</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><p>Add the following lines to <code>AQLRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all characters with surname &#39;Lannister&#39; (sort by age ascending)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>lannisters</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>getWithSurname</span><span class=o>(</span><span class=s>&#34;Lannister&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>lannisters</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>The console output should give you all characters with <code>surname</code> Lannister.</p><pre tabindex=0><code>## Find all characters with surname &#39;Lannister&#39; (sort by age ascending)
Character [id=7613, name=Tywin, surname=Lannister, alive=false, age=null]
Character [id=7611, name=Tyrion, surname=Lannister, alive=true, age=32]
Character [id=7596, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=7598, name=Cersei, surname=Lannister, alive=true, age=36]
</code></pre><h3 id=bindvars-annotation>BindVars annotation <a href=/3.11/develop/integrations/spring-boot-arangodb/#bindvars-annotation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>In addition to number matching and the <code>@Param</code> annotation, you can use a method
parameter of type <code>Map&lt;String, Object></code> annotated with <code>@BindVars</code> as your
bind parameters. You can then fill the map with any parameter used in the query.</p><p>Add the following to <code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;FOR c IN @@col FILTER c.surname == @surname AND c.age &gt; @age RETURN c&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>ArangoCursor</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>getWithSurnameOlderThan</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;age&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>value</span><span class=o>,</span> <span class=nd>@BindVars</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>bindvars</span><span class=o>);</span>
</span></span></code></pre></div><p>This query uses three bind parameters <code>@@col</code>, <code>@surname</code>, and <code>@age</code>.
One of the bind parameter is written with two <code>@</code>. This is a special type of
bind parameter that exists for injecting collection names. This type of
bind parameter has a name prefixed with an additional <code>@</code> symbol.</p><p>Furthermore, <code>@Param</code> is used for the <code>@age</code> bind parameter but not for <code>@@col</code>
and <code>@surname</code>. These bind parameters have to be passed through the map annotated
with <code>@BindVars</code>. It is also possible to use both annotations within one query method.</p><p>The method call looks as expected. An integer is passed for the <code>age</code>
bind parameter and a map with the keys <code>surname</code> and <code>@col</code> to your new method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all characters with surname &#39;Lannister&#39; which are older than 35&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>bindvars</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>bindvars</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;surname&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>bindvars</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;@col&#34;</span><span class=o>,</span> <span class=n>Character</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>ArangoCursor</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>oldLannisters</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>getWithSurnameOlderThan</span><span class=o>(</span><span class=mi>35</span><span class=o>,</span> <span class=n>bindvars</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>oldLannisters</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>One additional special handling for collection bind parameter is that you do not
have to pass the collection name as a String to the method. You can pass the type
(<code>Character.class</code>) to your method. Spring Data ArangoDB determines the
collection name. This is very convenient if you have used an alternative
collection name within the <code>@Document</code> or <code>@Edge</code> annotations.</p><p>The console output should be as follows:</p><pre tabindex=0><code>## Find all characters with surname &#39;Lannister&#39; which are older than 35
Character [id=8294, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=8296, name=Cersei, surname=Lannister, alive=true, age=36]
</code></pre><h3 id=queryoptions-annotation>QueryOptions annotation <a href=/3.11/develop/integrations/spring-boot-arangodb/#queryoptions-annotation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Sometimes, you want to be able to configure the query execution on a technical
level. Spring Data ArangoDB provides the <code>@QueryOptions</code> annotation for this.
With this annotation, you are able to set something like a batch size to control
the number of results to be transferred from the database server in one roundtrip
and some other things.</p><p>For example, you can return the number of found results. To achieve that you
have to change the return type in the previously created <code>getWithSurnameOlderThan(int, Map)</code>
method from <code>Iterable&lt;Character></code> to <code>ArangoCursor&lt;Character></code>. <code>ArangoCursor</code>
provides a <code>getCount()</code> method that gives you the number of found results.
But this value is only returned from the database when you set the <code>count</code> flag
in the query options to <code>true</code>, so you also have to add the <code>@QueryOptions</code>
annotation to the method with <code>count = true</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;FOR c IN @@col FILTER c.surname == @surname AND c.age &gt; @age RETURN c&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@QueryOptions</span><span class=o>(</span><span class=n>count</span> <span class=o>=</span> <span class=kc>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>getWithSurnameOlderThan</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;age&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>value</span><span class=o>,</span> <span class=nd>@BindVars</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>bindvars</span><span class=o>);</span>
</span></span></code></pre></div><p>If you change the type of our <code>oldLannisters</code> local variable in <code>AQLRunner</code>
to <code>ArangoCursor</code>, you can get the count value from it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArangoCursor</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>oldLannisters</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>getWithSurnameOlderThan</span><span class=o>(</span><span class=mi>35</span><span class=o>,</span> <span class=n>bindvars</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>String</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&#34;Found %s documents&#34;</span><span class=o>,</span> <span class=n>oldLannisters</span><span class=o>.</span><span class=na>getCount</span><span class=o>()));</span>
</span></span><span class=line><span class=cl><span class=n>oldLannisters</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>The new console output should look like this:</p><pre tabindex=0><code>## Find all characters with surname &#39;Lannister&#39; which are older than 35
Found 2 documents
Character [id=9012, name=Jaime, surname=Lannister, alive=true, age=36]
Character [id=9014, name=Cersei, surname=Lannister, alive=true, age=36]
</code></pre><h3 id=graph-traversal>Graph traversal <a href=/3.11/develop/integrations/spring-boot-arangodb/#graph-traversal class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To finish the query method topic, add a <a href=/3.11/aql/graphs/traversals/ class=link>graph traversal</a>
written in AQL to this demo where the <code>ChildOf</code> edges are involved.</p><p>The following query searches for every <code>Character</code> connected (through <code>ChildOf</code>)
with the character to whom the passed <code>id</code> belongs to. This time, specify the
edge collection in the query that you pass as a bind parameter with the
<code>@Param</code> annotation.</p><p><code>CharacterRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Query</span><span class=o>(</span><span class=s>&#34;FOR v IN 1..2 INBOUND @arangoId @@edgeCol SORT v.age DESC RETURN DISTINCT v&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=nf>getAllChildrenAndGrandchildren</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;arangoId&#34;</span><span class=o>)</span> <span class=n>String</span> <span class=n>arangoId</span><span class=o>,</span> <span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;@edgeCol&#34;</span><span class=o>)</span> <span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>edgeCollection</span><span class=o>);</span>
</span></span></code></pre></div><p>Like before with <code>Character.class</code> in your map, use the type of <code>ChildOf</code> as
the parameter value. To find all children and grandchildren of Tywin Lannister,
you first have to find him to get his <code>id</code> which you can then pass to the
query method.</p><p><code>AQLRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all children and grantchildren of &#39;Tywin Lannister&#39; (sort by age descending)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>children</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByNameAndSurname</span><span class=o>(</span><span class=s>&#34;Tywin&#34;</span><span class=o>,</span> <span class=s>&#34;Lannister&#34;</span><span class=o>).</span><span class=na>map</span><span class=o>(</span><span class=n>tywin</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>repository</span><span class=o>.</span><span class=na>getAllChildrenAndGrandchildren</span><span class=o>(</span><span class=n>tywin</span><span class=o>.</span><span class=na>getArangoId</span><span class=o>(),</span> <span class=n>ChildOf</span><span class=o>.</span><span class=na>class</span><span class=o>)).</span><span class=na>get</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>children</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>After executing the demo again, you can see the following console output:</p><pre tabindex=0><code>## Find all children and grantchildren of &#39;Tywin Lannister&#39; (sort by age descending)
Character [id=11255, name=Tyrion, surname=Lannister, alive=true, age=32]
Character [id=11242, name=Cersei, surname=Lannister, alive=true, age=36]
Character [id=11253, name=Joffrey, surname=Baratheon, alive=false, age=19]
Character [id=11240, name=Jaime, surname=Lannister, alive=true, age=36]
</code></pre><h2 id=geospatial-queries>Geospatial queries <a href=/3.11/develop/integrations/spring-boot-arangodb/#geospatial-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Geospatial queries are a subsection of derived queries. To use a geospatial
query on a collection, a geo index must exist on that collection. A geo index
can be created on a field which is a two element array, corresponding to latitude
and longitude coordinates.</p><p>As a subsection of derived queries, geospatial queries support the same
return types, and also these additional three return types: <code>GeoPage</code>,
<code>GeoResult</code>, and <code>GeoResults</code>. These types must be used in order to get the
distance of each document as generated by the query.</p><h3 id=geo-data-modeling>Geo data modeling <a href=/3.11/develop/integrations/spring-boot-arangodb/#geo-data-modeling class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>To demonstrate geospatial queries, create a new entity class <code>Location</code> with a
<code>location</code> field of type <code>org.springframework.data.geo.Point</code>. You also have to
create a geo index on this field. You can do so by annotating the field with
<code>@GeoIndexed(geoJson = true)</code>. As you probably remember, you have already used
an index in the <code>Character</code> class, but you annotated the type and not the
affected fields.</p><p>Spring Data ArangoDB offers two ways of defining an index. With the
<code>@&lt;IndexType>Indexed</code> annotations, indexes for single fields can be defined.
If the index should include multiple fields, the <code>@&lt;IndexType>Index</code> annotations
can be used on the type instead. See the <a href=/3.11/develop/integrations/spring-data-arangodb/reference-version-4/mapping/indexes/ class=link>reference documentation</a>
for more information.</p><p>Create a new <code>Location</code> class:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.entity</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.Document</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.annotation.GeoIndexed</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.annotation.Id</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.data.geo.Point</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Arrays</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Document</span><span class=o>(</span><span class=s>&#34;locations&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Location</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeoIndexed</span><span class=o>(</span><span class=n>geoJson</span> <span class=o>=</span> <span class=kc>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>final</span> <span class=n>Point</span> <span class=n>location</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Location</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=kd>final</span> <span class=n>Point</span> <span class=n>location</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>location</span> <span class=o>=</span> <span class=n>location</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// getter &amp; setter
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>toString</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s>&#34;Location{&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;id=&#39;&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=sc>&#39;\&#39;&#39;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;, name=&#39;&#34;</span> <span class=o>+</span> <span class=n>name</span> <span class=o>+</span> <span class=sc>&#39;\&#39;&#39;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=s>&#34;, location=&#34;</span> <span class=o>+</span> <span class=n>location</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>              <span class=sc>&#39;}&#39;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Create the corresponding <code>LocationRepository</code> repository:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Location</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.springframework.repository.ArangoRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>LocationRepository</span> <span class=kd>extends</span> <span class=n>ArangoRepository</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>After that, create a new <code>CommandLineRunner</code>, add it to your <code>DemoApplication</code>,
and perform some insert operations with some popular locations from
Game of Thrones with the coordinates of their real counterparts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.arangodb.spring.demo.runner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.entity.Location</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.arangodb.spring.demo.repository.LocationRepository</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>org.springframework.boot.CommandLineRunner</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Arrays</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GeospatialRunner</span> <span class=kd>implements</span> <span class=n>CommandLineRunner</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>LocationRepository</span> <span class=n>repository</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>...</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;# Geospatial&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>repository</span><span class=o>.</span><span class=na>saveAll</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Dragonstone&#34;</span><span class=o>,</span>     <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>6</span><span class=o>.</span><span class=na>815096</span><span class=o>,</span> <span class=mi>55</span><span class=o>.</span><span class=na>167801</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;King&#39;s Landing&#34;</span><span class=o>,</span>  <span class=k>new</span> <span class=n>Point</span><span class=o>(</span><span class=mi>18</span><span class=o>.</span><span class=na>110189</span><span class=o>,</span> <span class=mi>42</span><span class=o>.</span><span class=na>639752</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;The Red Keep&#34;</span><span class=o>,</span>    <span class=k>new</span> <span class=n>Point</span><span class=o>(</span><span class=mi>14</span><span class=o>.</span><span class=na>446442</span><span class=o>,</span> <span class=mi>35</span><span class=o>.</span><span class=na>896447</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Yunkai&#34;</span><span class=o>,</span>          <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>7</span><span class=o>.</span><span class=na>129532</span><span class=o>,</span> <span class=mi>31</span><span class=o>.</span><span class=na>046642</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Astapor&#34;</span><span class=o>,</span>         <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>9</span><span class=o>.</span><span class=na>774249</span><span class=o>,</span> <span class=mi>31</span><span class=o>.</span><span class=na>50974</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Winterfell&#34;</span><span class=o>,</span>      <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>5</span><span class=o>.</span><span class=na>581312</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>368321</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Vaes Dothrak&#34;</span><span class=o>,</span>    <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>6</span><span class=o>.</span><span class=na>096125</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>16776</span><span class=o>)),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Location</span><span class=o>(</span><span class=s>&#34;Beyond the wall&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>21</span><span class=o>.</span><span class=na>094093</span><span class=o>,</span> <span class=mi>64</span><span class=o>.</span><span class=na>265473</span><span class=o>))</span>
</span></span><span class=line><span class=cl>        <span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>DemoApplication</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Class</span><span class=o>&lt;?&gt;[]</span><span class=n>runner</span><span class=o>=</span><span class=k>new</span> <span class=n>Class</span><span class=o>&lt;?&gt;[]{</span>
</span></span><span class=line><span class=cl>        <span class=n>CrudRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>ByExampleRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DerivedQueryRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>RelationsRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>AQLRunner</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=n>GeospatialRunner</span><span class=o>.</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=o>};</span>
</span></span></code></pre></div><p>There are two kinds of geospatial query: <code>Near</code> and <code>Within</code>.</p><h3 id=near>Near <a href=/3.11/develop/integrations/spring-boot-arangodb/#near class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><code>Near</code> sorts entities by distance from a given point.
The result can be restricted with paging.</p><p><code>LocationRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>GeoPage</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=nf>findByLocationNear</span><span class=o>(</span><span class=n>Point</span> <span class=n>location</span><span class=o>,</span><span class=n>Pageable</span> <span class=n>pageable</span><span class=o>);</span>
</span></span></code></pre></div><p>In this example, search for locations sorted by distance to a given point,
matching the coordinates of Winterfell. Use pagination to split the results in
pages of five locations.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find the first 5 locations near &#39;Winterfell&#39;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>GeoPage</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=n>first5</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByLocationNear</span><span class=o>(</span><span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>5</span><span class=o>.</span><span class=na>581312</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>368321</span><span class=o>),</span> <span class=n>PageRequest</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=mi>0</span><span class=o>,</span> <span class=mi>5</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>first5</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find the next 5 locations near &#39;Winterfell&#39; (only 3 locations left)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>GeoPage</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=n>next5</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByLocationNear</span><span class=o>(</span><span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>5</span><span class=o>.</span><span class=na>581312</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>368321</span><span class=o>),</span> <span class=n>PageRequest</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=mi>5</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>next5</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>Because you use the coordinates of Winterfell, the distance in the output to
Winterfell is <code>0</code>.</p><pre tabindex=0><code>## Find the first 5 locations near &#39;Winterfell&#39;
GeoResult [content: Location [id=14404, name=Yunkai, location=[31.046642, -7.129532]], distance: 3533.2076972451478 KILOMETERS, ]
GeoResult [content: Location [id=14405, name=Astapor, location=[31.50974, -9.774249]], distance: 3651.785495816579 KILOMETERS, ]
GeoResult [content: Location [id=14403, name=The Red Keep, location=[35.896447, 14.446442]], distance: 4261.971994059222 KILOMETERS, ]
GeoResult [content: Location [id=14402, name=King&#39;s Landing, location=[42.639752, 18.110189]], distance: 5074.755682897005 KILOMETERS, ]
GeoResult [content: Location [id=14407, name=Vaes Dothrak, location=[54.16776, -6.096125]], distance: 6049.156388427102 KILOMETERS, ]
## Find the next 5 locations near &#39;Winterfell&#39; (only 3 locations left)
GeoResult [content: Location [id=14406, name=Winterfell, location=[54.368321, -5.581312]], distance: 6067.104268175527 KILOMETERS, ]
GeoResult [content: Location [id=14401, name=Dragonstone, location=[55.167801, -6.815096]], distance: 6165.650581599857 KILOMETERS, ]
GeoResult [content: Location [id=14408, name=Beyond the wall, location=[64.265473, -21.094093]], distance: 7350.229798961836 KILOMETERS, ]
</code></pre><h3 id=within>Within <a href=/3.11/develop/integrations/spring-boot-arangodb/#within class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><code>Within</code> both sorts and filters entities, returning those within the given
distance, range, or shape.</p><p>Add some methods to <code>LocationRepository</code> that use different filter criteria:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>GeoResults</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=nf>findByLocationWithin</span><span class=o>(</span><span class=n>Point</span> <span class=n>location</span><span class=o>,</span><span class=n>Distance</span> <span class=n>distance</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=nf>findByLocationWithin</span><span class=o>(</span><span class=n>Point</span> <span class=n>location</span><span class=o>,</span><span class=n>Range</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span> <span class=n>distanceRange</span><span class=o>);</span>
</span></span></code></pre></div><p>With these methods, you can search for locations within a given distance or
range to our point – Winterfell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all locations within 50 kilometers of &#39;Winterfell&#39;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>GeoResults</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=n>findWithing50kilometers</span> <span class=o>=</span> <span class=n>repository</span>
</span></span><span class=line><span class=cl>    <span class=o>.</span><span class=na>findByLocationWithin</span><span class=o>(</span><span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>5</span><span class=o>.</span><span class=na>581312</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>368321</span><span class=o>),</span> <span class=k>new</span> <span class=n>Distance</span><span class=o>(</span><span class=mi>50</span><span class=o>,</span> <span class=n>Metrics</span><span class=o>.</span><span class=na>KILOMETERS</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>findWithing50kilometers</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all locations which are 40 to 50 kilometers away from &#39;Winterfell&#39;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=n>findByLocationWithin</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByLocationWithin</span><span class=o>(</span><span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>5</span><span class=o>.</span><span class=na>581312</span><span class=o>,</span> <span class=mi>54</span><span class=o>.</span><span class=na>368321</span><span class=o>),</span>
</span></span><span class=line><span class=cl>    <span class=n>Range</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=n>Range</span><span class=o>.</span><span class=na>Bound</span><span class=o>.</span><span class=na>inclusive</span><span class=o>(</span><span class=mi>40000</span><span class=o>.),</span> <span class=n>Range</span><span class=o>.</span><span class=na>Bound</span><span class=o>.</span><span class=na>exclusive</span><span class=o>(</span><span class=mi>50000</span><span class=o>.)));</span>
</span></span><span class=line><span class=cl><span class=n>findByLocationWithin</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>As you can see in the console output, both <em>Winterfell</em> and <em>Vaes Dothrak</em> are
located within a 50 kilometers radius around your point. But only <em>Vaes Dothrak</em>
is obviously more than 40 kilometers away from it.</p><pre tabindex=0><code>## Find all locations within 50 kilometers of &#39;Winterfell&#39;
GeoResult [content: Location [id=14843, name=Winterfell, location=[54.368321, -5.581312]], distance: 0.0 KILOMETERS, ]
GeoResult [content: Location [id=14844, name=Vaes Dothrak, location=[54.16776, -6.096125]], distance: 40.186277071065994 KILOMETERS, ]
## Find all locations which are 40 to 50 kilometers away from &#39;Winterfell&#39;
Location [id=14844, name=Vaes Dothrak, location=[54.16776, -6.096125]]
</code></pre><p>You cannot only implement geo functions going from a single point but it is also
possible to search for locations within a polygon.</p><p>Add a method using <code>Polygon</code>:</p><p><code>LocationRepository</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=nf>findByLocationWithin</span><span class=o>(</span><span class=n>Polygon</span> <span class=n>polygon</span><span class=o>);</span>
</span></span></code></pre></div><p><code>GeospatialRunner</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;## Find all locations within a given polygon&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=n>Location</span><span class=o>&gt;</span> <span class=n>withinPolygon</span> <span class=o>=</span> <span class=n>repository</span><span class=o>.</span><span class=na>findByLocationWithin</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>Polygon</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>25</span><span class=o>,</span> <span class=mi>40</span><span class=o>),</span> <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>25</span><span class=o>,</span> <span class=mi>70</span><span class=o>),</span> <span class=k>new</span> <span class=n>Point</span><span class=o>(</span><span class=mi>25</span><span class=o>,</span> <span class=mi>70</span><span class=o>),</span> <span class=k>new</span> <span class=n>Point</span><span class=o>(-</span><span class=mi>25</span><span class=o>,</span> <span class=mi>40</span><span class=o>))));</span>
</span></span><span class=line><span class=cl><span class=n>withinPolygon</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>::</span><span class=n>println</span><span class=o>);</span>
</span></span></code></pre></div><p>The console output should be as follows:</p><pre tabindex=0><code>## Find all locations within a given polygon
Location [id=16922, name=Beyond the wall, location=[64.265473, -21.094093]]
</code></pre><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.11/develop/integrations/spring-data-arangodb/><i class="fas fa-chevron-left fa-fw"></i><p>Spring Data</p></a></span><span class=next><a class="nav nav-next link" href=/3.11/develop/integrations/arangodb-datasource-for-apache-spark/><p>Datasource for Apache Spark</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.11/develop/integrations/spring-boot-arangodb.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#supported-versions>Supported versions</a></div><div class=level-2><a href=#get-started>Get started</a></div><div class=level-3><a href=#build-a-project-with-maven>Build a project with Maven</a></div><div class=level-3><a href=#monitor-the-server-health>Monitor the server health</a></div><div class=level-3><a href=#create-an-application-class>Create an Application class</a></div><div class=level-3><a href=#application-configuration>Application configuration</a></div><div class=level-2><a href=#data-modeling>Data modeling</a></div><div class=level-2><a href=#crud-operations>CRUD operations</a></div><div class=level-3><a href=#create-a-repository>Create a repository</a></div><div class=level-3><a href=#create-a-commandlinerunner>Create a CommandLineRunner</a></div><div class=level-3><a href=#save-and-read-an-entity>Save and read an entity</a></div><div class=level-3><a href=#run-the-demo>Run the demo</a></div><div class=level-3><a href=#update-an-entity>Update an entity</a></div><div class=level-3><a href=#save-and-read-multiple-entities>Save and read multiple entities</a></div><div class=level-3><a href=#read-with-sorting-and-paging>Read with sorting and paging</a></div><div class=level-2><a href=#query-by-example>Query by example</a></div><div class=level-3><a href=#single-entity>Single entity</a></div><div class=level-3><a href=#multiple-entities>Multiple entities</a></div><div class=level-2><a href=#derived-queries>Derived queries</a></div><div class=level-3><a href=#simple-findby>Simple findBy</a></div><div class=level-3><a href=#create-an-index>Create an index</a></div><div class=level-3><a href=#more-complex-findby>More complex findBy</a></div><div class=level-3><a href=#single-entity-result>Single entity result</a></div><div class=level-3><a href=#countby>countBy</a></div><div class=level-3><a href=#removeby>removeBy</a></div><div class=level-2><a href=#relations>Relations</a></div><div class=level-3><a href=#read-relations-within-an-entity>Read relations within an entity</a></div><div class=level-3><a href=#findby-including-relations>findBy including relations</a></div><div class=level-2><a href=#query-methods>Query methods</a></div><div class=level-3><a href=#param-annotation>Param annotation</a></div><div class=level-3><a href=#bindvars-annotation>BindVars annotation</a></div><div class=level-3><a href=#queryoptions-annotation>QueryOptions annotation</a></div><div class=level-3><a href=#graph-traversal>Graph traversal</a></div><div class=level-2><a href=#geospatial-queries>Geospatial queries</a></div><div class=level-3><a href=#geo-data-modeling>Geo data modeling</a></div><div class=level-3><a href=#near>Near</a></div><div class=level-3><a href=#within>Within</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>