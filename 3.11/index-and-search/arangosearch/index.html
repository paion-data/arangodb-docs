<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1747031427></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoSearch is ArangoDB&amp;rsquo;s built-in search engine for full-text, complex data structures, and more"><meta property="og:url" content="http://localhost/3.11/index-and-search/arangosearch/"><meta property="og:title" content="Information Retrieval with ArangoSearch"><meta property="og:type" content="website"><meta property="og:description" content="ArangoSearch is ArangoDB&amp;rsquo;s built-in search engine for full-text, complex data structures, and more"><meta name=docsearch:version content="3.11"><title>Information Retrieval with ArangoSearch | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1747031427 defer></script>
<script src=/js/featherlight.min.js?1747031427 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1747031427 defer></script>
<script src=/js/theme.js?1747031427 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.11"><a itemprop=item class=link href=/3.11/><span itemprop=name class=breadcrumb-entry>3.11.13</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Index and Search"><a itemprop=item class=link href=/3.11/index-and-search/><span itemprop=name class=breadcrumb-entry>Index and Search</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="ArangoSearch"><a itemprop=item class=link href=/3.11/index-and-search/arangosearch/><span itemprop=name class=breadcrumb-entry>ArangoSearch</span></a></li></ol></nav><article class=default><hgroup><h1>Information Retrieval with ArangoSearch</h1><p class=lead>ArangoSearch is ArangoDB&rsquo;s built-in search engine for full-text, complex data structures, and more</p></hgroup><p>ArangoSearch provides information retrieval features, natively integrated
into ArangoDB&rsquo;s query language and with support for all data models. It is
primarily a full-text search engine, a much more powerful alternative to the
<a href=/3.11/index-and-search/indexing/working-with-indexes/fulltext-indexes/ class=link>full-text index</a> type. It can index nested fields
from multiple collections, optionally with transformations such as text
normalization and tokenization applied, rank query results by relevance and
more.</p><h2 id=example-use-cases>Example Use Cases <a href=/3.11/index-and-search/arangosearch/#example-use-cases class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><ul><li>Perform federated full-text searches over product descriptions for a
web shop, with the product documents stored in various collections.</li><li>Find information in a research database using stemmed phrases, case and
accent insensitive, with irrelevant terms removed from the search index
(stop word filtering), ranked by relevance based on term frequency (TFIDF).</li><li>Query a movie dataset for titles with words in a particular order
(optionally with wildcards), and sort the results by best matching (BM25)
but favor movies with a longer duration.</li></ul><h2 id=getting-started-with-arangosearch>Getting Started with ArangoSearch <a href=/3.11/index-and-search/arangosearch/#getting-started-with-arangosearch class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoSearch introduces the concept of <strong>Views</strong>, which can be seen as
virtual collections. There are two types of Views:</p><ul><li><p><strong><code>arangosearch</code> Views</strong>:
Each View of the <code>arangosearch</code> type represents an inverted index to provide fast
full-text searching over one or multiple linked collections and holds the
configuration for the search capabilities, such as the attributes to index.
It can cover multiple or even all attributes of the documents in the linked
collections.</p><p>See <a href=/3.11/index-and-search/arangosearch/arangosearch-views-reference/ class=link><code>arangosearch</code> Views Reference</a> for details.</p></li><li><p><strong><code>search-alias</code> Views</strong>:
Views of the <code>search-alias</code> type reference one or more
<a href=/3.11/index-and-search/indexing/working-with-indexes/inverted-indexes/ class=link>Inverted indexes</a>. Inverted indexes are defined on
the collection level and can be used stand-alone for filtering, but adding
them to a <code>search-alias</code> View enables you to search over multiple collections at
once, called &ldquo;federated search&rdquo;, and offers you the same capabilities for
ranking search results by relevance and search highlighting like with
<code>arangosearch</code> Views. Each inverted index can index multiple or even all
attribute of the documents of the collection it is defined for.</p><p>See <a href=/3.11/index-and-search/arangosearch/search-alias-views-reference/ class=link><code>search-alias</code> Views Reference</a> for details.</p></li></ul><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text>Views are not updated synchronously as the source collections
change in order to minimize the performance impact. They are
<strong>eventually consistent</strong>, with a configurable consolidation policy.</div></div></div></div><p>The input values can be processed by so called <a href=/3.11/index-and-search/analyzers/ class=link><strong>Analyzers</strong></a>
which can normalize strings, tokenize text into words and more, enabling
different possibilities to search for values later on.</p><p>Search results can be sorted by their similarity ranking to return the best
matches first using popular scoring algorithms (Okapi BM25, TF-IDF),
user-defined relevance boosting and dynamic score calculation.</p><p><figure class=image-caption><img alt="Conceptual model of ArangoSearch interacting with Collections and Analyzers" src=/images/arangosearch.png><figcaption></figcaption></figure></p><p>Views can be managed in the web interface, via an <a href=/3.11/develop/http-api/views/ class=link>HTTP API</a> and
through a <a href=/3.11/develop/javascript-api/@arangodb/db-object/#views class=link>JavaScript API</a>.</p><p>Views can be queried with AQL using the <a href=/3.11/aql/high-level-operations/search/ class=link><code>SEARCH</code> operation</a>.
It takes a search expression composed of the fields to search, the search terms,
logical and comparison operators, as well as
<a href=/3.11/aql/functions/arangosearch/ class=link>ArangoSearch functions</a>.</p><h3 id=create-your-first-arangosearch-view>Create your first <code>arangosearch</code> View <a href=/3.11/index-and-search/arangosearch/#create-your-first-arangosearch-view class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ol><li>Create a test collection (e.g. <code>food</code>) and insert a few documents so
that you have something to index and search for:<ul><li><code>{ "name": "avocado", "type": "fruit" }</code> (yes, it is a fruit)</li><li><code>{ "name": "carrot", "type": "vegetable" }</code></li><li><code>{ "name": "chili pepper", "type": "vegetable" }</code></li><li><code>{ "name": "tomato", "type": ["fruit", "vegetable"] }</code></li></ul></li><li>In the <strong>VIEWS</strong> section of the web interface, click the <strong>Add View</strong> card.</li><li>Enter a name (e.g. <code>food_view</code>) for the View, click <strong>Create</strong>, and click
the card of the newly created View.</li><li>Enter the name of the collection in the <strong>Links</strong> fields, then click the
underlined name to access the link properties and tick the
<strong>Include All Fields</strong> checkbox. In the editor on the right-hand side, you
can see the View definition in JSON format, including the following setting:<div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;links&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;food&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;includeAllFields&#34;</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span></span></span></code></pre></div></li><li>Click <strong>Save view</strong>. The View indexes all attributes (fields) of the documents
in the <code>food</code> collection from now on (with some delay). The attribute values
get processed by the default <code>identity</code> Analyzer, which means that they
get indexed unaltered. Note that arrays (<code>["fruit", "vegetable"]</code> in the example)
are automatically expanded in <code>arangosearch</code> Views by default, indexing the
individual elements of the array (<code>"fruit"</code> and <code>"vegetable"</code>).</li><li>In the <strong>QUERIES</strong> section, try the following query:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div>The View is used like a collection and simply iterated over to return all
(indexed) documents. You should see the documents stored in <code>food</code> as result.</li><li>Now add a search expression. Unlike with regular collections where you would
use <code>FILTER</code>, a <code>SEARCH</code> operation is needed to utilize the View index:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div>In this basic example, the ArangoSearch expression looks identical to a
<code>FILTER</code> expression, but this is not always the case. You can also combine
both, with <code>FILTER</code>s after <code>SEARCH</code>, in which case the filter criteria are
applied to the search results as a post-processing step.</li></ol><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text>Note that if you link a collection to a View and execute a query against this
View while it is still being indexed, you may not get complete results. In the
case where a View is still being built and simultaneously used in a query, the
query includes a warning message (code <code>1240</code>) informing you that the <code>arangosearch</code>
View building is in progress and results can be incomplete.</div></div></div></div><h3 id=create-your-first-search-alias-view>Create your first <code>search-alias</code> View <a href=/3.11/index-and-search/arangosearch/#create-your-first-search-alias-view class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ol><li>Create a test collection (e.g. <code>food</code>) and insert a few documents so
that you have something to index and search for. You may use the web interface
for this:<ul><li><code>{ "name": "avocado", "type": ["fruit"] }</code> (yes, it is a fruit)</li><li><code>{ "name": "carrot", "type": ["vegetable"] }</code></li><li><code>{ "name": "chili pepper", "type": ["vegetable"] }</code></li><li><code>{ "name": "tomato", "type": ["fruit", "vegetable"] }</code></li></ul></li><li>In the <strong>COLLECTIONS</strong> section of the web interface, click the <code>food</code> collection.</li><li>Go to the <strong>Indexes</strong> tab and click <strong>Add Index</strong>.</li><li>Select <strong>Inverted index</strong> as the <strong>Type</strong>.</li><li>In the <strong>Fields</strong> panel, enter <code>name</code> into <strong>Fields</strong> and confirm the value.
Then also add <code>type[*]</code> as a field.
The <code>[*]</code> is needed to index the individual elements of the <code>type</code> array.
Note that all <code>type</code> attributes of the example documents are arrays, even if
they only contain a single element. If you use <code>[*]</code> for expanding arrays,
only array elements are indexed, whereas primitive values like the string
<code>"fruit"</code> would be ignored by the inverted index (but see the <code>searchField</code>
options regarding exceptions).</li><li>In the <strong>General</strong> panel, give the index a <strong>Name</strong> like <code>inv-idx-name-type</code>
to make it easier for you to identify the index.</li><li>Click <strong>Create</strong>.
The inverted index indexes the specified attributes (fields) of the documents
in the <code>food</code> collection from now on (with some delay). The attribute values
get processed by the default <code>identity</code> Analyzer, which means that they
get indexed unaltered.</li><li>In the <strong>VIEWS</strong> section, click the <strong>Add View</strong> card.</li><li>Enter a name for the View (e.g. <code>food_view</code>) and select <strong>search-alias</strong>
as the <strong>Type</strong>.</li><li>Select the <code>food</code> collection as <strong>Collection</strong> and select the
inverted index you created for the collection as <strong>Index</strong>.</li><li>Click <strong>Create</strong>. The View uses the inverted index for searching and adds
additional functionality like ranking results and searching across
multiple collections at once.</li><li>In the <strong>QUERIES</strong> section, try the following query:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div>The View is used like a collection and simply iterated over to return all
(indexed) documents. You should see the documents stored in <code>food</code> as result.</li><li>Now add a search expression. Unlike with regular collections where you would
use <code>FILTER</code>, a <code>SEARCH</code> operation is needed to utilize the View index:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div>In this basic example, the ArangoSearch expression looks identical to a
<code>FILTER</code> expression, but this is not always the case. You can also combine
both, with <code>FILTER</code>s after <code>SEARCH</code>, in which case the filter criteria are
applied to the search results as a post-processing step.</li><li>You can also use the inverted index as a stand-alone index as demonstrated
below, by iterating over the collection (not the View) with an index hint to
utilize the inverted index together with the <code>FILTER</code> operation:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>indexHint</span><span class=o>:</span> <span class=s2>&#34;inv-idx-name-type&#34;</span><span class=p>,</span> <span class=n>forceIndexHint</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div>Note that you can&rsquo;t rank results and search across multiple collections
using stand-alone inverted index, but you can if you add inverted indexes
to a <code>search-alias</code> View and search the View with the <code>SEARCH</code> operation.</li></ol><h3 id=understanding-the-analyzer-context>Understanding the Analyzer context <a href=/3.11/index-and-search/arangosearch/#understanding-the-analyzer-context class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><code>arangosearch</code> Views allow you to index the same field with multiple Analyzers.
This makes it necessary to select the right one in your query by setting the
Analyzer context with the <code>ANALYZER()</code> function.</p><div class="box notices cstyle tip"><div class=box-content-container><div class=box-content><i class="fas fa-check"></i><div class=box-text>If you use <code>search-alias</code> Views, the Analyzers are inferred from the definitions
of the inverted indexes. This is possible because every field can only be
indexed with a single Analyzer. Don&rsquo;t specify the Analyzer context with the
<code>ANALYZER()</code> function in <code>search-alias</code> queries to avoid errors.</div></div></div></div><p>We did not specify an Analyzer explicitly in above example, but it worked
regardless. That is because the <code>identity</code> Analyzer is used by default in both
View definitions and AQL queries. The Analyzer chosen in a query needs to match
with one of the Analyzers that a field was indexed with as per the <code>arangosearch</code> View
definition - and this happened to be the case. We can rewrite the query to be
more explicit about the Analyzer context:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p><code>ANALYZER(… , "identity")</code> matches the Analyzer defined in the View
<code>"analyzers": [ "identity" ]</code>. The latter defines how fields are transformed at
index time, whereas the former selects which index to use at query time.</p><p>To use a different Analyzer, such as the built-in <code>text_en</code> Analyzer, you would
change the View definition to <code>"analyzers": [ "text_en", "identity" ]</code> (or just
<code>"analyzers": [ "text_en" ]</code> if you don&rsquo;t need the <code>identity</code> Analyzer at all)
as well as adjust the query to use <code>ANALYZER(… , "text_en")</code>.</p><p>If a field is not indexed with the Analyzer requested in the query, then you
will get an <strong>empty result</strong> back. Make sure that the fields are indexed
correctly and that you set the Analyzer context.</p><p>You can test if a field is indexed with particular Analyzer with one of the
variants of the <a href=/3.11/aql/functions/arangosearch/#exists class=link><code>EXISTS()</code> function</a>,
for example, as shown below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>RETURN</span> <span class=nf>LENGTH</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>    <span class=kp>SEARCH</span> <span class=nf>EXISTS</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;analyzer&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>LIMIT</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=kr>RETURN</span> <span class=kc>true</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span></span></span></code></pre></div><p>If you use an <code>arangosearch</code> View, you need to change the <code>"storeValues"</code>
property in the View definition from <code>"none"</code> to <code>"id"</code> for the function to work.
For <code>search-alias</code> Views, this feature is always enabled.</p><h3 id=basic-search-expressions>Basic search expressions <a href=/3.11/index-and-search/arangosearch/#basic-search-expressions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoSearch supports a variety of logical operators and comparison operators
to filter Views. A basic one is the <strong>equality</strong> comparison operator:</p><p><code>doc.name == "avocado"</code></p><p>The inversion (inequality) is also allowed:</p><p><code>doc.name != "avocado"</code></p><p>You can also test against multiple values with the <strong>IN</strong> operator:</p><p><code>doc.name IN ["avocado", "carrot"]</code></p><p>The same can be expressed with a logical <strong>OR</strong> for multiple conditions:</p><p><code>doc.name == "avocado" OR doc.name == "carrot"</code></p><p>Similarly, <strong>AND</strong> can be used to require that multiple conditions must be true:</p><p><code>doc.name == "avocado" AND doc.type == "fruit"</code></p><p>An interesting case is the tomato document with its two array elements as type:
<code>["fruit", "vegetable"]</code>. The View definition defaults to
<code>"trackListPositions": false</code>, which means that the array elements get indexed
individually as if the attribute had both string values at the same time
(requiring array expansion using <code>type[*]</code> or <code>"searchField": true</code> in case of the
inverted index for the <code>search-alias</code> View), matching the following conditions:</p><p><code>doc.type == "fruit" AND doc.type == "vegetable"</code></p><p>The same can be expressed with <code>ALL ==</code> and <code>ALL IN</code>. Note that the attribute
reference and the search conditions are swapped for this:</p><p><code>["fruit", "vegetable"] ALL == doc.type</code></p><p>To find fruits which are not vegetables at the same time, the latter can be
excluded with <code>NOT</code>:</p><p><code>doc.type == "fruit" AND NOT doc.type == "vegetable"</code></p><p>For a complete list of operators supported in ArangoSearch expressions see
<a href=/3.11/aql/high-level-operations/search/ class=link>AQL <code>SEARCH</code> operation</a>.</p><h3 id=searching-for-tokens-from-full-text>Searching for tokens from full-text <a href=/3.11/index-and-search/arangosearch/#searching-for-tokens-from-full-text class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>So far we searched for full matches of name and/or type. Strings could contain
more than just a single term however. It could be multiple words, sentences, or
paragraphs. For such text, we need a way to search for individual tokens,
usually the words that it is comprised of. This is where Text Analyzers come
in. A Text Analyzer tokenizes an entire string into individual tokens that are
then stored in an inverted index.</p><p>There are a few pre-configured text Analyzers, but you can also add your own as
needed. For now, let us use the built-in <code>text_en</code> Analyzer for tokenizing
English text.</p><p><em><code>arangosearch</code> View:</em></p><ol><li><p>In the <strong>VIEWS</strong> section of the web interface, click the card of the
previously created <code>food_view</code> of type <code>arangosearch</code>.</p></li><li><p>In the <strong>Links</strong> panel, click the underlined name of the
<code>food</code> collection. Enter <code>name</code> into <strong>Fields</strong> and confirm the value.</p></li><li><p>Click the underlined name of the field and select the <strong>Analyzers</strong> <code>text_en</code>
and <code>identity</code>.</p><p>Alternatively, use the editor on the right-hand side to replace <code>"fields": {},</code>
with the below code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;fields&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;analyzers&#34;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;text_en&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>},</span></span></span></code></pre></div></li><li><p>Click <strong>Save view</strong>.</p></li><li><p>After a few seconds, the <code>name</code> attribute has been indexed with the <code>text_en</code>
Analyzer in addition to the <code>identity</code> Analyzer.</p></li><li><p>Run below query that sets <code>text_en</code> as context Analyzer and searches for
the word <code>pepper</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;pepper&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div></li><li><p>It matches <code>chili pepper</code> because the Analyzer tokenized it into <code>chili</code> and
<code>pepper</code> and the latter matches the search criterion. Compare that to the
<code>identity</code> Analyzer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;pepper&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div><p>It does not match because <code>chili pepper</code> is indexed as a single token that
does not match the search criterion.</p></li><li><p>Switch back to the <code>text_en</code> Analyzer but with a different search term:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;PéPPêR&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div><p>This will not match anything, even though this particular Analyzer converts
characters to lowercase and accented characters to their base characters.
The problem is that this transformation is applied to the document attribute
when it gets indexed, but we haven&rsquo;t applied it to the search term.</p></li><li><p>If we apply the same transformation then we get a match:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;PéPPêR&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div><p>Note that the <a href=/3.11/aql/functions/string/#tokens class=link><code>TOKENS()</code> functions</a>
returns an array. We pick the first element with <code>[0]</code>, which is the
normalized search term <code>"pepper"</code>.</p></li></ol><p><em><code>search-alias</code> View:</em></p><ol><li>Collection indexes cannot be changed once created. Therefore, you need to
create a new inverted index to index a field differently.
In the <strong>COLLECTIONS</strong> section of the web interface, go to the <strong>Indexes</strong>
tab and click <strong>Add Index</strong>.</li><li>Select <strong>Inverted index</strong> as the <strong>Type</strong>.</li><li>In the <strong>Fields</strong> panel, enter <code>name</code> into <strong>Fields</strong> and confirm.</li><li>Click the underlined <code>name</code> field and select <code>text_en</code> as <strong>Analyzer</strong>.
Note that every field can only be indexed with a single Analyzer in inverted
indexes and <code>search-alias</code> Views.</li><li>In the <strong>General</strong> panel, give the index a <strong>Name</strong> like <code>inv-idx-name-en</code>
to make it easier for you to identify the index.</li><li>Click <strong>Create</strong>.
The inverted indexes indexes the <code>name</code> attribute of the documents with the
<code>text_en</code> Analyzer, which splits strings into tokens so that you can search
for individual words.</li><li>In the <strong>VIEWS</strong> section, click the <strong>Add View</strong> card.</li><li>Enter a name for the View (e.g. <code>food_view_fulltext</code>) and select
<strong>search-alias</strong> as the <strong>Type</strong>.</li><li>Select the <code>food</code> collection as <strong>Collection</strong> and select the
<code>inv-idx-name-en</code> inverted index as <strong>Index</strong>.</li><li>Click <strong>Create</strong>. After a few seconds, the <code>name</code> attribute has been indexed
with the <code>text_en</code> Analyzer.</li><li>Run below query which searches for the word <code>pepper</code>:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view_fulltext</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;pepper&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div>It matches <code>chili pepper</code> because the Analyzer tokenized it into <code>chili</code> and
<code>pepper</code> and the latter matches the search criterion.</li><li>Try a different search term:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view_fulltext</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;PéPPêR&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div>This does not match anything, even though the <code>text_en</code> Analyzer converts
characters to lowercase and accented characters to their base characters.
The problem is that this transformation is applied to the document attribute
when it gets indexed, but we haven&rsquo;t applied it to the search term.</li><li>If we apply the same transformation then we get a match:<div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view_fulltext</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;PéPPêR&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span></span></span></code></pre></div>Note that the <a href=/3.11/aql/functions/string/#tokens class=link><code>TOKENS()</code> functions</a>
returns an array. We pick the first element with <code>[0]</code>, which is the
normalized search term <code>"pepper"</code>.</li></ol><h3 id=search-expressions-with-arangosearch-functions>Search expressions with ArangoSearch functions <a href=/3.11/index-and-search/arangosearch/#search-expressions-with-arangosearch-functions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Basic operators are not enough for complex query needs. Additional search
functionality is provided via <a href=/3.11/aql/functions/arangosearch/ class=link>ArangoSearch functions</a>
that can be composed with basic operators and other functions to form search
expressions.</p><p>ArangoSearch AQL functions take either an expression or a reference (of an
attribute path or the document emitted by a View) as the first argument.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>BOOST</span><span class=p>(</span><span class=o>&lt;</span><span class=n>expression</span><span class=o>&gt;</span><span class=p>,</span> <span class=err>…</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>STARTS_WITH</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>attribute</span><span class=p>,</span> <span class=err>…</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>TDIDF</span><span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=err>…</span><span class=p>)</span></span></span></code></pre></div><p>If an attribute path expressions is needed, then you have to reference a
document object emitted by a View, e.g. the <code>doc</code> variable of
<code>FOR doc IN viewName</code>, and then specify which attribute you want to test for, as an unquoted string literal. For example, <code>doc.attr</code> or
<code>doc.deeply.nested.attr</code>, but not <code>"doc.attr"</code>. You can also use the
bracket notation <code>doc["attr"]</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>viewName</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>STARTS_WITH</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>deeply</span><span class=p>.</span><span class=n>nested</span><span class=p>[</span><span class=s2>&#34;attr&#34;</span><span class=p>],</span> <span class=s2>&#34;avoca&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>If a reference to the document emitted by the View is required, like for
scoring functions, then you need to pass the raw variable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>viewName</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=o>..</span><span class=p>.</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=o>..</span><span class=p>.</span></span></span></code></pre></div><p>If an expression is expected, it means that search conditions can be expressed in
AQL syntax. They are typically function calls to ArangoSearch filter functions,
possibly nested and/or using logical operators for multiple conditions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>BOOST</span><span class=p>(</span><span class=nf>STARTS_WITH</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;chi&#34;</span><span class=p>),</span> <span class=mf>2.5</span><span class=p>)</span> <span class=kr>OR</span> <span class=nf>STARTS_WITH</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;tom&#34;</span><span class=p>)</span></span></span></code></pre></div><p>You should make sure that search terms can match the indexed values by processing
the search terms with the same Analyzers as the indexed document attributes.
This is especially important for full-text search and any form of normalization,
where there is little chance that an unprocessed search term happens to match
the processed, indexed values.</p><p>If you use <code>arangosearch</code> Views, the default Analyzer that is used for searching
is <code>"identity"</code>. You need to set the Analyzer context in queries against <code>arangosearch</code>
Views to select the Analyzer of the indexed data, as a field can be indexed
by multiple Analyzers, or it uses the <code>identity</code> Analyzer.</p><p>If you use <code>search-alias</code> Views, the Analyzers are inferred from the definitions
of the inverted indexes, and you don&rsquo;t need to and should not set the Analyzer
context with the <code>ANALYZER()</code> function. You should still transform search terms
using the same Analyzer as for the indexed values.</p><p>While some ArangoSearch functions accept an Analyzer argument, it is sometimes
necessary to wrap search (sub-)expressions with an <code>ANALYZER()</code> call to set the
correct Analyzer in the query so that it matches one of the Analyzers with
which the field has been indexed. This only applies to queries against
<code>arangosearch</code> Views.</p><p>It can be easier and cleaner to use <code>ANALYZER()</code> even if you exclusively
use functions that take an Analyzer argument and leave that argument out:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// Analyzer specified in each function call
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;chili pepper&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>OR</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;tomato&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Analyzer specified using ANALYZER()
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>ANALYZER</span><span class=p>(</span><span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;chili pepper&#34;</span><span class=p>)</span> <span class=kr>OR</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=s2>&#34;tomato&#34;</span><span class=p>),</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div><div class="box notices cstyle tip"><div class=box-content-container><div class=box-content><i class="fas fa-check"></i><div class=box-text>The <a href=/3.11/aql/functions/arangosearch/#phrase class=link><code>PHRASE()</code> function</a> applies the
<code>text_en</code> Analyzer to the search terms in both cases. <code>chili pepper</code> gets
tokenized into <code>chili</code> and <code>pepper</code> and these tokens are then searched in this
order. Searching for <code>pepper chili</code> would not match.</div></div></div></div><p>Certain expressions do not require any ArangoSearch functions, such as basic
comparisons. However, the Analyzer used for searching will be <code>"identity"</code>
unless <code>ANALYZER()</code> is used to set a different one.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// The &#34;identity&#34; Analyzer will be used by default
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Same as before but being explicit
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Use the &#34;text_en&#34; Analyzer for searching instead
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>name</span> <span class=o>==</span> <span class=s2>&#34;avocado&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div><h3 id=ranking-results-by-relevance>Ranking results by relevance <a href=/3.11/index-and-search/arangosearch/#ranking-results-by-relevance class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Finding matches is one thing, but especially if there are a lot of results then
the most relevant documents should be listed first. ArangoSearch implements
<a href=/3.11/aql/functions/arangosearch/#scoring-functions class=link>scoring functions</a> that
can be used to rank documents by relevance. The popular ranking schemes
<a href=https://en.wikipedia.org/wiki/Okapi_BM25 target=_blank rel="noopener noreferrer" class=link>Okapi BM25</a>&nbsp;<i class="fas fa-external-link-alt"></i> and
<a href=https://en.wikipedia.org/wiki/Tf%E2%80%93idf target=_blank rel="noopener noreferrer" class=link>TF-IDF</a>&nbsp;<i class="fas fa-external-link-alt"></i> are
available.</p><p>Here is an example that sorts results from high to low BM25 score and also
returns the score:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=s2>&#34;vegetable&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span> <span class=n>name</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=n>type</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span><span class=p>,</span> <span class=n>score</span><span class=o>:</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=p>}</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=s2>&#34;vegetable&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span> <span class=n>name</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=n>type</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span><span class=p>,</span> <span class=n>score</span><span class=o>:</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=p>}</span></span></span></code></pre></div></div></div></div><p>As you can see, the variable emitted by the View in the <code>FOR … IN</code> loop is
passed to the <a href=/3.11/aql/functions/arangosearch/#bm25 class=link><code>BM25()</code> function</a>.</p><table><thead><tr><th style=text-align:left>name</th><th style=text-align:left>type</th><th style=text-align:left>score</th></tr></thead><tbody><tr><td style=text-align:left>tomato</td><td style=text-align:left>[&ldquo;fruit&rdquo;,&ldquo;vegetable&rdquo;]</td><td style=text-align:left>0.43373921513557434</td></tr><tr><td style=text-align:left>carrot</td><td style=text-align:left>vegetable</td><td style=text-align:left>0.38845786452293396</td></tr><tr><td style=text-align:left>chili pepper</td><td style=text-align:left>vegetable</td><td style=text-align:left>0.38845786452293396</td></tr></tbody></table><p>The <a href=/3.11/aql/functions/arangosearch/#tfidf class=link><code>TFIDF()</code> function</a> works the same:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=s2>&#34;vegetable&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>TFIDF</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span> <span class=n>name</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=n>type</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span><span class=p>,</span> <span class=n>score</span><span class=o>:</span> <span class=nf>TFIDF</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=p>}</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=s2>&#34;vegetable&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>TFIDF</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span> <span class=n>name</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span> <span class=n>type</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>type</span><span class=p>,</span> <span class=n>score</span><span class=o>:</span> <span class=nf>TFIDF</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=p>}</span></span></span></code></pre></div></div></div></div><p>It returns different scores:</p><table><thead><tr><th style=text-align:left>name</th><th style=text-align:left>type</th><th style=text-align:left>score</th></tr></thead><tbody><tr><td style=text-align:left>tomato</td><td style=text-align:left>[&ldquo;fruit&rdquo;,&ldquo;vegetable&rdquo;]</td><td style=text-align:left>1.2231435775756836</td></tr><tr><td style=text-align:left>carrot</td><td style=text-align:left>vegetable</td><td style=text-align:left>1.2231435775756836</td></tr><tr><td style=text-align:left>chili pepper</td><td style=text-align:left>vegetable</td><td style=text-align:left>1.2231435775756836</td></tr></tbody></table><p>The scores will change whenever you insert, modify or remove documents, because
the ranking takes factors like how often a term occurs overall and within a
single document into account. For example, if you insert a hundred more fruit
documents (<code>INSERT { type: "fruit" } INTO food</code>) then the TF-IDF score for
vegetables will become 1.4054651260375977.</p><p>You can adjust the ranking in two different ways:</p><ul><li>Boost sub-expressions to favor a condition over another with the
<a href=/3.11/aql/functions/arangosearch/#boost class=link><code>BOOST()</code> function</a></li><li>Calculate a custom score with an expression, optionally taking <code>BM25()</code> and
<code>TFIDF()</code> into account
Have a look at the <a href=/3.11/index-and-search/arangosearch/ranking/ class=link>Ranking Examples</a> for that.</li></ul><h2 id=indexing-complex-json-documents>Indexing complex JSON documents <a href=/3.11/index-and-search/arangosearch/#indexing-complex-json-documents class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=working-with-sub-attributes>Working with sub-attributes <a href=/3.11/index-and-search/arangosearch/#working-with-sub-attributes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>As with regular indexes, there is no limitation to top-level attributes.
Any document attribute at any depth can be indexed. However, with ArangoSearch
it is possible to index all documents attributes or particular attributes
including their sub-attributes without having to modifying the View definition
as new sub-attribute are added. This is possible with <code>arangosearch</code> Views
as well as with inverted indexes if you use them through <code>search-alias</code> Views.</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><p>You need to create an inverted index and enable the <strong>Include All Fields</strong>
feature to index all document attributes, then add the index to a
<code>search-alias</code> View. No matter what attributes you add to your documents,
they will automatically get indexed.</p><p>You can also add <strong>Fields</strong>, click their underlined names, and enable
<strong>Include All Fields</strong> for specific attributes and their sub-attributes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;fields&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=s2>&#34;value&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;includeAllFields&#34;</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>...</span></span></span></code></pre></div><p>This will index the attribute <code>value</code> and its sub-attributes. Consider the
following example document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;nested&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;deep&#34;</span><span class=p>:</span> <span class=s2>&#34;apple pie&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The View will automatically index <code>apple pie</code>, and it can then be queried
like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=o>==</span> <span class=s2>&#34;apple pie&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><p>We already used the <strong>Include All Fields</strong> feature to index all document
attributes above when we modified the View definition to this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;links&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;food&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;includeAllFields&#34;</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>No matter what attributes you add to your documents, they will automatically
get indexed. To do this for certain attribute paths only, you can enable
the <strong>Include All Fields</strong> options for specific attributes only, and include a
list of Analyzers to process the values with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;links&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;food&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;fields&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;includeAllFields&#34;</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;analyzers&#34;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;identity&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This will index the attribute <code>value</code> and its sub-attributes. Consider the
following example document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;nested&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;deep&#34;</span><span class=p>:</span> <span class=s2>&#34;apple pie&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The View will automatically index <code>apple pie</code>, processed with the <code>identity</code> and
<code>text_en</code> Analyzers, and it can then be queried like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=o>==</span> <span class=s2>&#34;apple pie&#34;</span><span class=p>,</span> <span class=s2>&#34;identity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>food_view</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=kr>IN</span> <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;pie&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>),</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div></div></div></div><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text>Using <code>includeAllFields</code> for a lot of attributes in combination with complex
Analyzers may significantly slow down the indexing process.</div></div></div></div><h3 id=indexing-and-querying-arrays>Indexing and querying arrays <a href=/3.11/index-and-search/arangosearch/#indexing-and-querying-arrays class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>With <code>arangosearch</code> Views, the elements of arrays are indexed individually by
default, as if the source attribute had each element as value at the same time
(like a <em>disjunctive superposition</em> of their values). This is controlled by the
View setting <a href=/3.11/index-and-search/arangosearch/arangosearch-views-reference/#link-properties class=link><code>trackListPositions</code></a>
that defaults to <code>false</code>.</p><p>With <code>search-alias</code> Views, you can get the same behavior by enabling the
<code>searchField</code> option globally or for specific fields in their inverted indexes,
or you can explicitly expand certain array attributes by appending <code>[*]</code> to the
field name.</p><p>Consider the following document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;nested&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;deep&#34;</span><span class=p>:</span> <span class=p>[</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>A View that is configured to index the field <code>value</code> including sub-fields
will index the individual numbers under the path <code>value.nested.deep</code>, which
you can query for like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>viewName</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=o>==</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>This is different to <code>FILTER</code> operations, where you would use an
<a href=/3.11/aql/operators/#array-comparison-operators class=link>array comparison operator</a>
to find an element in the array:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>collection</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=kr>ANY</span> <span class=o>==</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>You can set <code>trackListPositions</code> to <code>true</code> if you want to query for a value
at a specific array index (requires <code>searchField</code> to be <code>true</code> for
<code>search-alias</code> Views):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span></span></span></code></pre></div><p>With <code>trackListPositions</code> enabled there will be <strong>no match</strong> for the document
anymore if the specification of an array index is left out in the expression:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kp>SEARCH</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>nested</span><span class=p>.</span><span class=n>deep</span> <span class=o>==</span> <span class=mi>2</span></span></span></code></pre></div><p>Conversely, there will be no match if an array index is specified but
<code>trackListPositions</code> is disabled.</p><p>String tokens are also indexed individually, but only some Analyzer types
return multiple tokens.
If the Analyzer does, then comparison tests are done per token/word.
For example, given the field <code>text</code> is analyzed with <code>"text_en"</code> and contains
the string <code>"a quick brown fox jumps over the lazy dog"</code>, the following
expression will be true:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;fox&#39;</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;fox&#39;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div></div></div></div><p>Note that the <code>"text_en"</code> Analyzer stems the words, so this is also true:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div></div></div></div><p>So a comparison will actually test if a word is contained in the text. With
<code>trackListPositions: false</code>, this means for arrays if the word is contained in
any element of the array. For example, given:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=p>[</span> <span class=s2>&#34;a quick&#34;</span><span class=p>,</span> <span class=s2>&#34;brown fox&#34;</span><span class=p>,</span> <span class=s2>&#34;jumps over the&#34;</span><span class=p>,</span> <span class=s2>&#34;lazy dog&#34;</span> <span class=p>]</span> <span class=p>}</span>
</span></span></code></pre></div><p>… the following will be true:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>text</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div></div></div></div><p>With <code>trackListPositions: true</code> you would need to specify the index of the
array element <code>"jumps over the"</code> to be true:</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>doc</span><span class=p>.</span><span class=n>text</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>ANALYZER</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>text</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;jump&#39;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span></span></span></code></pre></div></div></div></div><p>Arrays of strings are handled similarly. Each array element is treated like a
token (or possibly multiple tokens if a tokenizing Analyzer is used and
therefore applied to each element).</p><h2 id=dealing-with-eventual-consistency>Dealing with eventual consistency <a href=/3.11/index-and-search/arangosearch/#dealing-with-eventual-consistency class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Regular indexes are immediately consistent. If you have a collection with a
<code>persistent</code> index on an attribute <code>text</code> and update the value of the attribute
for instance, then this modification is reflected in the index immediately.
View indexes (and inverted indexes) on the other hand are eventual
consistent. Document changes are not reflected instantly, but only near-realtime.
This mainly has performance reasons.</p><p>If you run a search query shortly after a CRUD operation, then the results may
be slightly stale, e.g. not include a newly inserted document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`INSERT { text: &#34;cheese cake&#34; } INTO collection`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN viewName SEARCH doc.text == &#34;cheese cake&#34; RETURN doc`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// May not find the new document
</span></span></span></code></pre></div><p>Re-running the search query a bit later will include the new document, however.</p><p>There is an internal option to wait for the View to update and thus include
changes just made to documents:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`INSERT { text: &#34;pop tart&#34; } INTO collection`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=sb>`FOR doc IN viewName SEARCH doc.text == &#34;pop tart&#34; OPTIONS { waitForSync: true } RETURN doc`</span><span class=p>);</span></span></span></code></pre></div><p>This is not necessary if you use a single server deployment and populate a
collection with documents before creating a View.</p><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><code>SEARCH … OPTIONS { waitForSync: true }</code> is intended to be used in unit tests
to block search queries until the View caught up with the underlying
collections. It is designed to make this use case easier. It should not be used
for other purposes and especially not in production, as it can stall queries.</div></div></div></div><div class="box notices cstyle danger"><div class=box-content-container><div class=box-content><i class="fa fa-times-circle"></i><div class=box-text>Do not use<code>SEARCH … OPTIONS { waitForSync: true }</code> in transactions. View index
changes cannot be rolled back if transactions get aborted. It will lead to
permanent inconsistencies between the linked collections and the View.</div></div></div></div><h2 id=how-to-go-from-here>How to go from here <a href=/3.11/index-and-search/arangosearch/#how-to-go-from-here class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To learn more, check out the different search examples:</p><ul><li><a href=/3.11/index-and-search/arangosearch/exact-value-matching/ class=link><strong>Exact value matching</strong></a>:
Search for values as stored in documents (full strings, numbers, booleans).</li><li><a href=/3.11/index-and-search/arangosearch/range-queries/ class=link><strong>Range queries</strong></a>:
Match values that are above, below or between a minimum and a maximum value.
This is primarily for numeric values.</li><li><a href=/3.11/index-and-search/arangosearch/prefix-matching/ class=link><strong>Prefix matching</strong></a>:
Search for strings that start with certain strings. A common use case for
this is to implement auto-complete kind of functionality.</li><li><a href=/3.11/index-and-search/arangosearch/case-sensitivity-and-diacritics/ class=link><strong>Case-sensitivity and diacritics</strong></a>:
Strings can be normalized so that it does not matter whether characters are
upper or lower case, and character accents can be ignored for a better search
experience. This can be combined with other types of search.</li><li><a href=/3.11/index-and-search/arangosearch/wildcard-search/ class=link><strong>Wildcard search</strong></a>:
Search for partial matches in strings (ends with, contains and more).</li><li><a href=/3.11/index-and-search/arangosearch/full-text-token-search/ class=link><strong>Full-text token search</strong></a>:
Full-text can be tokenized into words that can then be searched individually,
regardless of their original order, also in combination with prefix
search. Array values are also indexed as separate tokens.</li><li><a href=/3.11/index-and-search/arangosearch/phrase-and-proximity-search/ class=link><strong>Phrase and proximity search</strong></a>:
Search tokenized full-text with the tokens in a certain order, such as
partial or full sentences, optionally with wildcard tokens for a proximity
search.</li><li><a href=/3.11/index-and-search/arangosearch/faceted-search/ class=link><strong>Faceted search</strong></a>:
Combine aggregation with search queries to retrieve how often values occur
overall.</li><li><a href=/3.11/index-and-search/arangosearch/fuzzy-search/ class=link><strong>Fuzzy search</strong></a>:
Match strings even if they are not exactly the same as the search terms.
By allowing some fuzziness you can compensate for typos and match similar
tokens that could be relevant too.</li><li><a href=/3.11/index-and-search/arangosearch/geospatial-search/ class=link><strong>Geospatial search</strong></a>:
You can use ArangoSearch for geographic search queries to find nearby
locations, places within a certain area and more. It can be combined with
other types of search queries unlike with the regular geo index.</li><li><a href=/3.11/index-and-search/arangosearch/search-highlighting/ class=link><strong>Search highlighting</strong></a>:
Retrieve the positions of matches within strings, to highlight what was found
in search results (Enterprise Edition only).</li><li><a href=/3.11/index-and-search/arangosearch/nested-search/ class=link><strong>Nested search</strong></a>:
Match arrays of objects with all the conditions met by a single sub-object,
and define for how many of the elements this must be true (Enterprise Edition only).</li></ul><p>For relevance and performance tuning, as well as the reference documentation, see:</p><ul><li><a href=/3.11/index-and-search/arangosearch/ranking/ class=link><strong>Ranking</strong></a>:
Sort search results by relevance, fine-tune the importance of certain search
conditions, and calculate a custom relevance score.</li><li><a href=/3.11/index-and-search/arangosearch/performance/ class=link><strong>Performance</strong></a>:
Give the View index a primary sort order to benefit common search queries
that you will run and store often used attributes directly in the View index
for fast access.</li><li><strong>Views Reference</strong>
You can find all View properties and options that are available for the
respective type in the <a href=/3.11/index-and-search/arangosearch/arangosearch-views-reference/ class=link><code>arangosearch</code> Views Reference</a>
and <a href=/3.11/index-and-search/arangosearch/search-alias-views-reference/ class=link><code>search-alias</code> Views Reference</a>
documentation.</li></ul><p>If you are interested in more technical details, have a look at:</p><ul><li><a href="https://www.arangodb.com/learn/search/tutorial/#:~:text=Ranking%20in%20ArangoSearch" target=_blank rel="noopener noreferrer" class=link><strong>ArangoSearch Tutorial</strong></a>&nbsp;<i class="fas fa-external-link-alt"></i>:
The tutorial includes sections about the View concept, Analysis, and the
ranking model.</li><li><a href=https://www.arangodb.com/2018/04/arangosearch-architecture-overview/ target=_blank rel="noopener noreferrer" class=link><strong>ArangoSearch architecture overview</strong></a>&nbsp;<i class="fas fa-external-link-alt"></i>:
A description of ArangoSearch&rsquo;s design, its inverted index and some
implementation details.</li><li>The <a href=https://github.com/iresearch-toolkit/iresearch target=_blank rel="noopener noreferrer" class=link><strong>IResearch library</strong></a>&nbsp;<i class="fas fa-external-link-alt"></i>
that provides the searching and ranking capabilities.</li></ul><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.11/index-and-search/indexing/><i class="fas fa-chevron-left fa-fw"></i><p>Indexing</p></a></span><span class=next><a class="nav nav-next link" href=/3.11/index-and-search/arangosearch/example-datasets/><p>Example Datasets</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.11/index-and-search/arangosearch/_index.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#example-use-cases>Example Use Cases</a></div><div class=level-2><a href=#getting-started-with-arangosearch>Getting Started with ArangoSearch</a></div><div class=level-3><a href=#create-your-first-arangosearch-view>Create your first <code>arangosearch</code> View</a></div><div class=level-3><a href=#create-your-first-search-alias-view>Create your first <code>search-alias</code> View</a></div><div class=level-3><a href=#understanding-the-analyzer-context>Understanding the Analyzer context</a></div><div class=level-3><a href=#basic-search-expressions>Basic search expressions</a></div><div class=level-3><a href=#searching-for-tokens-from-full-text>Searching for tokens from full-text</a></div><div class=level-3><a href=#search-expressions-with-arangosearch-functions>Search expressions with ArangoSearch functions</a></div><div class=level-3><a href=#ranking-results-by-relevance>Ranking results by relevance</a></div><div class=level-2><a href=#indexing-complex-json-documents>Indexing complex JSON documents</a></div><div class=level-3><a href=#working-with-sub-attributes>Working with sub-attributes</a></div><div class=level-3><a href=#indexing-and-querying-arrays>Indexing and querying arrays</a></div><div class=level-2><a href=#dealing-with-eventual-consistency>Dealing with eventual consistency</a></div><div class=level-2><a href=#how-to-go-from-here>How to go from here</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>