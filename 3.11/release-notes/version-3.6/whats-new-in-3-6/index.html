<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743775370></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Multiple performance improvements to AQL queries, dynamic search expressions, a new cluster deployment mode"><meta property="og:url" content="http://localhost/3.11/release-notes/version-3.6/whats-new-in-3-6/"><meta property="og:title" content="Features and Improvements in ArangoDB 3.6"><meta property="og:type" content="website"><meta property="og:description" content="Multiple performance improvements to AQL queries, dynamic search expressions, a new cluster deployment mode"><meta name=docsearch:version content="3.11"><title>Features and Improvements in ArangoDB 3.6 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743775370 defer></script>
<script src=/js/featherlight.min.js?1743775370 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743775370 defer></script>
<script src=/js/theme.js?1743775370 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.11"><a itemprop=item class=link href=/3.11/><span itemprop=name class=breadcrumb-entry>3.11.13</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Release Notes"><a itemprop=item class=link href=/3.11/release-notes/><span itemprop=name class=breadcrumb-entry>Release Notes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Version 3.6"><a itemprop=item class=link href=/3.11/release-notes/version-3.6/><span itemprop=name class=breadcrumb-entry>Version 3.6</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="What&rsquo;s New in 3.6"><a itemprop=item class=link href=/3.11/release-notes/version-3.6/whats-new-in-3-6/><span itemprop=name class=breadcrumb-entry>What&rsquo;s New in 3.6</span></a></li></ol></nav><article class=default><hgroup><h1>Features and Improvements in ArangoDB 3.6</h1><p class=lead>Multiple performance improvements to AQL queries, dynamic search expressions, a new cluster deployment mode</p></hgroup><p>The following list shows in detail which features have been added or improved in
ArangoDB 3.6. ArangoDB 3.6 also contains several bug fixes that are not listed
here.</p><h2 id=aql>AQL <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#aql class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=early-pruning-of-non-matching-documents>Early pruning of non-matching documents <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#early-pruning-of-non-matching-documents class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Previously, AQL queries with filter conditions that could not be satisfied by
any index required all documents to be copied from the storage engine into the
AQL scope in order to be fed into the filter.</p><p>An example query execution plan for such query from ArangoDB 3.5 looks like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>75</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>true</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&gt;</span> <span class=mi>9</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value2</span> <span class=o>==</span> <span class=s1>&#39;test854&#39;</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                    <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>                  <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>   <span class=mi>100000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* full collection scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>           <span class=mi>100000</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#1</span> <span class=o>=</span> <span class=p>((</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&gt;</span> <span class=mi>9</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value2`</span> <span class=o>==</span> <span class=s2>&#34;test854&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>FilterNode</span>                <span class=mi>100000</span>       <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#1</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>                <span class=mi>100000</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>ArangoDB 3.6 adds an optimizer rule <code>move-filters-into-enumerate</code> which allows
applying the filter condition directly while scanning the documents, so copying
of any documents that don&rsquo;t match the filter condition can be avoided.</p><p>The query execution plan for the above query from 3.6 with that optimizer rule
applied looks as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>75</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>true</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&gt;</span> <span class=mi>9</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value2</span> <span class=o>==</span> <span class=s1>&#39;test854&#39;</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                    <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>                  <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>   <span class=mi>100000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* full collection scan */</span>   <span class=kr>FILTER</span> <span class=p>((</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&gt;</span> <span class=mi>9</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value2`</span> <span class=o>==</span> <span class=s2>&#34;test854&#34;</span><span class=p>))</span>   <span class=cm>/* early pruning */</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>                <span class=mi>100000</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>Note that in this execution plan the scanning and filtering are combined in one
node, so the copying of all non-matching documents from the storage engine into
the AQL scope is completely avoided.</p><p>This optimization will be beneficial if the filter condition is very selective
and will filter out many documents, and if documents are large. In this case a
lot of copying will be avoided.</p><p>The optimizer rule also works if an index is used, but there are also filter
conditions that cannot be satisfied by the index alone. Here is a 3.5 query
execution plan for a query using a filter on an indexed value plus a filter on
a non-indexed value:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>101</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>true</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&gt;</span> <span class=mi>10000</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&lt;</span> <span class=mi>30000</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value2</span> <span class=o>==</span> <span class=s1>&#39;test854&#39;</span> <span class=kr>RETURN</span>
</span></span><span class=line><span class=cl> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>           <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>         <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>IndexNode</span>         <span class=mi>26666</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* hash index scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>CalculationNode</span>   <span class=mi>26666</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#1</span> <span class=o>=</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value2`</span> <span class=o>==</span> <span class=s2>&#34;test854&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>FilterNode</span>        <span class=mi>26666</span>       <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#1</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>        <span class=mi>26666</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Indexes</span> <span class=n>used</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>By</span>   <span class=n>Name</span>                      <span class=n>Type</span>   <span class=n>Collection</span>   <span class=n>Unique</span>   <span class=n>Sparse</span>   <span class=n>Selectivity</span>   <span class=n>Fields</span>         <span class=n>Ranges</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>idx_1649353982658740224</span>   <span class=n>hash</span>   <span class=n>test</span>         <span class=kc>false</span>    <span class=kc>false</span>       <span class=mi>10</span><span class=mf>0.00</span> <span class=o>%</span>   <span class=p>[</span> <span class=n>`value1`</span> <span class=p>]</span>   <span class=p>((</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&gt;</span> <span class=mi>10000</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&lt;</span> <span class=mi>30000</span><span class=p>))</span></span></span></code></pre></div><p>In 3.6, the same query will be executed using a combined index scan & filtering
approach, again avoiding any copies of non-matching documents:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>101</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>true</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&gt;</span> <span class=mi>10000</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value1</span> <span class=o>&lt;</span> <span class=mi>30000</span> <span class=o>&amp;&amp;</span> <span class=n>doc</span><span class=p>.</span><span class=n>value2</span> <span class=o>==</span> <span class=s1>&#39;test854&#39;</span> <span class=kr>RETURN</span>
</span></span><span class=line><span class=cl> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>         <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>       <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>IndexNode</span>       <span class=mi>26666</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* hash index scan */</span>   <span class=kr>FILTER</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value2`</span> <span class=o>==</span> <span class=s2>&#34;test854&#34;</span><span class=p>)</span>   <span class=cm>/* early pruning */</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>      <span class=mi>26666</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Indexes</span> <span class=n>used</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>By</span>   <span class=n>Name</span>                      <span class=n>Type</span>   <span class=n>Collection</span>   <span class=n>Unique</span>   <span class=n>Sparse</span>   <span class=n>Selectivity</span>   <span class=n>Fields</span>         <span class=n>Ranges</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>idx_1649353982658740224</span>   <span class=n>hash</span>   <span class=n>test</span>         <span class=kc>false</span>    <span class=kc>false</span>       <span class=mi>10</span><span class=mf>0.00</span> <span class=o>%</span>   <span class=p>[</span> <span class=n>`value1`</span> <span class=p>]</span>   <span class=p>((</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&gt;</span> <span class=mi>10000</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value1`</span> <span class=o>&lt;</span> <span class=mi>30000</span><span class=p>))</span></span></span></code></pre></div><h3 id=subquery-splicing-optimization>Subquery Splicing Optimization <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#subquery-splicing-optimization class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>In earlier versions of ArangoDB, on every execution of a subquery the following
happened for each input row:</p><ul><li>The subquery tree issues one initializeCursor cascade through all nodes</li><li>The subquery node pulls rows until the subquery node is empty for this input</li></ul><p>On subqueries with many results per input row (10000 or more) the above steps
did not contribute significantly to query execution time. On subqueries with
few results per input, there was a serious performance impact.</p><p>Subquery splicing inlines the execution of subqueries using an optimizer rule
called <code>splice-subqueries</code>. Only suitable queries can be spliced.
A subquery becomes unsuitable if it contains a <code>LIMIT</code> node or a
<code>COLLECT WITH COUNT INTO …</code> construct (but not due to a
<code>COLLECT var = &lt;expr> WITH COUNT INTO …</code>). A subquery <em>also</em> becomes
unsuitable if it is contained in a (sub)query containing unsuitable parts
<em>after</em> the subquery.</p><p>Consider the following query to illustrate the difference.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>x</span> <span class=kr>IN</span> <span class=n>c1</span>
</span></span><span class=line><span class=cl>  <span class=kd>LET</span> <span class=n>firstJoin</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kr>FOR</span> <span class=n>y</span> <span class=kr>IN</span> <span class=n>c2</span>
</span></span><span class=line><span class=cl>      <span class=kr>FILTER</span> <span class=n>y</span><span class=p>.</span><span class=n>_id</span> <span class=o>==</span> <span class=n>x</span><span class=p>.</span><span class=n>c2_id</span>
</span></span><span class=line><span class=cl>      <span class=kr>LIMIT</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=kr>RETURN</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>LET</span> <span class=n>secondJoin</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kr>FOR</span> <span class=n>z</span> <span class=kr>IN</span> <span class=n>c3</span>
</span></span><span class=line><span class=cl>      <span class=kr>FILTER</span> <span class=n>z</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=n>x</span><span class=p>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>      <span class=kr>RETURN</span> <span class=n>z</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span> <span class=n>x</span><span class=p>,</span> <span class=n>firstJoin</span><span class=p>,</span> <span class=n>secondJoin</span> <span class=p>}</span></span></span></code></pre></div><p>The execution plan <strong>without</strong> subquery splicing:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                  <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>                <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>      <span class=mi>0</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>x</span> <span class=kr>IN</span> <span class=n>c1</span>   <span class=cm>/* full collection scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>   <span class=n>SubqueryNode</span>                 <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=n>firstJoin</span> <span class=o>=</span> <span class=o>..</span><span class=p>.</span>   <span class=cm>/* subquery */</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>SingletonNode</span>                <span class=mi>1</span>         <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl> <span class=mi>18</span>   <span class=n>IndexNode</span>                    <span class=mi>0</span>           <span class=o>-</span> <span class=kr>FOR</span> <span class=n>y</span> <span class=kr>IN</span> <span class=n>c2</span>   <span class=cm>/* primary index scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>LimitNode</span>                    <span class=mi>0</span>             <span class=o>-</span> <span class=kr>LIMIT</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>   <span class=n>ReturnNode</span>                   <span class=mi>0</span>             <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>y</span>
</span></span><span class=line><span class=cl> <span class=mi>15</span>   <span class=n>SubqueryNode</span>                 <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=n>secondJoin</span> <span class=o>=</span> <span class=o>..</span><span class=p>.</span>   <span class=cm>/* subquery */</span>
</span></span><span class=line><span class=cl> <span class=mi>10</span>   <span class=n>SingletonNode</span>                <span class=mi>1</span>         <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl> <span class=mi>11</span>   <span class=n>EnumerateCollectionNode</span>      <span class=mi>0</span>           <span class=o>-</span> <span class=kr>FOR</span> <span class=n>z</span> <span class=kr>IN</span> <span class=n>c3</span>   <span class=cm>/* full collection scan */</span>
</span></span><span class=line><span class=cl> <span class=mi>12</span>   <span class=n>CalculationNode</span>              <span class=mi>0</span>             <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#11</span> <span class=o>=</span> <span class=p>(</span><span class=n>z</span><span class=p>.</span><span class=n>`value`</span> <span class=o>==</span> <span class=n>x</span><span class=p>.</span><span class=n>`value`</span><span class=p>)</span>   <span class=cm>/* simple expression */</span>   <span class=cm>/* collections used: z : c3, x : c1 */</span>
</span></span><span class=line><span class=cl> <span class=mi>13</span>   <span class=n>FilterNode</span>                   <span class=mi>0</span>             <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#11</span>
</span></span><span class=line><span class=cl> <span class=mi>14</span>   <span class=n>ReturnNode</span>                   <span class=mi>0</span>             <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>z</span>
</span></span><span class=line><span class=cl> <span class=mi>16</span>   <span class=n>CalculationNode</span>              <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#13</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;x&#34;</span> <span class=o>:</span> <span class=n>x</span><span class=p>,</span> <span class=s2>&#34;firstJoin&#34;</span> <span class=o>:</span> <span class=n>firstJoin</span><span class=p>,</span> <span class=s2>&#34;secondJoin&#34;</span> <span class=o>:</span> <span class=n>secondJoin</span> <span class=p>}</span>   <span class=cm>/* simple expression */</span>   <span class=cm>/* collections used: x : c1 */</span>
</span></span><span class=line><span class=cl> <span class=mi>17</span>   <span class=n>ReturnNode</span>                   <span class=mi>0</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=nl>#13</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Optimization</span> <span class=n>rules</span> <span class=n>applied</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>RuleName</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>use</span><span class=o>-</span><span class=n>indexes</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=kr>remove</span><span class=o>-</span><span class=kr>filter</span><span class=o>-</span><span class=n>covered</span><span class=o>-</span><span class=n>by</span><span class=o>-</span><span class=n>index</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=kr>remove</span><span class=o>-</span><span class=n>unnecessary</span><span class=o>-</span><span class=n>calculations</span><span class=o>-</span><span class=mi>2</span></span></span></code></pre></div><p>Note in particular the <code>SubqueryNode</code>s, followed by a <code>SingletonNode</code> in
both cases.</p><p>When using the optimizer rule <code>splice-subqueries</code> the plan is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                  <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>                <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>      <span class=mi>0</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>x</span> <span class=kr>IN</span> <span class=n>c1</span>   <span class=cm>/* full collection scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>   <span class=n>SubqueryNode</span>                 <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=n>firstJoin</span> <span class=o>=</span> <span class=o>..</span><span class=p>.</span>   <span class=cm>/* subquery */</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>SingletonNode</span>                <span class=mi>1</span>         <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl> <span class=mi>18</span>   <span class=n>IndexNode</span>                    <span class=mi>0</span>           <span class=o>-</span> <span class=kr>FOR</span> <span class=n>y</span> <span class=kr>IN</span> <span class=n>c2</span>   <span class=cm>/* primary index scan */</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>LimitNode</span>                    <span class=mi>0</span>             <span class=o>-</span> <span class=kr>LIMIT</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>   <span class=n>ReturnNode</span>                   <span class=mi>0</span>             <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>y</span>
</span></span><span class=line><span class=cl> <span class=mi>19</span>   <span class=n>SubqueryStartNode</span>            <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=n>secondJoin</span> <span class=o>=</span> <span class=p>(</span> <span class=cm>/* subquery begin */</span>
</span></span><span class=line><span class=cl> <span class=mi>11</span>   <span class=n>EnumerateCollectionNode</span>      <span class=mi>0</span>         <span class=o>-</span> <span class=kr>FOR</span> <span class=n>z</span> <span class=kr>IN</span> <span class=n>c3</span>   <span class=cm>/* full collection scan */</span>
</span></span><span class=line><span class=cl> <span class=mi>12</span>   <span class=n>CalculationNode</span>              <span class=mi>0</span>           <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#11</span> <span class=o>=</span> <span class=p>(</span><span class=n>z</span><span class=p>.</span><span class=n>`value`</span> <span class=o>==</span> <span class=n>x</span><span class=p>.</span><span class=n>`value`</span><span class=p>)</span>   <span class=cm>/* simple expression */</span>   <span class=cm>/* collections used: z : c3, x : c1 */</span>
</span></span><span class=line><span class=cl> <span class=mi>13</span>   <span class=n>FilterNode</span>                   <span class=mi>0</span>           <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#11</span>
</span></span><span class=line><span class=cl> <span class=mi>20</span>   <span class=n>SubqueryEndNode</span>              <span class=mi>0</span>       <span class=o>-</span> <span class=p>)</span> <span class=cm>/* subquery end */</span>
</span></span><span class=line><span class=cl> <span class=mi>16</span>   <span class=n>CalculationNode</span>              <span class=mi>0</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#13</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;x&#34;</span> <span class=o>:</span> <span class=n>x</span><span class=p>,</span> <span class=s2>&#34;firstJoin&#34;</span> <span class=o>:</span> <span class=n>firstJoin</span><span class=p>,</span> <span class=s2>&#34;secondJoin&#34;</span> <span class=o>:</span> <span class=n>secondJoin</span> <span class=p>}</span>   <span class=cm>/* simple expression */</span>   <span class=cm>/* collections used: x : c1 */</span>
</span></span><span class=line><span class=cl> <span class=mi>17</span>   <span class=n>ReturnNode</span>                   <span class=mi>0</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=nl>#13</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Optimization</span> <span class=n>rules</span> <span class=n>applied</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>RuleName</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>use</span><span class=o>-</span><span class=n>indexes</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=kr>remove</span><span class=o>-</span><span class=kr>filter</span><span class=o>-</span><span class=n>covered</span><span class=o>-</span><span class=n>by</span><span class=o>-</span><span class=n>index</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=kr>remove</span><span class=o>-</span><span class=n>unnecessary</span><span class=o>-</span><span class=n>calculations</span><span class=o>-</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>splice</span><span class=o>-</span><span class=n>subqueries</span></span></span></code></pre></div><p>The first subquery is unsuitable for the optimization because it contains
a <code>LIMIT</code> statement and is therefore not spliced. The second subquery is
suitable and hence is spliced – which one can tell from the different node
type <code>SubqueryStartNode</code> (beginning of spliced subquery). Note how it is
not followed by a <code>SingletonNode</code>. The end of the spliced subquery is
marked by a <code>SubqueryEndNode</code>.</p><h3 id=late-document-materialization-rocksdb>Late document materialization (RocksDB) <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#late-document-materialization-rocksdb class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>With the <em>late document materialization</em> optimization ArangoDB tries to
read only documents that are absolutely necessary to compute the query result,
reducing load to the storage engine. This is only supported for the RocksDB
storage engine.</p><p>In 3.6 the optimization can only be applied to queries retrieving data from a
collection or an ArangoSearch View and that contain a <code>SORT</code>+<code>LIMIT</code>
combination.</p><p>For the collection case the optimization is possible if and only if:</p><ul><li>there is an index of type <code>primary</code>, <code>hash</code>, <code>skiplist</code>, <code>persistent</code>
or <code>edge</code> picked by the optimizer</li><li>all attribute accesses can be covered by indexed attributes</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// Given we have a persistent index on attributes [ &#34;foo&#34;, &#34;bar&#34;, &#34;baz&#34; ]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>d</span> <span class=kr>IN</span> <span class=n>myCollection</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>d</span><span class=p>.</span><span class=n>foo</span> <span class=o>==</span> <span class=s2>&#34;someValue&#34;</span> <span class=c1>// hash index will be picked to optimize filtering
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>SORT</span> <span class=n>d</span><span class=p>.</span><span class=n>baz</span> <span class=kr>DESC</span>             <span class=c1>// field &#34;baz&#34; will be read from index
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>LIMIT</span> <span class=mi>100</span>                   <span class=c1>// only 100 documents will be materialized
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>RETURN</span> <span class=n>d</span></span></span></code></pre></div><p>For the ArangoSearch View case the optimization is possible if and only if:</p><ul><li>all attribute accesses can be covered by attributes stored in the View index
(e.g. using <code>primarySort</code>)</li><li>the primary sort order optimization is not applied, because it voids the need
for late document materialization</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// Given primarySort is {&#34;field&#34;: &#34;foo&#34;, &#34;asc&#34;: false}, i.e.
</span></span></span><span class=line><span class=cl><span class=c1>// field &#34;foo&#34; covered by index but sort optimization not applied
</span></span></span><span class=line><span class=cl><span class=c1>// (sort order of primarySort and SORT operation mismatch)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>d</span> <span class=kr>IN</span> <span class=n>myView</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=n>d</span><span class=p>.</span><span class=n>foo</span>
</span></span><span class=line><span class=cl>  <span class=kr>LIMIT</span> <span class=mi>100</span>  <span class=c1>// only 100 documents will be materialized
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>RETURN</span> <span class=n>d</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// Given primarySort contains field &#34;foo&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>d</span> <span class=kr>IN</span> <span class=n>myView</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>d</span><span class=p>.</span><span class=n>foo</span> <span class=o>==</span> <span class=s2>&#34;someValue&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>d</span><span class=p>)</span> <span class=kr>DESC</span>  <span class=c1>// BM25(d) will be evaluated by the View node above
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>LIMIT</span> <span class=mi>100</span>          <span class=c1>// only 100 documents will be materialized
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>RETURN</span> <span class=n>d</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=c1>// Given primarySort contains fields &#34;foo&#34; and &#34;bar&#34;, and &#34;bar&#34; is not the
</span></span></span><span class=line><span class=cl><span class=c1>// first field or at least not sorted by in descending order, i.e. the sort
</span></span></span><span class=line><span class=cl><span class=c1>// optimization cannot be applied but the late document materialization instead
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>d</span> <span class=kr>IN</span> <span class=n>myView</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=n>d</span><span class=p>.</span><span class=n>foo</span> <span class=o>==</span> <span class=s2>&#34;someValue&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=n>d</span><span class=p>.</span><span class=n>bar</span> <span class=kr>DESC</span>    <span class=c1>// field &#34;bar&#34; will be read from the View
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>LIMIT</span> <span class=mi>100</span>          <span class=c1>// only 100 documents will be materialized
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>RETURN</span> <span class=n>d</span></span></span></code></pre></div><p>The respective optimizer rules are called <code>late-document-materialization</code>
(collection source) and <code>late-document-materialization-arangosearch</code>
(ArangoSearch View source). If applied, you will find <code>MaterializeNode</code>s
in <a href=/3.11/aql/execution-and-performance/query-optimization/#execution-nodes class=link>execution plans</a>.</p><h3 id=parallelization-of-cluster-aql-queries>Parallelization of cluster AQL queries <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#parallelization-of-cluster-aql-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoDB 3.6 can parallelize work in many cluster AQL queries when there are
multiple DB-Servers involved. The parallelization is done in the
<em>GatherNode</em>, which then can send parallel cluster-internal requests to the
DB-Servers attached. The DB-Servers can then work fully parallel
for the different shards involved.</p><p>When parallelization is used, one or multiple <em>GatherNode</em>s in a query&rsquo;s
execution plan will be tagged with <code>parallel</code> as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                  <span class=n>Site</span>     <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>             <span class=n>DBS</span>         <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>   <span class=n>DBS</span>   <span class=mi>1000000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* full collection scan, 5 shard(s) */</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>RemoteNode</span>                <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>GatherNode</span>                <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>GATHER</span>   <span class=cm>/* parallel */</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>ReturnNode</span>                <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>Parallelization is currently restricted to certain types and parts of queries.
<em>GatherNode</em>s will go into parallel mode only if the DB-Server query part
above it (in terms of query execution plan layout) is a terminal part of the
query. To trigger the optimization, there must not be other nodes of type
<em>ScatterNode</em>, <em>GatherNode</em> or <em>DistributeNode</em> present in the query.</p><p>Please note that the parallelization of AQL execution may lead to a different
resource usage pattern for eligible AQL queries in the cluster. In isolation,
queries are expected to complete faster with parallelization than when executing
their work serially on all involved DB-Servers. However, working on
multiple DB-Servers in parallel may also mean that more work than before
is happening at the very same time. If this is not desired because of resource
scarcity, there are options to control the parallelization:</p><p>The startup option <code>--query.parallelize-gather-writes</code> can be used to control
whether eligible write operation parts will be parallelized. This option
defaults to <code>true</code>, meaning that eligible write operations are also parallelized
by default. This can be turned off so that potential I/O overuse can be avoided
for write operations when used together with a high replication factor.</p><p>Additionally, the startup option <code>--query.optimizer-rules</code> can be used to
globally toggle the usage of certain optimizer rules for all queries.
By default, all optimizations are turned on. However, specific optimizations
can be turned off using the option.</p><p>For example, to turn off the parallelization entirely (including parallel
gather writes), one can use the following configuration:</p><pre tabindex=0><code>--query.optimizer-rules &#34;-parallelize-gather&#34;
</code></pre><p>This toggle works for any other non-mandatory optimizer rules as well.
To specify multiple optimizer rules, the option can be used multiple times, e.g.</p><pre tabindex=0><code>--query.optimizer-rules &#34;-parallelize-gather&#34; --query.optimizer-rules &#34;-splice-subqueries&#34;
</code></pre><p>You can overrule which optimizer rules to use or not use on a per-query basis
still. <code>--query.optimizer-rules</code> merely defines a default. However,
<code>--query.parallelize-gather-writes false</code> turns off parallel gather writes
completely and it cannot be re-enabled for individual queries.</p><h3 id=optimizations-for-simple-update-and-replace-queries>Optimizations for simple UPDATE and REPLACE queries <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#optimizations-for-simple-update-and-replace-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Cluster query execution plans for simple <code>UPDATE</code> and <code>REPLACE</code> queries that
modify multiple documents and do not use <code>LIMIT</code> are now more efficient as
several steps were removed. The existing optimizer rule
<code>undistribute-remove-after-enum-coll</code> has been extended to cover these cases
too, in case the collection is sharded by <code>_key</code> and the <code>UPDATE</code>/<code>REPLACE</code>
operation is using the full document or the <code>_key</code> attribute to find it.</p><p>For example, a query such as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>UPDATE</span> <span class=n>doc</span> <span class=kr>WITH</span> <span class=p>{</span> <span class=n>updated</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span> <span class=kr>IN</span> <span class=n>test</span></span></span></code></pre></div><p>… is executed as follows in 3.5:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                  <span class=n>Site</span>     <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>             <span class=n>DBS</span>         <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>           <span class=n>DBS</span>         <span class=mi>1</span>     <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#3</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;updated&#34;</span> <span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>   <span class=n>DBS</span>   <span class=mi>1000000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* full collection scan, 5 shard(s) */</span>
</span></span><span class=line><span class=cl> <span class=mi>11</span>   <span class=n>RemoteNode</span>                <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl> <span class=mi>12</span>   <span class=n>GatherNode</span>                <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>GATHER</span>  
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>DistributeNode</span>            <span class=n>COOR</span>  <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>DISTRIBUTE</span>  <span class=cm>/* create keys: false, variable: doc */</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>RemoteNode</span>                <span class=n>DBS</span>   <span class=mi>1000000</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>UpdateNode</span>                <span class=n>DBS</span>         <span class=mi>0</span>       <span class=o>-</span> <span class=kr>UPDATE</span> <span class=n>doc</span> <span class=kr>WITH</span> <span class=nl>#3</span> <span class=kr>IN</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>RemoteNode</span>                <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>   <span class=n>GatherNode</span>                <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>GATHER</span></span></span></code></pre></div><p>In 3.6 the execution plan is streamlined to just:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>          <span class=n>Site</span>     <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>     <span class=n>DBS</span>         <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>   <span class=n>DBS</span>         <span class=mi>1</span>     <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#3</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;updated&#34;</span> <span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=mi>13</span>   <span class=n>IndexNode</span>         <span class=n>DBS</span>   <span class=mi>1000000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* primary index scan, index only, projections: `_key`, 5 shard(s) */</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>UpdateNode</span>        <span class=n>DBS</span>         <span class=mi>0</span>       <span class=o>-</span> <span class=kr>UPDATE</span> <span class=n>doc</span> <span class=kr>WITH</span> <span class=nl>#3</span> <span class=kr>IN</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>RemoteNode</span>        <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>   <span class=n>GatherNode</span>        <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>GATHER</span>   <span class=cm>/* parallel */</span></span></span></code></pre></div><p>As can be seen above, the benefit of applying the optimization is that the extra
communication between the Coordinator and DB-Server is removed. This will
mean less cluster-internal traffic and thus can result in faster execution.
As an extra benefit, the optimization will also make the affected queries
eligible for parallel execution. It is only applied in cluster deployments.</p><p>The optimization will also work when a filter is involved:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>79</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>false</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span> <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=mi>4</span> <span class=kr>UPDATE</span> <span class=n>doc</span> <span class=kr>WITH</span> <span class=p>{</span> <span class=n>updated</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span> <span class=kr>IN</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>                  <span class=n>Site</span>     <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>             <span class=n>DBS</span>         <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>CalculationNode</span>           <span class=n>DBS</span>         <span class=mi>1</span>     <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#5</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;updated&#34;</span> <span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>EnumerateCollectionNode</span>   <span class=n>DBS</span>   <span class=mi>1000000</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>test</span>   <span class=cm>/* full collection scan, projections: `_key`, `value`, 5 shard(s) */</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>           <span class=n>DBS</span>   <span class=mi>1000000</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#3</span> <span class=o>=</span> <span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>`value`</span> <span class=o>==</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>FilterNode</span>                <span class=n>DBS</span>   <span class=mi>1000000</span>       <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#3</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>UpdateNode</span>                <span class=n>DBS</span>         <span class=mi>0</span>       <span class=o>-</span> <span class=kr>UPDATE</span> <span class=n>doc</span> <span class=kr>WITH</span> <span class=nl>#5</span> <span class=kr>IN</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>   <span class=n>RemoteNode</span>                <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl> <span class=mi>10</span>   <span class=n>GatherNode</span>                <span class=n>COOR</span>        <span class=mi>0</span>       <span class=o>-</span> <span class=n>GATHER</span></span></span></code></pre></div><h3 id=aql-date-functionality>AQL Date functionality <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#aql-date-functionality class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>AQL now enforces a valid date range for working with date/time in AQL.
The valid date ranges for any AQL date/time function are:</p><ul><li>for string date/time values: <code>"0000-01-01T00:00:00.000Z"</code> (including) up to
<code>"9999-12-31T23:59:59.999Z"</code> (including)</li><li>for numeric date/time values: -62167219200000 (including) up to 253402300799999
(including). These values are the numeric equivalents of
<code>"0000-01-01T00:00:00.000Z"</code> and <code>"9999-12-31T23:59:59.999Z"</code>.</li></ul><p>Any date/time values outside the given range that are passed into an AQL date
function will make the function return <code>null</code> and trigger a warning in the
query, which can optionally be escalated to an error and stop the query.</p><p>Any date/time operations that produce date/time outside the valid ranges stated
above will make the function return <code>null</code> and trigger a warning too.
An example for this is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>DATE_SUBTRACT</span><span class=p>(</span><span class=s2>&#34;2018-08-22T10:49:00+02:00&#34;</span><span class=p>,</span> <span class=mi>100000</span><span class=p>,</span> <span class=s2>&#34;years&#34;</span><span class=p>)</span></span></span></code></pre></div><p>The performance of AQL date operations that work on
<a href=/3.11/aql/functions/date/ class=link>date strings</a> has been improved
compared to previous versions.</p><p>Finally, ArangoDB 3.6 provides a new <a href=/3.11/aql/functions/date/#date_round class=link>AQL function</a>
<code>DATE_ROUND()</code> to bin a date/time into a set of equal-distance buckets.</p><h3 id=miscellaneous-aql-changes>Miscellaneous AQL changes <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#miscellaneous-aql-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>In addition, ArangoDB 3.6 provides the following new AQL functionality:</p><ul><li><p>a function <code>GEO_AREA()</code> for <a href=/3.11/aql/functions/geo/#geo_area class=link>area calculations</a>
(also added to v3.5.1)</p></li><li><p>a <a href=/3.11/aql/how-to-invoke-aql/with-arangosh/#maxruntime class=link><code>maxRuntime</code> query option</a>
to restrict the execution to a given time in seconds (also added to v3.5.4).
Also see <a href=/3.11/develop/http-api/queries/aql-queries/#create-a-cursor class=link>HTTP interfaces for AQL queries</a>.</p></li><li><p>a startup option <code>--query.optimizer-rules</code> to turn certain AQL query optimizer
rules off (or on) by default. This can be used to turn off certain optimizations
that would otherwise lead to undesired changes in server resource usage patterns.</p></li></ul><h2 id=arangosearch>ArangoSearch <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#arangosearch class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=analyzers>Analyzers <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#analyzers class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ul><li><p>Added UTF-8 support and ability to mark beginning/end of the sequence to
the <a href=/3.11/index-and-search/analyzers/#ngram class=link><code>ngram</code> Analyzer type</a>.</p><p>The following optional properties can be provided for an <code>ngram</code> Analyzer
definition:</p><ul><li><p><code>startMarker</code> : <code>&lt;string></code>, default: &ldquo;&rdquo;<br>this value will be prepended to <em>n</em>-grams at the beginning of input sequence</p></li><li><p><code>endMarker</code> : <code>&lt;string></code>, default: &ldquo;&rdquo;<br>this value will be appended to <em>n</em>-grams at the beginning of input sequence</p></li><li><p><code>streamType</code> : <code>"binary"|"utf8"</code>, default: &ldquo;binary&rdquo;<br>type of the input stream (support for UTF-8 is new)</p></li></ul></li><li><p>Added <em>edge n-gram</em> support to the <a href=/3.11/index-and-search/analyzers/#text class=link><code>text</code> Analyzer type</a>.
The input gets tokenized as usual, but then <em>n</em>-grams are generated from each
token. UTF-8 encoding is assumed (whereas the <code>ngram</code> Analyzer has a
configurable stream type and defaults to binary).</p><p>The following optional properties can be provided for a <code>text</code>
Analyzer definition:</p><ul><li><code>edgeNgram</code> (object, <em>optional</em>):<ul><li><code>min</code> (number, <em>optional</em>): minimal <em>n</em>-gram length</li><li><code>max</code> (number, <em>optional</em>): maximal <em>n</em>-gram length</li><li><code>preserveOriginal</code> (boolean, <em>optional</em>): include the original token
if its length is less than <em>min</em> or greater than <em>max</em></li></ul></li></ul></li></ul><h3 id=dynamic-search-expressions-with-arrays>Dynamic search expressions with arrays <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#dynamic-search-expressions-with-arrays class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoSearch now accepts <a href=/3.11/aql/high-level-operations/search/#syntax class=link>SEARCH expressions</a>
with array comparison operators in the form of:</p><pre tabindex=0><code>&lt;array&gt; [ ALL|ANY|NONE ] [ &lt;=|&lt;|==|!=|&gt;|&gt;=|IN ] doc.&lt;attribute&gt;
</code></pre><p>i.e. the left-hand side operand is always an array, which can be dynamic.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kd>LET</span> <span class=n>tokens</span> <span class=o>=</span> <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;some input&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>                 <span class=c1>// [&#34;some&#34;, &#34;input&#34;]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=n>tokens</span>  <span class=kr>ALL</span> <span class=kr>IN</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span> <span class=kr>RETURN</span> <span class=n>doc</span> <span class=c1>// dynamic conjunction
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=n>tokens</span>  <span class=kr>ANY</span> <span class=kr>IN</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span> <span class=kr>RETURN</span> <span class=n>doc</span> <span class=c1>// dynamic disjunction
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=n>tokens</span> <span class=kr>NONE</span> <span class=kr>IN</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span> <span class=kr>RETURN</span> <span class=n>doc</span> <span class=c1>// dynamic negation
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=n>tokens</span>  <span class=kr>ALL</span> <span class=o>&gt;</span>  <span class=n>doc</span><span class=p>.</span><span class=n>title</span> <span class=kr>RETURN</span> <span class=n>doc</span> <span class=c1>// dynamic conjunction with comparison
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=n>tokens</span>  <span class=kr>ANY</span> <span class=o>&lt;=</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span> <span class=kr>RETURN</span> <span class=n>doc</span> <span class=c1>// dynamic disjunction with comparison
</span></span></span></code></pre></div><p>In addition, both the <code>TOKENS()</code> and the <code>PHRASE()</code> functions were
extended with array support for convenience.</p><p><a href=/3.11/aql/functions/string/#tokens class=link>TOKENS()</a> accepts recursive arrays of
strings as the first argument:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;quick brown fox&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>        <span class=c1>// [ &#34;quick&#34;, &#34;brown&#34;, &#34;fox&#34; ]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>TOKENS</span><span class=p>([</span><span class=s2>&#34;quick brown&#34;</span><span class=p>,</span> <span class=s2>&#34;fox&#34;</span><span class=p>],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span>   <span class=c1>// [ [&#34;quick&#34;, &#34;brown&#34;], [&#34;fox&#34;] ]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>TOKENS</span><span class=p>([</span><span class=s2>&#34;quick brown&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;fox&#34;</span><span class=p>]],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=c1>// [ [&#34;quick&#34;, &#34;brown&#34;], [[&#34;fox&#34;]] ]
</span></span></span></code></pre></div><p>In most cases you will want to flatten the resulting array for further usage,
because nested arrays are not accepted in <code>SEARCH</code> statements such as
<code>&lt;array> ALL IN doc.&lt;attribute></code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kd>LET</span> <span class=n>tokens</span> <span class=o>=</span> <span class=nf>TOKENS</span><span class=p>([</span><span class=s2>&#34;quick brown&#34;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;fox&#34;</span><span class=p>]],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=c1>// [ [&#34;quick&#34;, &#34;brown&#34;], [[&#34;fox&#34;]] ]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>LET</span> <span class=n>tokens_flat</span> <span class=o>=</span> <span class=nf>FLATTEN</span><span class=p>(</span><span class=n>tokens</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>                     <span class=c1>// [ &#34;quick&#34;, &#34;brown&#34;, &#34;fox&#34; ]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span><span class=n>tokens_flat</span> <span class=kr>ALL</span> <span class=kr>IN</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p><a href=/3.11/aql/functions/arangosearch/#phrase class=link>PHRASE()</a> accepts an array as the
second argument:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;quick brown fox&#34;</span><span class=p>],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;quick&#34;</span><span class=p>,</span> <span class=s2>&#34;brown&#34;</span><span class=p>,</span> <span class=s2>&#34;fox&#34;</span><span class=p>],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>LET</span> <span class=n>tokens</span> <span class=o>=</span> <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;quick brown fox&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=c1>// [&#34;quick&#34;, &#34;brown&#34;, &#34;fox&#34;]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=n>tokens</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>It is equivalent to the more cumbersome and static form:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=s2>&#34;quick&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;brown&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;fox&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>You can optionally specify the number of <em>skipTokens</em> in the array form before
every string element:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;quick&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;fox&#34;</span><span class=p>,</span> <span class=s2>&#34;jumps&#34;</span><span class=p>],</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>It is the same as the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>myView</span> <span class=kp>SEARCH</span> <span class=nf>PHRASE</span><span class=p>(</span><span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=s2>&#34;quick&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;fox&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&#34;jumps&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en&#34;</span><span class=p>)</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><h3 id=smartjoins-and-views>SmartJoins and Views <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#smartjoins-and-views class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoSearch Views are now eligible for <a href=/3.11/develop/smartjoins/ class=link>SmartJoins</a> in AQL,
provided that their underlying collections are eligible too.</p><p>All collections forming the View must be sharded equally. The other join
operand can be a collection or another View.</p><h2 id=oneshard>OneShard <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#oneshard class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p class=labels><span class=label>ArangoDB Enterprise Edition</span>
<span class=label>ArangoGraph</span></p><p>Not all use cases require horizontal scalability. In such cases, a OneShard
deployment offers a practicable solution that enables significant performance
improvements by massively reducing cluster-internal communication.</p><p>A database created with OneShard enabled is limited to a single DB-Server node
but still replicated synchronously to ensure resilience. This configuration
allows running transactions with ACID guarantees on shard leaders.</p><p>This setup is highly recommended for most graph use cases and join-heavy
queries.</p><p>Unlike a (flexibly) sharded cluster, where the Coordinator distributes access
to shards across different DB-Server nodes, collects and processes partial
results, the Coordinator in a OneShard setup moves the query execution directly
to the respective DB-Server for local query execution. The Coordinator receives
only the final result. This can drastically reduce resource consumption and
communication effort for the Coordinator.</p><p>An entire cluster, selected databases or selected collections can be made
eligible for the OneShard optimization. See <a href=/3.11/deploy/oneshard/ class=link>OneShard cluster architecture</a>
for details and usage examples.</p><h2 id=http-api>HTTP API <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#http-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The following APIs have been expanded / changed:</p><ul><li><p><a href=/3.11/develop/http-api/databases/#create-a-database class=link>Database creation API</a>,<br>HTTP route <code>POST /_api/database</code></p><p>The database creation API now handles the <code>replicationFactor</code>, <code>writeConcern</code>
and <code>sharding</code> attributes. All these attributes are optional, and only
meaningful in a cluster.</p><p>The values provided for the attributes <code>replicationFactor</code> and <code>writeConcern</code>
will be used as default values when creating collections in that database,
allowing to omit these attributes when creating collections. However, the
values set here are just defaults for new collections in the database.
The values can still be adjusted per collection when creating new collections
in that database via the web UI, the arangosh or drivers.</p><p>In an Enterprise Edition cluster, the <code>sharding</code> attribute can be given a
value of <code>"single"</code>, which will make all new collections in that database use
the same shard distribution and use one shard by default (OneShard
configuration). This can still be overridden by setting the values of
<code>numberOfShards</code> and <code>distributeShardsLike</code> when creating new collections in
that database via the web UI, arangosh or drivers (unless the startup option
<code>--cluster.force-one-shard</code> is enabled).</p></li><li><p><a href=/3.11/develop/http-api/databases/#get-information-about-the-current-database class=link>Database properties API</a>,<br>HTTP route <code>GET /_api/database/current</code></p><p>The database properties endpoint returns the new additional attributes
<code>replicationFactor</code>, <code>writeConcern</code> and <code>sharding</code> in a cluster.
A description of these attributes can be found above.</p></li><li><p><a href=/3.11/develop/http-api/collections/ class=link>Collection</a> / <a href=/3.11/develop/http-api/graphs/named-graphs/#management class=link>Graph APIs</a>,<br>HTTP routes <code>POST /_api/collection</code>, <code>GET /_api/collection/{collection-name}/properties</code>
and various <code>/_api/gharial/*</code> endpoints</p><p><code>minReplicationFactor</code> has been renamed to <code>writeConcern</code> for consistency.
The old attribute name is still accepted and returned for compatibility.</p></li><li><p><a href=/3.11/develop/http-api/hot-backups/#create-a-backup class=link>Hot Backup API</a>,<br>HTTP route <code>POST /_admin/backup/create</code></p><p>New attribute <code>force</code>, see <a href=#hot-backup class=link>Hot Backup</a> below.</p></li><li><p>New <a href=/3.11/develop/http-api/monitoring/metrics/#metrics-api class=link>Metrics API</a>,<br>HTTP route <code>GET /_admin/metrics</code></p><p>Returns the instance&rsquo;s current metrics in Prometheus format. The returned
document collects all instance metrics, which are measured at any given
time and exposes them for collection by Prometheus.</p><p>The new endpoint can be used instead of the additional tool
<a href=https://github.com/arangodb-helper/arangodb-exporter target=_blank rel="noopener noreferrer" class=link>arangodb-exporter</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p></li></ul><h2 id=web-interface>Web interface <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#web-interface class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The web interface now shows the shards of all collections (including system
collections) in the shard distribution view. Displaying system collections here
is necessary to access the prototype collections of a collection sharded via
<code>distributeShardsLike</code> in case the prototype is a system collection, and the
prototype collection shall be moved to another server using the web interface.</p><p>The web interface now also allows setting a default replication factor when a
creating a new database. This default replication factor will be used for all
collections created in the new database, unless explicitly overridden.</p><h2 id=startup-options>Startup options <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#startup-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=metrics-api-option>Metrics API option <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#metrics-api-option class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new <a href=/3.11/components/arangodb-server/options/#--serverexport-metrics-api class=link>option</a>
<code>--server.export-metrics-api</code> allows you to disable the metrics API by setting
it to <code>false</code>, which is otherwise turned on by default.</p><h3 id=oneshard-cluster-option>OneShard cluster option <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#oneshard-cluster-option class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <a href=/3.11/components/arangodb-server/options/#--clusterforce-one-shard class=link>option</a>
<code>--cluster.force-one-shard</code> enables the new OneShard feature for the entire
cluster deployment. It forces the cluster into creating all future collections
with only a single shard and using the same DB-Server as these collections'
shards leader. All collections created this way will be eligible for specific
AQL query optimizations that can improve query performance and provide advanced
transactional guarantees.</p><h3 id=cluster-upgrade-option>Cluster upgrade option <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#cluster-upgrade-option class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new <a href=/3.11/components/arangodb-server/options/#--clusterupgrade class=link>option</a> <code>--cluster.upgrade</code>
toggles the cluster upgrade mode for Coordinators. It supports the following
values:</p><ul><li><p><code>auto</code>:
perform a cluster upgrade and shut down afterwards if the startup option
<code>--database.auto-upgrade</code> is set to true. Otherwise, don&rsquo;t perform an upgrade.</p></li><li><p><code>disable</code>:
never perform a cluster upgrade, regardless of the value of
<code>--database.auto-upgrade</code>.</p></li><li><p><code>force</code>:
always perform a cluster upgrade and shut down, regardless of the value of
<code>--database.auto-upgrade</code>.</p></li><li><p><code>online</code>:
always perform a cluster upgrade but don&rsquo;t shut down afterwards</p></li></ul><p>The default value is <code>auto</code>. The option only affects Coordinators. It does not
have any affect on single servers, Agents or DB-Servers.</p><h3 id=other-cluster-options>Other cluster options <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#other-cluster-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The following <a href=/3.11/components/arangodb-server/options/#cluster class=link>options</a> have been added:</p><ul><li><p><code>--cluster.max-replication-factor</code>: maximum replication factor for new
collections. A value of <code>0</code> means that there is no restriction.
The default value is <code>10</code>.</p></li><li><p><code>--cluster.min-replication-factor</code>: minimum replication factor for new
collections. The default value is <code>1</code>. This option can be used to prevent the
creation of collections that do not have any or enough replicas.</p></li><li><p><code>--cluster.write-concern</code>: default write concern value used for new
collections. This option controls the number of replicas that must
successfully acknowledge writes to a collection. If any write operation gets
less acknowledgements than configured here, the collection will go into
read-only mode until the configured number of replicas are available again.
The default value is <code>1</code>, meaning that writes to just the leader are
sufficient. To ensure that there is at least one extra copy (i.e. one
follower), set this option to <code>2</code>.</p></li><li><p><code>--cluster.max-number-of-shards</code>: maximum number of shards allowed for new
collections. A value of <code>0</code> means that there is no restriction.
The default value is <code>1000</code>.</p></li></ul><p>Note that the above options only have an effect when set for Coordinators, and
only for collections that are created after the options have been set. They do
not affect already existing collections.</p><p>Furthermore, the following network related <a href=/3.11/components/arangodb-server/options/#network class=link>options</a>
have been added:</p><ul><li><p><code>--network.idle-connection-ttl</code>: default time-to-live for idle cluster-internal
connections (in milliseconds). The default value is <code>60000</code>.</p></li><li><p><code>--network.io-threads</code>: number of I/O threads for cluster-internal network
requests. The default value is <code>2</code>.</p></li><li><p><code>--network.max-open-connections</code>: maximum number of open network connections
for cluster-internal requests. The default value is <code>1024</code>.</p></li><li><p><code>--network.verify-hosts</code>: if set to <code>true</code>, this will verify peer certificates
for cluster-internal requests when TLS is used. The default value is <code>false</code>.</p></li></ul><h3 id=rocksdb-exclusive-writes-option>RocksDB exclusive writes option <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#rocksdb-exclusive-writes-option class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new option <code>--rocksdb.exclusive-writes</code> allows to make all writes to the
RocksDB storage exclusive and therefore avoids write-write conflicts.
This option was introduced to open a way to upgrade from MMFiles to RocksDB
storage engine without modifying client application code. Otherwise it should
best be avoided as the use of exclusive locks on collections will introduce a
noticeable throughput penalty.</p><p>Note that the MMFiles engine is deprecated
from v3.6.0 on and will be removed in a future release. So will be this option,
which is a stopgap measure only.</p><h3 id=aql-options>AQL options <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#aql-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new startup option <code>--query.optimizer-rules</code> can be used to to selectively
enable or disable AQL query optimizer rules by default. The option can be
specified multiple times, and takes the same input as the query option of the
same name.</p><p>For example, to turn off the rule <code>use-indexes-for-sort</code>, use</p><pre tabindex=0><code>--query.optimizer-rules &#34;-use-indexes-for-sort&#34;
</code></pre><p>The purpose of this <a href=/3.11/components/arangodb-server/options/#--queryoptimizer-rules class=link>startup option</a>
is to be able to enable potential future experimental optimizer rules, which
may be shipped in a disabled-by-default state.</p><h2 id=hot-backup>Hot Backup <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#hot-backup class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><ul><li><p>Force Backup</p><p>When creating backups there is an additional option <code>--force</code> for
<a href=/3.11/components/tools/arangobackup/examples/ class=link>arangobackup</a> and in the HTTP API.
This option <strong>aborts</strong> ongoing write transactions to obtain the global lock
for creating the backup. Most likely this is <em>not</em> what you want to do
because it will abort valid ongoing write operations, but it makes sure that
backups can be acquired more quickly. The force flag currently only aborts
<a href=/3.11/develop/http-api/transactions/stream-transactions/ class=link>Stream Transactions</a> but no
<a href=/3.11/develop/http-api/transactions/javascript-transactions/ class=link>JavaScript Transactions</a>.</p></li><li><p>View Data</p><p>HotBackup now includes View data. Previously the Views had to be rebuilt
after a restore. Now the Views are available immediately.</p></li></ul><h2 id=tls-v13>TLS v1.3 <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#tls-v13 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Added support for TLS 1.3 for the <a href=/3.11/components/arangodb-server/options/#--sslprotocol class=link>arangod server</a>
and the client tools (also added to v3.5.1).</p><p>The arangod server can be started with option <code>--ssl.protocol 6</code> to make it require
TLS 1.3 for incoming client connections. The server can be started with option
<code>--ssl.protocol 5</code> to make it require TLS 1.2, as in previous versions of arangod.</p><p>The default TLS protocol for the arangod server is now generic TLS
(<code>--ssl.protocol 9</code>), which will allow the negotiation of the TLS version between
the client and the server.</p><p>All client tools also support TLS 1.3, by using the <code>--ssl.protocol 6</code> option when
invoking them. The client tools will use TLS 1.2 by default, in order to be
compatible with older versions of ArangoDB that may be contacted by these tools.</p><p>To configure the TLS version for arangod instances started by the ArangoDB starter,
one can use the <code>--all.ssl.protocol=VALUE</code> startup option for the ArangoDB starter,
where VALUE is one of the following:</p><ul><li>4 = TLSv1</li><li>5 = TLSv1.2</li><li>6 = TLSv1.3</li><li>9 = generic TLS</li></ul><p>Note: TLS v1.3 support has been added in ArangoDB v3.5.1 already, but the default TLS
version in ArangoDB 3.5 was still TLS v1.2. ArangoDB v3.6 uses &ldquo;generic TLS&rdquo; as its
default TLS version, which will allows clients to negotiate the TLS version with the
server, dynamically choosing the <strong>highest</strong> mutually supported version of TLS.</p><h2 id=miscellaneous>Miscellaneous <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#miscellaneous class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><ul><li><p>Remove operations for documents in the cluster will now use an optimization,
if all sharding keys are specified. Should the sharding keys not match the
values in the actual document, a not found error will be returned.</p></li><li><p><a href=/3.11/concepts/data-structure/collections/#collection-names class=link>Collection names</a>
in ArangoDB can now be up to 256 characters long, instead of 64 characters in
previous versions.</p></li><li><p>Disallow using <code>_id</code> or <code>_rev</code> as shard keys in clustered collections.</p><p>Using these attributes for sharding was not supported before, but didn&rsquo;t trigger
any errors. Instead, collections were created and silently using <code>_key</code> as
the shard key, without making the caller aware of that an unsupported shard
key was used.</p></li><li><p>Make the scheduler enforce the configured queue lengths. The values of the
options <code>--server.scheduler-queue-size</code>, <code>--server.prio1-size</code> and
<code>--server.maximal-queue-size</code> will now be honored and not exceeded.</p><p>The default queue sizes in the scheduler for requests buffering have
also been changed as follows:</p><pre tabindex=0><code>request type        before      now
-----------------------------------
high priority          128     4096
medium priority    1048576     4096
low priority          4096     4096
</code></pre><p>The queue sizes can still be adjusted at server start using the above-
mentioned startup options.</p></li></ul><h2 id=internal>Internal <a href=/3.11/release-notes/version-3.6/whats-new-in-3-6/#internal class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Release packages for Linux are now built using inter-procedural
optimizations (IPO).</p><p>We have moved from C++14 to C++17, which allows us to use some of the
simplifications, features and guarantees that this standard has in stock.
To compile ArangoDB 3.6 from source, a compiler that supports C++17 is now
required.</p><p>The bundled JEMalloc memory allocator used in ArangoDB release packages has
been upgraded from version 5.2.0 to version 5.2.1.</p><p>The bundled version of the Boost library has been upgraded from 1.69.0 to
1.71.0.</p><p>The bundled version of xxhash has been upgraded from 0.5.1 to 0.7.2.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.11/release-notes/version-3.6/><i class="fas fa-chevron-left fa-fw"></i><p>Version 3.6</p></a></span><span class=next><a class="nav nav-next link" href=/3.11/release-notes/version-3.6/known-issues-in-3-6/><p>Known Issues in 3.6</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.11/release-notes/version-3.6/whats-new-in-3-6.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#aql>AQL</a></div><div class=level-3><a href=#early-pruning-of-non-matching-documents>Early pruning of non-matching documents</a></div><div class=level-3><a href=#subquery-splicing-optimization>Subquery Splicing Optimization</a></div><div class=level-3><a href=#late-document-materialization-rocksdb>Late document materialization (RocksDB)</a></div><div class=level-3><a href=#parallelization-of-cluster-aql-queries>Parallelization of cluster AQL queries</a></div><div class=level-3><a href=#optimizations-for-simple-update-and-replace-queries>Optimizations for simple UPDATE and REPLACE queries</a></div><div class=level-3><a href=#aql-date-functionality>AQL Date functionality</a></div><div class=level-3><a href=#miscellaneous-aql-changes>Miscellaneous AQL changes</a></div><div class=level-2><a href=#arangosearch>ArangoSearch</a></div><div class=level-3><a href=#analyzers>Analyzers</a></div><div class=level-3><a href=#dynamic-search-expressions-with-arrays>Dynamic search expressions with arrays</a></div><div class=level-3><a href=#smartjoins-and-views>SmartJoins and Views</a></div><div class=level-2><a href=#oneshard>OneShard</a></div><div class=level-2><a href=#http-api>HTTP API</a></div><div class=level-2><a href=#web-interface>Web interface</a></div><div class=level-2><a href=#startup-options>Startup options</a></div><div class=level-3><a href=#metrics-api-option>Metrics API option</a></div><div class=level-3><a href=#oneshard-cluster-option>OneShard cluster option</a></div><div class=level-3><a href=#cluster-upgrade-option>Cluster upgrade option</a></div><div class=level-3><a href=#other-cluster-options>Other cluster options</a></div><div class=level-3><a href=#rocksdb-exclusive-writes-option>RocksDB exclusive writes option</a></div><div class=level-3><a href=#aql-options>AQL options</a></div><div class=level-2><a href=#hot-backup>Hot Backup</a></div><div class=level-2><a href=#tls-v13>TLS v1.3</a></div><div class=level-2><a href=#miscellaneous>Miscellaneous</a></div><div class=level-2><a href=#internal>Internal</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>