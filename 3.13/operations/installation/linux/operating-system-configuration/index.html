<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Recommendations regarding file systems, memory settings, and other options for running ArangoDB on Linux"><meta property="og:url" content="http://localhost/3.13/operations/installation/linux/operating-system-configuration/"><meta property="og:title" content="Linux Operating System Configuration"><meta property="og:type" content="website"><meta property="og:description" content="Recommendations regarding file systems, memory settings, and other options for running ArangoDB on Linux"><meta name=docsearch:version content="3.13"><title>Linux Operating System Configuration | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Operations"><a itemprop=item class=link href=/3.13/operations/><span itemprop=name class=breadcrumb-entry>Operations</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Installation"><a itemprop=item class=link href=/3.13/operations/installation/><span itemprop=name class=breadcrumb-entry>Installation</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Linux"><a itemprop=item class=link href=/3.13/operations/installation/linux/><span itemprop=name class=breadcrumb-entry>Linux</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Operating System Configuration"><a itemprop=item class=link href=/3.13/operations/installation/linux/operating-system-configuration/><span itemprop=name class=breadcrumb-entry>Operating System Configuration</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Linux Operating System Configuration</h1><p class=lead>Recommendations regarding file systems, memory settings, and other options for running ArangoDB on Linux</p></hgroup><div class="box notices cstyle tip"><div class=box-content-container><div class=box-content><i class="fas fa-check"></i><div class=box-text>The most important suggestions listed in this section can be
easily applied by making use of a script. Please refer to the page
<a href=/3.13/operations/installation/linux/linux-os-tuning-script-examples/ class=link>Linux OS Tuning Script Examples</a> for
ready-to-use examples.</div></div></div></div><h2 id=system-locales>System Locales <a href=/3.13/operations/installation/linux/operating-system-configuration/#system-locales class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Some systems may miss the required locale to start the server, resulting in an
error message like the following:</p><pre tabindex=0><code>FATAL [7ef60] {config} specified language &#39;en_US&#39; does not match previously used language &#39;&#39;
</code></pre><p>The locale can be generated with the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo locale-gen <span class=s2>&#34;en_US.UTF-8&#34;</span>
</span></span></code></pre></div><p>Your distribution may also provide a frontend for doing so, for instance
<a href=https://wiki.debian.org/Locale target=_blank rel="noopener noreferrer" class=link><code>dpkg-reconfigure locales</code> on Debian</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><p>If you don&rsquo;t set a <a href=/3.13/components/arangodb-server/options/#--default-language class=link>default language</a>
for the server explicitly, ArangoDB will use the default locale of your system.</p><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text>The server language is stored in the <code>LANGUAGE</code> file in the database directory.
This file should not be modified manually to bypass issues with the locale,
because it may render indexes invalid without raising a warning or error.
Dumping the data and restoring it into an instance that has the correct
language configured is advised.</div></div></div></div><h2 id=file-systems>File Systems <a href=/3.13/operations/installation/linux/operating-system-configuration/#file-systems class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>We recommend to <strong>not</strong> use BTRFS on linux, as user have reported issues using it in
conjunction with ArangoDB. We experienced ArangoDB facing latency issues when accessing
its database files on BTRFS partitions. In conjunction with BTRFS and AUFS we also saw
data loss on restart.</p><p>We would not recommend network filesystems such as NFS for performance reasons,
furthermore we experienced some issues with hard links required for Hot Backup.</p><h2 id=page-sizes>Page Sizes <a href=/3.13/operations/installation/linux/operating-system-configuration/#page-sizes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>On Linux ArangoDB uses <a href=https://github.com/jemalloc/jemalloc target=_blank rel="noopener noreferrer" class=link>jemalloc</a>&nbsp;<i class="fas fa-external-link-alt"></i> as
its memory allocator. Unfortunately, some OS configurations can interfere with
jemalloc&rsquo;s ability to function properly.
Specifically, Linux&rsquo;s &ldquo;transparent hugepages&rdquo; sometimes prevent jemalloc from
returning unused memory to the operating system and result in unnecessarily high
memory use. Therefore, we recommend disabling these features when using jemalloc with
ArangoDB. Please consult your operating system&rsquo;s documentation for how to do this.</p><p>Execute:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo bash -c <span class=s2>&#34;echo madvise &gt;/sys/kernel/mm/transparent_hugepage/enabled&#34;</span>
</span></span><span class=line><span class=cl>sudo bash -c <span class=s2>&#34;echo madvise &gt;/sys/kernel/mm/transparent_hugepage/defrag&#34;</span>
</span></span></code></pre></div><p>before executing <code>arangod</code>.</p><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text><p>The official release executables of ArangoDB require the operating system
to use a page size of <strong>4096 bytes</strong> or less.
Larger page sizes lead to the error <code>&lt;jemalloc>: Unsupported system page size</code>
during startup.</p><p>You can check the page size with the <code>getconf PAGESIZE</code> command.</p></div></div></div></div><h2 id=swap-space>Swap Space <a href=/3.13/operations/installation/linux/operating-system-configuration/#swap-space class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>It is recommended to assign swap space for a server that is running arangod.
Configuring swap space can prevent the operating system&rsquo;s OOM killer from
killing ArangoDB too eagerly on Linux.</p><h2 id=overcommit-memory>Overcommit Memory <a href=/3.13/operations/installation/linux/operating-system-configuration/#overcommit-memory class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The recommended kernel setting for <code>overcommit_memory</code> is 0 or 1.
The Linux kernel default is 0.</p><p>You can set it as follows before executing <code>arangod</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo bash -c <span class=s2>&#34;echo 0 &gt;/proc/sys/vm/overcommit_memory&#34;</span>
</span></span></code></pre></div><p>From <a href=https://www.kernel.org/doc/Documentation/sysctl/vm.txt target=_blank rel="noopener noreferrer" class=link>www.kernel.org</a>&nbsp;<i class="fas fa-external-link-alt"></i>:</p><ul><li><p>When this flag is 0, the kernel attempts to estimate the amount
of free memory left when userspace requests more memory.</p></li><li><p>When this flag is 1, the kernel pretends there is always enough
memory until it actually runs out.</p></li><li><p>When this flag is 2, the kernel uses a &ldquo;never overcommit&rdquo;
policy that attempts to prevent any overcommit of memory.</p></li></ul><p>Experience has shown that setting <code>overcommit_memory</code> to a value of 2 has severe
negative side-effects when running arangod, so it should be avoided at all costs.</p><h2 id=max-memory-mappings>Max Memory Mappings <a href=/3.13/operations/installation/linux/operating-system-configuration/#max-memory-mappings class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Linux kernels by default restrict the maximum number of memory mappings of a
single process to about 64K mappings. While this value is sufficient for most
workloads, it may be too low for a process that has lots of parallel threads
that all require their own memory mappings. In this case all the threads'
memory mappings will be accounted to the single arangod process, and the
maximum number of 64K mappings may be reached. When the maximum number of
mappings is reached, calls to mmap will fail, so the process will think no
more memory is available although there may be plenty of RAM left.</p><p>To avoid this scenario, it is recommended to raise the default value for the
maximum number of memory mappings to a sufficiently high value. As a rule of
thumb, one could use 8 times the number of available cores times 8,000.</p><p>For a 32 core server, a good rule-of-thumb value thus would be 2,048,000
(32 * 8 * 8000). For certain workloads, it may be sensible to use even a higher
value for the number of memory mappings.</p><p>To set the value once, use the following command before starting arangod:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo bash -c <span class=s2>&#34;sysctl -w &#39;vm.max_map_count=2048000&#39;&#34;</span>
</span></span></code></pre></div><p>To make the settings durable, it will be necessary to store the adjusted
settings in /etc/sysctl.conf or other places that the operating system is
looking at.</p><h2 id=memory-limits>Memory Limits <a href=/3.13/operations/installation/linux/operating-system-configuration/#memory-limits class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>A long-running arangod process may accumulate a lot of virtual memory after a
while, so it is recommended to <strong>not</strong> restrict the amount of virtual memory
that a process can acquire, neither via using <code>ulimit</code>, <code>cgroups</code> or systemd.</p><h2 id=zone-reclaim>Zone Reclaim <a href=/3.13/operations/installation/linux/operating-system-configuration/#zone-reclaim class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Execute</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo bash -c <span class=s2>&#34;echo 0 &gt;/proc/sys/vm/zone_reclaim_mode&#34;</span>
</span></span></code></pre></div><p>before executing <code>arangod</code>.</p><p>From <a href=https://www.kernel.org/doc/Documentation/sysctl/vm.txt target=_blank rel="noopener noreferrer" class=link>www.kernel.org</a>&nbsp;<i class="fas fa-external-link-alt"></i>:</p><p>This is value ORed together of</p><ul><li>1 = Zone reclaim on</li><li>2 = Zone reclaim writes dirty pages out</li><li>4 = Zone reclaim swaps pages</li></ul><h2 id=numa>NUMA <a href=/3.13/operations/installation/linux/operating-system-configuration/#numa class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Multi-processor systems often have non-uniform Access Memory (NUMA). ArangoDB
should be started with interleave on such system. This can be achieved using</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>numactl --interleave<span class=o>=</span>all arangod ...
</span></span></code></pre></div><h2 id=open-files-limit>Open Files Limit <a href=/3.13/operations/installation/linux/operating-system-configuration/#open-files-limit class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>An arangod instance may need to use a lot of file descriptors for working with
files and network resources. It is therefore required to allow arangod processes
to use a lot of file descriptors at the same time. A reasonable value for the
maximum number of open file descriptors for an arangod process is 1048576. This
should provide enough headroom so that arangod doesn&rsquo;t run out of file descriptors.</p><p>The maximum number of file descriptors can be adjusted using <code>ulimit</code>, <code>cgroups</code>
and <code>systemd</code>.</p><h2 id=32-bit>32-bit <a href=/3.13/operations/installation/linux/operating-system-configuration/#32-bit class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>While it might be possible to compile ArangoDB on 32-bit systems, this is not
officially supported and not a recommended environment. 64-bit systems can address
a significantly larger memory space. This is also the reason why only 64-bit
release builds are offered by ArangoDB Inc.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/operations/installation/linux/><i class="fas fa-chevron-left fa-fw"></i><p>Linux</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/operations/installation/linux/linux-os-tuning-script-examples/><p>Linux OS Tuning Script Examples</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/operations/installation/linux/operating-system-configuration.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#system-locales>System Locales</a></div><div class=level-2><a href=#file-systems>File Systems</a></div><div class=level-2><a href=#page-sizes>Page Sizes</a></div><div class=level-2><a href=#swap-space>Swap Space</a></div><div class=level-2><a href=#overcommit-memory>Overcommit Memory</a></div><div class=level-2><a href=#max-memory-mappings>Max Memory Mappings</a></div><div class=level-2><a href=#memory-limits>Memory Limits</a></div><div class=level-2><a href=#zone-reclaim>Zone Reclaim</a></div><div class=level-2><a href=#numa>NUMA</a></div><div class=level-2><a href=#open-files-limit>Open Files Limit</a></div><div class=level-2><a href=#32-bit>32-bit</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>