<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Redesigned cluster core architecture, graph traversals using the AQL query language, persistent indexes, overhauled Foxx microservices and web interface"><meta property="og:url" content="http://localhost/3.13/release-notes/version-3.0/whats-new-in-3-0/"><meta property="og:title" content="Features and Improvements in ArangoDB 3.0"><meta property="og:type" content="website"><meta property="og:description" content="Redesigned cluster core architecture, graph traversals using the AQL query language, persistent indexes, overhauled Foxx microservices and web interface"><meta name=docsearch:version content="3.13"><title>Features and Improvements in ArangoDB 3.0 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Release Notes"><a itemprop=item class=link href=/3.13/release-notes/><span itemprop=name class=breadcrumb-entry>Release Notes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Version 3.0"><a itemprop=item class=link href=/3.13/release-notes/version-3.0/><span itemprop=name class=breadcrumb-entry>Version 3.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="What&rsquo;s New in 3.0"><a itemprop=item class=link href=/3.13/release-notes/version-3.0/whats-new-in-3-0/><span itemprop=name class=breadcrumb-entry>What&rsquo;s New in 3.0</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Features and Improvements in ArangoDB 3.0</h1><p class=lead>Redesigned cluster core architecture, graph traversals using the AQL query language, persistent indexes, overhauled Foxx microservices and web interface</p></hgroup><p>The following list shows in detail which features have been added or improved in
ArangoDB 3.0. ArangoDB 3.0 also contains several bugfixes that are not listed
here.</p><h2 id=internal-data-format-changes>Internal data format changes <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#internal-data-format-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB now uses <a href=https://github.com/arangodb/velocypack target=_blank rel="noopener noreferrer" class=link>VelocyPack</a>&nbsp;<i class="fas fa-external-link-alt"></i> for
storing documents, query results and temporarily computed values. Using a single
data format removed the need for some data conversions in the core that slowed
operations down previously.</p><p>The VelocyPack format is also quite compact, and reduces storage space
requirements for &ldquo;small&rdquo; values such as boolean, integers, short strings. This
can speed up several operations inside AQL queries.</p><p>VelocyPack document entries stored on disk are also self-contained, in the sense
that each stored document will contain all of its data type and attribute name
descriptions. While this may require a bit more space for storing the documents,
it removes the overhead of fetching attribute names and document layout from
shared structures as in previous versions of ArangoDB. It also simplifies the
code paths for storing and reading documents.</p><h2 id=aql-improvements>AQL improvements <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#aql-improvements class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=syntax-improvements>Syntax improvements <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#syntax-improvements class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=like-string-comparison-operator><code>LIKE</code> string-comparison operator <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#like-string-comparison-operator class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>AQL now provides a <code>LIKE</code> operator and can be used to compare strings like this,
for example inside filter conditions:</p><pre tabindex=0><code>value LIKE search
</code></pre><p>This change makes <code>LIKE</code> an AQL keyword. Using <code>LIKE</code> as an attribute or collection
name in AQL thus requires quoting the name from now on.</p><p>The <code>LIKE</code> operator is currently implemented by calling the already existing AQL
function <code>LIKE</code>, which also remains operational in 3.0. Use the <code>LIKE</code> function
in case you want to search case-insensitive (optional parameter), as the <code>LIKE</code>
operator always compares case-sensitive.</p><h4 id=aql-array-comparison-operators>AQL array comparison operators <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#aql-array-comparison-operators class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>All AQL comparison operators now also exist in an array variant. In the
array variant, the operator is preceded with one of the keywords <code>ALL</code>, <code>ANY</code>
or <code>NONE</code>. Using one of these keywords changes the operator behavior to
execute the comparison operation for all, any, or none of its left hand
argument values. It is therefore expected that the left hand argument
of an array operator is an array.</p><p>Examples:</p><pre tabindex=0><code>[ 1, 2, 3 ] ALL IN [ 2, 3, 4 ]   // false
[ 1, 2, 3 ] ALL IN [ 1, 2, 3 ]   // true
[ 1, 2, 3 ] NONE IN [ 3 ]        // false
[ 1, 2, 3 ] NONE IN [ 23, 42 ]   // true
[ 1, 2, 3 ] ANY IN [ 4, 5, 6 ]   // false
[ 1, 2, 3 ] ANY IN [ 1, 42 ]     // true
[ 1, 2, 3 ] ANY == 2             // true
[ 1, 2, 3 ] ANY == 4             // false
[ 1, 2, 3 ] ANY &gt; 0              // true
[ 1, 2, 3 ] ANY &lt;= 1             // true
[ 1, 2, 3 ] NONE &lt; 99            // false
[ 1, 2, 3 ] NONE &gt; 10            // true
[ 1, 2, 3 ] ALL &gt; 2              // false
[ 1, 2, 3 ] ALL &gt; 0              // true
[ 1, 2, 3 ] ALL &gt;= 3             // false
[&#34;foo&#34;, &#34;bar&#34;] ALL != &#34;moo&#34;      // true
[&#34;foo&#34;, &#34;bar&#34;] NONE == &#34;bar&#34;     // false
[&#34;foo&#34;, &#34;bar&#34;] ANY == &#34;foo&#34;      // true
</code></pre><h4 id=regular-expression-string-comparison-operators>Regular expression string-comparison operators <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#regular-expression-string-comparison-operators class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>AQL now supports the operators <em>=~</em> and <em>!~</em> for testing strings against regular
expressions. <em>=~</em> tests if a string value matches a regular expression, and <em>!~</em> tests
if a string value does not match a regular expression.</p><p>The two operators expect their left-hand operands to be strings, and their right-hand
operands to be strings containing valid regular expressions as specified below.</p><p>The regular expressions may consist of literal characters and the following
characters and sequences:</p><ul><li><code>.</code> – the dot matches any single character except line terminators.
To include line terminators, use <code>[\s\S]</code> instead to simulate <code>.</code> with <em>DOTALL</em> flag.</li><li><code>\d</code> – matches a single digit, equivalent to <code>[0-9]</code></li><li><code>\s</code> – matches a single whitespace character</li><li><code>\S</code> – matches a single non-whitespace character</li><li><code>\t</code> – matches a tab character</li><li><code>\r</code> – matches a carriage return</li><li><code>\n</code> – matches a line-feed character</li><li><code>[xyz]</code> – set of characters. matches any of the enclosed characters (i.e.
<em>x</em>, <em>y</em> or <em>z</em> in this case</li><li><code>[^xyz]</code> – negated set of characters. matches any other character than the
enclosed ones (i.e. anything but <em>x</em>, <em>y</em> or <em>z</em> in this case)</li><li><code>[x-z]</code> – range of characters. Matches any of the characters in the
specified range, e.g. <code>[0-9A-F]</code> to match any character in
<em>0123456789ABCDEF</em></li><li><code>[^x-z]</code> – negated range of characters. Matches any other character than the
ones specified in the range</li><li><code>(xyz)</code> – defines and matches a pattern group</li><li><code>(x|y)</code> – matches either <em>x</em> or <em>y</em></li><li><code>^</code> – matches the beginning of the string (e.g. <code>^xyz</code>)</li><li><code>$</code> – matches the end of the string (e.g. <code>xyz$</code>)</li></ul><p>Note that the characters <code>.</code>, <code>*</code>, <code>?</code>, <code>[</code>, <code>]</code>, <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>^</code>,
and <code>$</code> have a special meaning in regular expressions and may need to be
escaped using a backslash (<code>\\</code>). A literal backslash should also be escaped
using another backslash, i.e. <code>\\\\</code>.</p><p>Characters and sequences may optionally be repeated using the following
quantifiers:</p><ul><li><code>x*</code> – matches zero or more occurrences of <em>x</em></li><li><code>x+</code> – matches one or more occurrences of <em>x</em></li><li><code>x?</code> – matches one or zero occurrences of <em>x</em></li><li><code>x{y}</code> – matches exactly <em>y</em> occurrences of <em>x</em></li><li><code>x{y,z}</code> – matches between <em>y</em> and <em>z</em> occurrences of <em>x</em></li><li><code>x{y,}</code> – matches at least <em>y</em> occurrences of <em>x</em></li></ul><h4 id=enclosing-identifiers-in-forward-ticks>Enclosing identifiers in forward ticks <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#enclosing-identifiers-in-forward-ticks class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>AQL identifiers can now optionally be enclosed in forward ticks in addition to using
backward ticks. This allows convenient writing of AQL queries in JavaScript template
strings (which are delimited with backticks themselves), e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>q</span> <span class=o>=</span> <span class=sb>`FOR doc IN ´collection´ RETURN doc.´name´`</span><span class=p>;</span></span></span></code></pre></div><h3 id=functions-added>Functions added <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#functions-added class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The following AQL functions have been added in 3.0:</p><ul><li><p><em>REGEX_TEST(value, regex)</em>: tests whether the string <em>value</em> matches the regular expression
specified in <em>regex</em>. Returns <em>true</em> if it matches, and <em>false</em> otherwise.</p><p>The syntax for regular expressions is the same as for the regular expression operators
<em>=~</em> and <em>!~</em>.</p></li><li><p><em>HASH(value)</em>: Calculates a hash value for <em>value</em>. <em>value</em> is not required to be a
string, but can have any data type. The calculated hash value will take the data type
of <em>value</em> into account, so for example the number <em>1</em> and the string <em>&ldquo;1&rdquo;</em> will have
different hash values. For arrays the hash values will be created if the arrays contain
exactly the same values (including value types) in the same order. For objects the same
hash values will be created if the objects have exactly the same attribute names and
values (including value types). The order in which attributes appear inside objects
is not important for hashing.
The hash value returned by this function is a number. The hash algorithm is not guaranteed
to remain the same in future versions of ArangoDB. The hash values should therefore be
used only for temporary calculations, e.g. to compare if two documents are the same, or
for grouping values in queries.</p></li><li><p><em>TYPENAME(value)</em>: Returns the data type name of <em>value</em>. The data type name can
be either <em>null</em>, <em>bool</em>, <em>number</em>, <em>string</em>, <em>array</em> or <em>object</em>.</p></li><li><p><em>LOG(value)</em>: Returns the natural logarithm of <em>value</em>. The base is Euler&rsquo;s constant
(2.71828&mldr;).</p></li><li><p><em>LOG2(value)</em>: Returns the base 2 logarithm of <em>value</em>.</p></li><li><p><em>LOG10(value)</em>: Returns the base 10 logarithm of <em>value</em>.</p></li><li><p><em>EXP(value)</em>: Returns Euler&rsquo;s constant (2.71828&mldr;) raised to the power of <em>value</em>.</p></li><li><p><em>EXP2(value)</em>: Returns 2 raised to the power of <em>value</em>.</p></li><li><p><em>SIN(value)</em>: Returns the sine of <em>value</em>.</p></li><li><p><em>COS(value)</em>: Returns the cosine of <em>value</em>.</p></li><li><p><em>TAN(value)</em>: Returns the tangent of <em>value</em>.</p></li><li><p><em>ASIN(value)</em>: Returns the arcsine of <em>value</em>.</p></li><li><p><em>ACOS(value)</em>: Returns the arccosine of <em>value</em>.</p></li><li><p><em>ATAN(value)</em>: Returns the arctangent of <em>value</em>.</p></li><li><p><em>ATAN2(y, x)</em>: Returns the arctangent of the quotient of <em>y</em> and <em>x</em>.</p></li><li><p><em>RADIANS(value)</em>: Returns the angle converted from degrees to radians.</p></li><li><p><em>DEGREES(value)</em>: Returns the angle converted from radians to degrees.</p></li></ul><h3 id=optimizer-improvements>Optimizer improvements <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#optimizer-improvements class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=inline-subqueries-rule>&ldquo;inline-subqueries&rdquo; rule <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#inline-subqueries-rule class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The AQL optimizer rule &ldquo;inline-subqueries&rdquo; has been added. This rule can pull
out certain subqueries that are used as an operand to a <code>FOR</code> loop one level
higher, eliminating the subquery completely. This reduces complexity of the
query&rsquo;s execution plan and will likely enable further optimizations. For
example, the query</p><pre tabindex=0><code>FOR i IN (
    FOR j IN [1,2,3]
      RETURN j
  )
  RETURN i
</code></pre><p>will be transformed by the rule to:</p><pre tabindex=0><code>FOR i IN [1,2,3]
  RETURN i
</code></pre><p>The query</p><pre tabindex=0><code>FOR name IN (
  FOR doc IN _users
    FILTER doc.status == 1
    RETURN doc.name
  )
  LIMIT 2
  RETURN name
</code></pre><p>will be transformed into</p><pre tabindex=0><code>FOR tmp IN _users
  FILTER tmp.status == 1
  LIMIT 2
  RETURN tmp.name
</code></pre><p>The rule will only fire when the subquery is used as an operand to a <code>FOR</code> loop,
and if the subquery does not contain a <code>COLLECT</code> with an <code>INTO</code> variable.</p><h4 id=remove-unnecessary-calculations-rule>&ldquo;remove-unnecessary-calculations&rdquo; rule <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#remove-unnecessary-calculations-rule class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The AQL optimizer rule &ldquo;remove-unnecessary-calculations&rdquo; now fires in more cases
than in previous versions. This rule removes calculations from execution plans,
and by having less calculations done, a query may execute faster or requires
less memory.</p><p>The rule will now remove calculations that are used exactly once in other
expressions (e.g. <code>LET a = doc RETURN a.value</code>) and calculations, or calculations
that are just references to other variables (e.g. <code>LET a = b</code>).</p><h4 id=optimize-traversals-rule>&ldquo;optimize-traversals&rdquo; rule <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#optimize-traversals-rule class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The AQL optimizer rule &ldquo;merge-traversal-filter&rdquo; was renamed to &ldquo;optimize-traversals&rdquo;.
The rule will remove unused edge and path result variables from the traversal in case
they are specified in the <code>FOR</code> section of the traversal, but not referenced later in
the query. This saves constructing edges and paths results that are not used later.</p><p>AQL now uses VelocyPack internally for storing intermediate values. For many value types
it can now get away without extra memory allocations and less internal conversions.
Values can be passed into internal AQL functions without copying them. This can lead to
reduced query execution times for queries that use C++-based AQL functions.</p><h4 id=replace-or-with-in-and-use-index-for-sort-rules>&ldquo;replace-or-with-in&rdquo; and &ldquo;use-index-for-sort&rdquo; rules <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#replace-or-with-in-and-use-index-for-sort-rules class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>These rules now fire in some additional cases, which allows simplifying index lookup
conditions and removing SortNodes from execution plans.</p><h2 id=cluster-state-management>Cluster state management <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#cluster-state-management class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The cluster&rsquo;s internal state information is now also managed by ArangoDB instances.
Earlier versions relied on third party software being installed for the storing the
cluster state.
The state is managed by dedicated ArangoDB instances, which can be started in a special
<em>agency</em> mode. These instances can operate in a distributed fashion. They will
automatically elect one of them to become their leader, being responsible for storing
the state changes sent from servers in the cluster. The other instances will automatically
follow the leader and will transparently stand in should it become unavailable.
The Agency instances are also self-organizing: they will continuously probe each
other and re-elect leaders. The communication between the Agency instances use the
consensus-based RAFT protocol.</p><p>The operations for storing and retrieving cluster state information are now much less
expensive from an ArangoDB cluster node perspective, which in turn allows for faster
cluster operations that need to fetch or update the overall cluster state.</p><h2 id=_from-and-_to-attributes-of-edges-are-updatable-and-usable-in-indexes><code>_from</code> and <code>_to</code> attributes of edges are updatable and usable in indexes <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#_from-and-_to-attributes-of-edges-are-updatable-and-usable-in-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>In ArangoDB prior to 3.0 the attributes <code>_from</code> and <code>_to</code> of edges were treated
specially when loading or storing edges. That special handling led to these attributes
being not as flexible as regular document attributes. For example, the <code>_from</code> and
<code>_to</code> attribute values of an existing edge could not be updated once the edge was
created. Now this is possible via the single-document APIs and via AQL.</p><p>Additionally, the <code>_from</code> and <code>_to</code> attributes could not be indexed in
user-defined indexes, e.g. to make each combination of <code>_from</code> and <code>_to</code> unique.
Finally, as <code>_from</code> and <code>_to</code> referenced the linked collections by collection id
and not by collection name, their meaning became unclear once a referenced collection
was dropped. The collection id stored in edges then became unusable, and when
accessing such edge the collection name part of it was always translated to <code>_undefined</code>.</p><p>In ArangoDB 3.0, the <code>_from</code> and <code>_to</code> values of edges are saved as regular strings.
This allows using <code>_from</code> and <code>_to</code> in user-defined indexes. Additionally, this allows
to update the <code>_from</code> and <code>_to</code> values of existing edges. Furthermore, collections
referenced by <code>_from</code> and <code>_to</code> values may be dropped and re-created later. Any
<code>_from</code> and <code>_to</code> values of edges pointing to such dropped collection are unaffected
by the drop operation now.</p><h2 id=unified-apis-for-crud-operations>Unified APIs for CRUD operations <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#unified-apis-for-crud-operations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The CRUD APIs for documents and edge have been unified. Edges can now be inserted
and modified via the same APIs as documents. <code>_from</code> and <code>_to</code> attribute values can
be passed as regular document attributes now:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>myedges</span><span class=p>.</span><span class=nx>insert</span><span class=p>({</span> <span class=nx>_from</span><span class=o>:</span> <span class=s2>&#34;myvertices/some&#34;</span><span class=p>,</span> <span class=nx>_to</span><span class=o>:</span> <span class=s2>&#34;myvertices/other&#34;</span><span class=p>,</span> <span class=p>...</span> <span class=p>});</span></span></span></code></pre></div><p>Passing <code>_from</code> and <code>_to</code> separately as it was required in earlier versions is not
necessary anymore but will still work:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>myedges</span><span class=p>.</span><span class=nx>insert</span><span class=p>(</span><span class=s2>&#34;myvertices/some&#34;</span><span class=p>,</span> <span class=s2>&#34;myvertices/other&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=p>...</span> <span class=p>});</span></span></span></code></pre></div><p>The CRUD operations now also support batch variants that works on arrays of
documents/edges, e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>myedges</span><span class=p>.</span><span class=nx>insert</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>_from</span><span class=o>:</span> <span class=s2>&#34;myvertices/some&#34;</span><span class=p>,</span> <span class=nx>_to</span><span class=o>:</span> <span class=s2>&#34;myvertices/other&#34;</span><span class=p>,</span> <span class=p>...</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>_from</span><span class=o>:</span> <span class=s2>&#34;myvertices/who&#34;</span><span class=p>,</span> <span class=nx>_to</span><span class=o>:</span> <span class=s2>&#34;myvertices/friend&#34;</span><span class=p>,</span> <span class=p>...</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nx>_from</span><span class=o>:</span> <span class=s2>&#34;myvertices/one&#34;</span><span class=p>,</span> <span class=nx>_to</span><span class=o>:</span> <span class=s2>&#34;myvertices/two&#34;</span><span class=p>,</span> <span class=p>...</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]);</span></span></span></code></pre></div><p>The batch variants are also available in ArangoDB&rsquo;s HTTP API. They can be used to
more efficiently carry out operations with multiple documents than their single-document
equivalents, which required one HTTP request per operation. With the batch operations,
the HTTP request/response overhead can be amortized across multiple operations.</p><h2 id=persistent-indexes>Persistent indexes <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#persistent-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB 3.0 provides an experimental persistent index feature. Persistent indexes store
the index values on disk instead of in-memory only. This means the indexes do not need
to be rebuilt in-memory when a collection is loaded or reloaded, which should improve
collection loading times.</p><p>The persistent indexes in ArangoDB are based on the RocksDB engine.
To create a persistent index for a collection, create an index of type &ldquo;rocksdb&rdquo; as
follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>mycollection</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;rocksdb&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;fieldname&#34;</span> <span class=p>]});</span></span></span></code></pre></div><p>The persistent indexes are sorted, so they allow equality lookups and range queries.
Note that the feature is still highly experimental and has some known deficiencies. It
will be finalized until the release of the 3.0 stable version.</p><h2 id=upgraded-v8-version>Upgraded V8 version <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#upgraded-v8-version class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The V8 engine that is used inside ArangoDB to execute JavaScript code has been upgraded from
version 4.3.61 to 5.0.71.39. The new version makes several more ES6 features available by
default, including</p><ul><li>arrow functions</li><li>computed property names</li><li>rest parameters</li><li>array destructuring</li><li>numeric and object literals</li></ul><h2 id=web-admin-interface>Web Admin Interface <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#web-admin-interface class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The ArangoDB 3.0 web interface is significantly improved. It now comes with a more
responsive design, making it easier to use on different devices. Navigation and menus
have been simplified, and related items have been regrouped to stay closer together
and allow tighter workflows.</p><p>The AQL query editor is now much easier to use. Multiple queries can be started and tracked
in parallel, while results of earlier queries are still preserved. Queries still running
can be canceled directly from the editor. The AQL query editor now allows the usage of bind
parameters too, and provides a helper for finding collection names, AQL function names and
keywords quickly.</p><p>The web interface now keeps track of whether the server is offline and of which server-side
operations have been started and are still running. It now remains usable while such
longer-running operations are ongoing. It also keeps more state about user&rsquo;s choices (e.g.
windows sizes, whether the tree or the code view was last used in the document editor).</p><p>Cluster statistics are now integrated into the web interface as well. Additionally, a
menu item &ldquo;Help us&rdquo; has been added to easily provide the ArangoDB team feedback about
the product.</p><p>The frontend may now be mounted behind a reverse proxy on a different path. For this to work
the proxy should send a X-Script-Name header containing the path.</p><p>A backend configuration for haproxy might look like this:</p><pre tabindex=0><code>reqadd X-Script-Name:\ /arangodb
</code></pre><p>The frontend will recognize the subpath and produce appropriate links. ArangoDB will only
accept paths from trusted frontend proxies. Trusted proxies may be added on startup:</p><pre tabindex=0><code>--frontend.proxy-request-check true --frontend.trusted-proxy 192.168.1.117
</code></pre><p>--frontend.trusted-proxy may be any address or netmask.</p><p>To disable the check and blindly accept any x-script-name set --frontend.proxy-request-check
to false.</p><h2 id=foxx-improvements>Foxx improvements <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#foxx-improvements class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The Foxx framework has been completely rewritten for 3.0 with a new, simpler and
more familiar API. The most notable changes are:</p><ul><li><p>Legacy mode for 2.8 services</p><p>Stuck with old code? You can continue using your 2.8-compatible Foxx services with
3.0 by adding <code>"engines": {"arangodb": "^2.8.0"}</code> (or similar version ranges that
exclude 3.0 and up) to the service manifest.</p></li><li><p>No more global variables and magical comments</p><p>The <code>applicationContext</code> is now <code>module.context</code>. Instead of magical comments just
use the <code>summary</code> and <code>description</code> methods to document your routes.</p></li><li><p>Repository and Model have been removed</p><p>Instead of repositories just use ArangoDB collections directly. For validation simply
use the joi schemas (but wrapped in <code>joi.object()</code>) that previously lived inside the
model. Collections and queries return plain JavaScript objects.</p></li><li><p>Controllers have been replaced with nestable routers</p><p>Create routers with <code>require('@arangodb/foxx/router')()</code>, attach them to your service
with <code>module.context.use(router)</code>. Because routers are no longer mounted automagically,
you can export and import them like any other object. Use <code>router.use('/path', subRouter)</code>
to nest routers as deeply as you want.</p></li><li><p>Routes can be named and reversed</p><p>No more memorizing URLs: add a name to your route like
<code>router.get('/hello/:name', function () {...}, 'hello')</code> and redirect to the full URL
with <code>res.redirect(req.resolve('hello', {name: 'world'}))</code>.</p></li><li><p>Simpler express-like middleware</p><p>If you already know express, this should be familiar. Here&rsquo;s a request logger in
three lines of code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>start</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span><span class=nx>next</span><span class=p>();}</span>
</span></span><span class=line><span class=cl>  <span class=k>finally</span> <span class=p>{</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>method</span><span class=si>}</span><span class=sb> </span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>url</span><span class=si>}</span><span class=sb> </span><span class=si>${</span><span class=nx>res</span><span class=p>.</span><span class=nx>statusCode</span><span class=si>}</span><span class=sb> </span><span class=si>${</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>start</span><span class=si>}</span><span class=sb>ms`</span><span class=p>);}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div></li><li><p>Sessions and auth without dependencies</p><p>To make it easier to get started, the functionality previously provided by the
<code>simple-auth</code>, <code>oauth2</code>, <code>sessions-local</code> and <code>sessions-jwt</code> services have been moved
into Foxx as the <code>@arangodb/foxx/auth</code>, <code>@arangodb/foxx/oauth2</code> and <code>@arangodb/foxx/sessions</code>
modules.</p></li></ul><h2 id=logging>Logging <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#logging class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB&rsquo;s logging is now grouped into topics. The log verbosity and output files can
be adjusted per log topic. For example</p><pre tabindex=0><code>--log.level startup=trace --log.level queries=trace --log.level info
</code></pre><p>will log messages concerning startup at trace level, AQL queries at trace level and
everything else at info level. <code>--log.level</code> can be specified multiple times at startup,
for as many topics as needed.</p><p>Some relevant log topics available in 3.0 are:</p><ul><li><em>collector</em>: information about the WAL collector&rsquo;s state</li><li><em>compactor</em>: information about the collection datafile compactor</li><li><em>datafiles</em>: datafile-related operations</li><li><em>mmap</em>: information about memory-mapping operations (including msync)</li><li><em>queries</em>: executed AQL queries, slow queries</li><li><em>replication</em>: replication-related info</li><li><em>requests</em>: HTTP requests</li><li><em>startup</em>: information about server startup and shutdown</li><li><em>threads</em>: information about threads</li></ul><p>This also allows directing log output to different files based on topics. For
example, to log all AQL queries to a file &ldquo;queries.log&rdquo; one can use the options:</p><pre tabindex=0><code>--log.level queries=trace --log.output queries=file:///path/to/queries.log
</code></pre><p>To additionally log HTTP request to a file named &ldquo;requests.log&rdquo; add the options:</p><pre tabindex=0><code>--log.level requests=info --log.output requests=file:///path/to/requests.log
</code></pre><h2 id=build-system>Build system <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#build-system class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB now uses the cross-platform build system CMake for all its builds.
Previous versions used two different build systems, making development and
contributions harder than necessary. Now the build system is unified, and
all targets (Linux, Windows, macOS) are built from the same set of build
instructions.</p><h2 id=documentation>Documentation <a href=/3.13/release-notes/version-3.0/whats-new-in-3-0/#documentation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The documentation has been enhanced and re-organized to be more intuitive.</p><p>A new introduction for beginners should bring you up to speed with ArangoDB
in less than an hour. Additional topics have been introduced and will be
extended with upcoming releases.</p><p>The topics AQL and HTTP API are now separated from the manual for better
searchability and less confusion. A version switcher makes it easier to
jump to the version of the docs you are interested in.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/release-notes/version-3.0/><i class="fas fa-chevron-left fa-fw"></i><p>Version 3.0</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/release-notes/version-3.0/incompatible-changes-in-3-0/><p>Incompatible changes in 3.0</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/release-notes/version-3.0/whats-new-in-3-0.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#internal-data-format-changes>Internal data format changes</a></div><div class=level-2><a href=#aql-improvements>AQL improvements</a></div><div class=level-3><a href=#syntax-improvements>Syntax improvements</a></div><div class=level-4><a href=#like-string-comparison-operator><code>LIKE</code> string-comparison operator</a></div><div class=level-4><a href=#aql-array-comparison-operators>AQL array comparison operators</a></div><div class=level-4><a href=#regular-expression-string-comparison-operators>Regular expression string-comparison operators</a></div><div class=level-4><a href=#enclosing-identifiers-in-forward-ticks>Enclosing identifiers in forward ticks</a></div><div class=level-3><a href=#functions-added>Functions added</a></div><div class=level-3><a href=#optimizer-improvements>Optimizer improvements</a></div><div class=level-4><a href=#inline-subqueries-rule>&ldquo;inline-subqueries&rdquo; rule</a></div><div class=level-4><a href=#remove-unnecessary-calculations-rule>&ldquo;remove-unnecessary-calculations&rdquo; rule</a></div><div class=level-4><a href=#optimize-traversals-rule>&ldquo;optimize-traversals&rdquo; rule</a></div><div class=level-4><a href=#replace-or-with-in-and-use-index-for-sort-rules>&ldquo;replace-or-with-in&rdquo; and &ldquo;use-index-for-sort&rdquo; rules</a></div><div class=level-2><a href=#cluster-state-management>Cluster state management</a></div><div class=level-2><a href=#_from-and-_to-attributes-of-edges-are-updatable-and-usable-in-indexes><code>_from</code> and <code>_to</code> attributes of edges are updatable and usable in indexes</a></div><div class=level-2><a href=#unified-apis-for-crud-operations>Unified APIs for CRUD operations</a></div><div class=level-2><a href=#persistent-indexes>Persistent indexes</a></div><div class=level-2><a href=#upgraded-v8-version>Upgraded V8 version</a></div><div class=level-2><a href=#web-admin-interface>Web Admin Interface</a></div><div class=level-2><a href=#foxx-improvements>Foxx improvements</a></div><div class=level-2><a href=#logging>Logging</a></div><div class=level-2><a href=#build-system>Build system</a></div><div class=level-2><a href=#documentation>Documentation</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>