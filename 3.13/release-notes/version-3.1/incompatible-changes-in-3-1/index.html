<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1747031427></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Check the following list of potential breaking changes before upgrading to this ArangoDB version and adjust any client applications if necessary"><meta property="og:url" content="http://localhost/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/"><meta property="og:title" content="Incompatible changes in ArangoDB 3.1"><meta property="og:type" content="website"><meta property="og:description" content="Check the following list of potential breaking changes before upgrading to this ArangoDB version and adjust any client applications if necessary"><meta name=docsearch:version content="3.13"><title>Incompatible changes in ArangoDB 3.1 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1747031427 defer></script>
<script src=/js/featherlight.min.js?1747031427 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1747031427 defer></script>
<script src=/js/theme.js?1747031427 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Release Notes"><a itemprop=item class=link href=/3.13/release-notes/><span itemprop=name class=breadcrumb-entry>Release Notes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Version 3.1"><a itemprop=item class=link href=/3.13/release-notes/version-3.1/><span itemprop=name class=breadcrumb-entry>Version 3.1</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Incompatible changes in 3.1"><a itemprop=item class=link href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/><span itemprop=name class=breadcrumb-entry>Incompatible changes in 3.1</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Incompatible changes in ArangoDB 3.1</h1><p class=lead>Check the following list of potential breaking changes <strong>before</strong> upgrading to this ArangoDB version and adjust any client applications if necessary</p></hgroup><h2 id=communication-layer>Communication Layer <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#communication-layer class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The internal communication layer is now based on Boost ASIO. A few options
regarding threads and communication have been changed.</p><p>There are no longer two different threads pools (<code>--scheduler.threads</code> and
<code>--server.threads</code>). The option <code>--scheduler.threads</code> has been removed. The
number of threads is now controlled by the option <code>--server.threads</code> only.
By default <code>--server.threads</code> is set to the number of hyper-cores.</p><p>As a consequence of the change, the following (hidden) startup options have
been removed:</p><ul><li><code>--server.extra-threads</code></li><li><code>--server.aql-threads</code></li><li><code>--server.backend</code></li><li><code>--server.show-backends</code></li><li><code>--server.thread-affinity</code></li></ul><h2 id=aql>AQL <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#aql class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The behavior of the AQL array comparison operators has changed for empty arrays:</p><ul><li><p><code>ALL</code> and <code>ANY</code> now always return <code>false</code> when the left-hand operand is an
empty array. The behavior for non-empty arrays does not change:</p><ul><li><code>[] ALL == 1</code> will return <code>false</code></li><li><code>[1] ALL == 1</code> will return <code>true</code></li><li><code>[1, 2] ALL == 1</code> will return <code>false</code></li><li><code>[2, 2] ALL == 1</code> will return <code>false</code></li><li><code>[] ANY == 1</code> will return <code>false</code></li><li><code>[1] ANY == 1</code> will return <code>true</code></li><li><code>[1, 2] ANY == 1</code> will return <code>true</code></li><li><code>[2, 2] ANY == 1</code> will return <code>false</code></li></ul></li><li><p><code>NONE</code> now always returns <code>true</code> when the left-hand operand is an empty array.
The behavior for non-empty arrays does not change:</p><ul><li><code>[] NONE == 1</code> will return <code>true</code></li><li><code>[1] NONE == 1</code> will return <code>false</code></li><li><code>[1, 2] NONE == 1</code> will return <code>false</code></li><li><code>[2, 2] NONE == 1</code> will return <code>true</code></li></ul></li><li><p><code>WITH</code> in cluster traversals is now mandatory in order to avoid deadlocks.</p></li></ul><h2 id=data-format-changes>Data format changes <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#data-format-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The attribute <code>maximalSize</code> has been renamed to <code>journalSize</code> in collection
meta-data files (&ldquo;parameter.json&rdquo;). Files containing the <code>maximalSize</code> attribute
will still be picked up correctly for not-yet adjusted collections.</p><p>The format of the revision values stored in the <code>_rev</code> attribute of documents
has been changed in 3.1. Up to 3.0 they were strings containing largish decimal numbers. With 3.1, revision values are still strings, but are actually encoded time stamps of the creation date of the revision of the document. The time stamps are acquired using a hybrid logical clock (HLC) on the DB-Server that holds the
revision (for the concept of a hybrid logical clock see
<a href=http://www.cse.buffalo.edu/tech-reports/2014-04.pdf target=_blank rel="noopener noreferrer" class=link>this paper</a>&nbsp;<i class="fas fa-external-link-alt"></i>).
See <a href=/3.13/concepts/data-structure/documents/#document-revisions class=link>this manual section</a> for details.</p><p>ArangoDB >= 3.1 can ArangoDB 3.0 database directories and will simply continue
to use the old <code>_rev</code> attribute values. New revisions will be written with
the new time stamps.</p><p>It is highly recommended to backup all your data before loading a database
directory that was written by ArangoDB &lt;= 3.0 into an ArangoDB >= 3.1.</p><p>To change all your old <code>_rev</code> attributes into new style time stamps you
have to use <code>arangodump</code> to dump all data out (using ArangoDB 3.0), and
use <code>arangorestore</code> into the new ArangoDB 3.1, which is the safest
way to upgrade.</p><p>The change also affects the return format of <code>_rev</code> values and other revision
values in HTTP APIs (see below).</p><h2 id=http-api-changes>HTTP API changes <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#http-api-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=apis-added>APIs added <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#apis-added class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The following HTTP REST APIs have been added for online log level adjustment of
the server:</p><ul><li>GET <code>/_admin/log/level</code> returns the current log level settings</li><li>PUT <code>/_admin/log/level</code> modifies the current log level settings</li></ul><h3 id=apis-changed>APIs changed <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#apis-changed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ul><li><p>the following REST APIs that return revision ids now make use of the new revision
id format introduced in 3.1. All revision ids returned will be strings as in 3.0, but
have a different internal format.</p><p>The following APIs are affected:</p><ul><li>GET /_api/collection/{collection}/checksum: <code>revision</code> attribute</li><li>GET /_api/collection/{collection}/revision: <code>revision</code> attribute</li><li>all other APIs that return documents, which may include the documents&rsquo; <code>_rev</code> attribute</li></ul><p>Client applications should not try to interpret the internals of revision values, but only
use revision values for checking whether two revision strings are identical.</p></li><li><p>the replication REST APIs will now use the attribute name <code>journalSize</code> instead of
<code>maximalSize</code> when returning information about collections.</p></li><li><p>the default value for <code>keepNull</code> has been changed from <code>false</code> to <code>true</code> for
the following partial update operations for vertices and edges in /_api/gharial:</p><ul><li>PATCH /_api/gharial/{graph}/vertex/{collection}/{key}</li><li>PATCH /_api/gharial/{graph}/edge/{collection}/{key}</li></ul><p>The value for <code>keepNull</code> can still be set explicitly to <code>false</code> by setting the
URL parameter <code>keepNull</code> to a value of <code>false</code>.</p></li><li><p>the REST API for dropping collections (DELETE /_api/collection) now accepts an
optional query string parameter <code>isSystem</code>, which can set to <code>true</code> in order to
drop system collections. If the parameter is not set or not set to true, the REST
API will refuse to drop system collections. In previous versions of ArangoDB, the
<code>isSystem</code> parameter did not exist, and there was no distinction between system
and non-system collections when dropping collections.</p></li><li><p>the REST API for retrieving AQL query results (POST /_api/cursor) will now return an
additional sub-attribute <code>loading collections</code> that will contain the total time
required for loading and locking collections during the AQL query when profiling is
enabled. The attribute can be found in the <code>extra</code> result attribute in sub-attribute
<code>loading collections</code>. The attribute will only be set if profiling was enabled for
the query.</p></li><li><p>the REST API for retrieving AQL query results (POST /_api/cursor) will now accept the optional attribute <code>memoryLimit</code>.</p></li></ul><h2 id=foxx-testing>Foxx Testing <a href=/3.13/release-notes/version-3.1/incompatible-changes-in-3-1/#foxx-testing class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The QUnit interface to Mocha has been removed. This affects the behavior of the <code>suite</code>, <code>test</code>, <code>before</code>, <code>after</code>, <code>beforeEach</code> and <code>afterEach</code> functions in Foxx test suites. The <code>suite</code> and <code>test</code> functions are now provided by the TDD interface. The <code>before</code>, <code>after</code>, <code>beforeEach</code> and <code>afterEach</code> functions are now provided by the BDD interface.</p><p>This should not cause any problems with existing tests but may result in failures in test cases that previously passed for the wrong reasons. Specifically the execution order of the <code>before</code>, <code>after</code>, etc functions now follows the intended order and is no longer arbitrary.</p><p>For details on the expected behavior of these functions see the <a href=/3.13/develop/foxx-microservices/guides/testing-foxx-services/ class=link>testing chapter</a> in the Foxx documentation.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/release-notes/version-3.1/whats-new-in-3-1/><i class="fas fa-chevron-left fa-fw"></i><p>What&rsquo;s New in 3.1</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/release-notes/version-3.0/><p>Version 3.0</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/release-notes/version-3.1/incompatible-changes-in-3-1.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#communication-layer>Communication Layer</a></div><div class=level-2><a href=#aql>AQL</a></div><div class=level-2><a href=#data-format-changes>Data format changes</a></div><div class=level-2><a href=#http-api-changes>HTTP API changes</a></div><div class=level-3><a href=#apis-added>APIs added</a></div><div class=level-3><a href=#apis-changed>APIs changed</a></div><div class=level-2><a href=#foxx-testing>Foxx Testing</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>