<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="The tasks module provides an interface for managing scheduled and periodic execution of JavaScript code on the server side"><meta property="og:url" content="http://localhost/3.13/develop/javascript-api/tasks/"><meta property="og:title" content="The @arangodb/tasks module of the JavaScript API"><meta property="og:type" content="website"><meta property="og:description" content="The tasks module provides an interface for managing scheduled and periodic execution of JavaScript code on the server side"><meta name=docsearch:version content="3.13"><title>The @arangodb/tasks module of the JavaScript API | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Develop"><a itemprop=item class=link href=/3.13/develop/><span itemprop=name class=breadcrumb-entry>Develop</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="JavaScript API"><a itemprop=item class=link href=/3.13/develop/javascript-api/><span itemprop=name class=breadcrumb-entry>JavaScript API</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="@arangodb/tasks"><a itemprop=item class=link href=/3.13/develop/javascript-api/tasks/><span itemprop=name class=breadcrumb-entry>@arangodb/tasks</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>The <code>@arangodb/tasks</code> module of the JavaScript API</h1><p class=lead>The tasks module provides an interface for managing scheduled and periodic execution of JavaScript code on the server side</p></hgroup><p><code>const tasks = require('@arangodb/tasks')</code></p><p><strong>Note</strong>: If you are trying to schedule tasks in Foxx you should
consider using the <a href=/3.13/develop/foxx-microservices/guides/scripts-and-scheduling/#queues class=link>Foxx queues module</a> instead,
which provides a more high-level API that also persists tasks across reboots.</p><h2 id=introduction-to-task-management-in-arangodb>Introduction to Task Management in ArangoDB <a href=/3.13/develop/javascript-api/tasks/#introduction-to-task-management-in-arangodb class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB can execute user-defined JavaScript functions as one-shot
or periodic tasks. This functionality can be used to implement timed
or recurring jobs in the database.</p><p>Tasks in ArangoDB consist of a JavaScript snippet or function that is
executed when the task is scheduled. A task can be a one-shot task
(meaning it is run once and not repeated) or a periodic task (meaning
that it is re-scheduled after each execution). Tasks can have optional
parameters, which are defined at task setup time. The parameters
specified at task setup time will be passed as arguments to the
task whenever it gets executed. Periodic Tasks have an execution
frequency that needs to be specified when the task is set up. One-shot
tasks have a configurable delay after which they&rsquo;ll get executed.</p><p>Tasks will be executed on the server they have been set up on.
Tasks will not be shipped around in a cluster. A task will be
executed in the context of the database it was created in. However,
when dropping a database, any tasks that were created in the context
of this database will remain active. It is therefore sensible to
first unregister all active tasks for a database before dropping the
database.</p><p>Tasks registered in ArangoDB will be executed until the server
gets shut down or restarted. After a restart of the server, any
user-defined one-shot or periodic tasks will be lost.</p><h2 id=commands-for-working-with-tasks>Commands for Working with Tasks <a href=/3.13/develop/javascript-api/tasks/#commands-for-working-with-tasks class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB provides the following commands for working with tasks.
All commands can be accessed via the <em>tasks</em> module, which can be
loaded like this:</p><p><code>require("@arangodb/tasks")</code></p><p>Please note that the <em>tasks</em> module is available inside the ArangoDB
server only. It cannot be used from the ArangoShell or ArangoDB&rsquo;s web
interface.</p><h2 id=register-a-task>Register a task <a href=/3.13/develop/javascript-api/tasks/#register-a-task class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To register a task, the JavaScript snippet or function needs to be
specified in addition to the execution frequency. Optionally, a task
can have an id and a name. If no id is specified, it will be auto-assigned
for a new task. The task id is also the means to access or unregister a
task later. Task names are informational only. They can be used to make
a task distinguishable from other tasks also running on the server.</p><p>The following server-side commands register a task. The command to be
executed is a JavaScript string snippet which prints a message to the
server&rsquo;s logfile:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>register</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span><span class=o>:</span> <span class=s2>&#34;mytask-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;this is a snippet task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>period</span><span class=o>:</span> <span class=mi>15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>command</span><span class=o>:</span> <span class=s2>&#34;require(&#39;console&#39;).log(&#39;hello from snippet task&#39;);&#34;</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>The above has register a task with id <em>mytask-1</em>, which will be executed
every 15 seconds on the server. The task will write a log message whenever
it is invoked.</p><p>Tasks can also be set up using a JavaScript callback function like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>register</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span><span class=o>:</span> <span class=s2>&#34;mytask-2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;this is a function task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>period</span><span class=o>:</span> <span class=mi>15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>command</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;console&#39;</span><span class=p>).</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;hello from function task&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>It is important to note that the callback function is late bound and
will be executed in a different context than in the creation context.
The callback function must therefore not access any variables defined
outside of its own scope. The callback function can still define and
use its own variables.</p><p>To pass parameters to a task, the <em>params</em> attribute can be set when
registering a task. Note that the parameters are limited to data types
usable in JSON (meaning no callback functions can be passed as parameters
into a task):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>register</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span><span class=o>:</span> <span class=s2>&#34;mytask-3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;this is a parameter task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>period</span><span class=o>:</span> <span class=mi>15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>command</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>params</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>greeting</span> <span class=o>=</span> <span class=nx>params</span><span class=p>.</span><span class=nx>greeting</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>params</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;console&#39;</span><span class=p>).</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;%s from parameter task: %s&#39;</span><span class=p>,</span> <span class=nx>greeting</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>params</span><span class=o>:</span> <span class=p>{</span> <span class=nx>greeting</span><span class=o>:</span> <span class=s2>&#34;hi&#34;</span><span class=p>,</span> <span class=nx>data</span><span class=o>:</span> <span class=s2>&#34;how are you?&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Registering a one-shot task works the same way, except that the
<em>period</em> attribute must be omitted. If <em>period</em> is omitted, then the
task will be executed just once. The task invocation delay can optionally
be specified with the <em>offset</em> attribute:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>register</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span><span class=o>:</span> <span class=s2>&#34;mytask-once&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;this is a one-shot task&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>offset</span><span class=o>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>command</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>params</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;console&#39;</span><span class=p>).</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;you will see me just once!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p><strong>Note</strong>: When specifying an <em>offset</em> value of 0, ArangoDB will internally add
a very small value to the offset so will be slightly greater than zero.</p><h2 id=unregister-a-task>Unregister a task <a href=/3.13/develop/javascript-api/tasks/#unregister-a-task class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>After a task has been registered, it can be unregistered using its id:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>unregister</span><span class=p>(</span><span class=s2>&#34;mytask-1&#34;</span><span class=p>);</span></span></span></code></pre></div><p>Note that unregistering a non-existing task will throw an exception.</p><h2 id=list-all-tasks>List all tasks <a href=/3.13/develop/javascript-api/tasks/#list-all-tasks class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To get an overview of which tasks are registered, there is the <em>get</em>
method. If the <em>get</em> method is called without any arguments, it will
return an array of all tasks:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>get</span><span class=p>();</span></span></span></code></pre></div><p>If <em>get</em> is called with a task id argument, it will return information
about this particular task:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tasks</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/tasks&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>tasks</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s2>&#34;mytask-3&#34;</span><span class=p>);</span></span></span></code></pre></div><p>The <em>created</em> attribute of a task reveals when a task was created. It is
returned as a Unix timestamp.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/develop/javascript-api/request/><i class="fas fa-chevron-left fa-fw"></i><p>@arangodb/request</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/develop/javascript-api/console/><p>console</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/develop/javascript-api/tasks.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#introduction-to-task-management-in-arangodb>Introduction to Task Management in ArangoDB</a></div><div class=level-2><a href=#commands-for-working-with-tasks>Commands for Working with Tasks</a></div><div class=level-2><a href=#register-a-task>Register a task</a></div><div class=level-2><a href=#unregister-a-task>Unregister a task</a></div><div class=level-2><a href=#list-all-tasks>List all tasks</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>