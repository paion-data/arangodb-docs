<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743775370></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Various detailed have changed, like the setup, transport, configuration, serialization, and some of the APIs"><meta property="og:url" content="http://localhost/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/"><meta property="og:title" content="Changes in version 7"><meta property="og:type" content="website"><meta property="og:description" content="Various detailed have changed, like the setup, transport, configuration, serialization, and some of the APIs"><meta name=docsearch:version content="3.13"><title>Changes in version 7 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743775370 defer></script>
<script src=/js/featherlight.min.js?1743775370 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743775370 defer></script>
<script src=/js/theme.js?1743775370 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Develop"><a itemprop=item class=link href=/3.13/develop/><span itemprop=name class=breadcrumb-entry>Develop</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Drivers"><a itemprop=item class=link href=/3.13/develop/drivers/><span itemprop=name class=breadcrumb-entry>Drivers</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Java driver"><a itemprop=item class=link href=/3.13/develop/drivers/java/><span itemprop=name class=breadcrumb-entry>Java driver</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Reference version 7"><a itemprop=item class=link href=/3.13/develop/drivers/java/reference-version-7/><span itemprop=name class=breadcrumb-entry>Reference version 7</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Changes in version 7"><a itemprop=item class=link href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/><span itemprop=name class=breadcrumb-entry>Changes in version 7</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Changes in version 7</h1><p class=lead>Various detailed have changed, like the setup, transport, configuration, serialization, and some of the APIs</p></hgroup><h2 id=maven-setup>Maven Setup <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#maven-setup class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;artifactId&gt;</span>arangodb-java-driver<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;version&gt;</span>7.x.x<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependencies&gt;</span>
</span></span></code></pre></div><h2 id=gradle-setup>Gradle Setup <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#gradle-setup class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>repositories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>mavenCentral</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;com.arangodb:arangodb-java-driver:7.x.x&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=http-client>HTTP client <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#http-client class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The HTTP client has been changed to <a href=https://vertx.io/docs/vertx-web-client/java/ target=_blank rel="noopener noreferrer" class=link>Vert.x WebClient</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><p><code>HTTP/2</code> is now supported.
<code>HTTP/2</code> supports multiplexing and uses <code>1</code> connection per host by default.</p><p>Cookies are not supported anymore: cookies received in the response are ignored.</p><h2 id=configuration-changes>Configuration changes <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#configuration-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The default communication protocol is now <code>HTTP2_JSON</code> (<code>HTTP/2</code> with <code>JSON</code> content type).</p><p>The default host configuration to <code>127.0.0.1:8529</code> has been removed.</p><p>Configuration properties are not read automatically from properties files anymore.
A new API for loading properties has been introduced:
<code>ArangoDB.Builder.loadProperties(ArangoConfigProperties)</code>.
Implementations can supply configuration properties coming from different sources,
like system properties, remote stores, frameworks integrations, etc.
An implementation for loading properties from local files is provided by
<code>ArangoConfigProperties.fromFile()</code> and its overloaded variants.</p><p>Example of how to read config properties prefixed with <code>arangodb</code> from
<code>arangodb.properties</code> file (as in version <code>6</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ## src/main/resources/arangodb.properties
</span></span></span><span class=line><span class=cl><span class=c1>// arangodb.hosts=172.28.0.1:8529
</span></span></span><span class=line><span class=cl><span class=c1>// arangodb.password=test
</span></span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>ArangoConfigProperties</span> <span class=n>props</span> <span class=o>=</span> <span class=n>ArangoConfigProperties</span><span class=o>.</span><span class=na>fromFile</span><span class=o>();</span>
</span></span></code></pre></div><p>To read config properties from <code>arangodb-with-prefix.properties</code> file, where the
config properties are prefixed with <code>adb</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ## src/main/resources/arangodb-with-prefix.properties
</span></span></span><span class=line><span class=cl><span class=c1>// adb.hosts=172.28.0.1:8529
</span></span></span><span class=line><span class=cl><span class=c1>// adb.password=test
</span></span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>ArangoConfigProperties</span> <span class=n>props</span> <span class=o>=</span> <span class=n>ArangoConfigProperties</span><span class=o>.</span><span class=na>fromFile</span><span class=o>(</span><span class=s>&#34;arangodb-with-prefix.properties&#34;</span><span class=o>,</span> <span class=s>&#34;adb&#34;</span><span class=o>);</span>
</span></span></code></pre></div><p>See the related reference documentation about
<a href=/3.13/develop/drivers/java/reference-version-7/driver-setup/#config-file-properties class=link>Config File Properties</a>
for details.</p><p>Examples showing how to provide configuration properties from different sources:</p><ul><li><a href=https://github.com/arangodb-helper/arango-quarkus-native-example/blob/master/src/main/java/com/arangodb/ArangoConfig.java target=_blank rel="noopener noreferrer" class=link>Eclipse MicroProfile Config</a>&nbsp;<i class="fas fa-external-link-alt"></i></li><li><a href=https://github.com/arangodb-helper/arango-micronaut-native-example/blob/main/src/main/kotlin/com/example/ArangoConfig.kt target=_blank rel="noopener noreferrer" class=link>Micronaut Configuration</a>&nbsp;<i class="fas fa-external-link-alt"></i></li></ul><h2 id=modules>Modules <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#modules class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Support for different serdes and communication protocols is offered by separate modules.
Default modules are transitively included, but they could be excluded if not needed.</p><p>The main driver artifact <code>com.arangodb:arangodb-java-driver</code> has transitive dependencies on default modules:</p><ul><li><code>com.arangodb:http-protocol</code>: <code>HTTP</code> communication protocol (HTTP/1.1 and HTTP/2)</li><li><code>com.arangodb:jackson-serde-json</code>: <code>JSON</code> user-data serde module based on Jackson Databind</li></ul><p>Alternative module for user-data serde:</p><ul><li><code>com.arangodb:jackson-serde-vpack</code>: <code>VPACK</code> user-data serde module based on Jackson Databind</li></ul><p>The modules above are discovered and loaded using SPI (Service Provider Interface).</p><p>In case a non-default communication protocol or user serde are used, the related module(s)
must be explicitly included and the corresponding default module(s) can be excluded.</p><p>For example, to use the driver with <code>VPACK</code> over <code>HTTP</code>:</p><ul><li>You must include <code>com.arangodb:jackson-serde-vpack</code></li><li>You can exclude <code>com.arangodb:jackson-serde-json</code></li><li>You don&rsquo;t need to include <code>com.arangodb:http-protocol</code> because the driver
includes it automatically</li></ul><p>For example in Maven:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;artifactId&gt;</span>arangodb-java-driver<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;exclusions&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;exclusion&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;artifactId&gt;</span>jackson-serde-json<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/exclusion&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/exclusions&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;groupId&gt;</span>com.arangodb<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;artifactId&gt;</span>jackson-serde-vpack<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependencies&gt;</span>
</span></span></code></pre></div><h2 id=transitive-dependencies>Transitive dependencies <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#transitive-dependencies class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p><code>com.arangodb:arangodb-java-driver</code> has transitive dependencies on <code>jackson-core</code>,
<code>jackson-databind</code>, and <code>jackson-annotations</code>, using by default version <code>2.14</code>.</p><p>The versions of such libraries can be overridden.
The driver is compatible with Jackson 2 (at least <code>2.10</code> or greater).</p><p>To do this, you might need to include <a href=https://github.com/FasterXML/jackson-bom target=_blank rel="noopener noreferrer" class=link>jackson-bom</a>&nbsp;<i class="fas fa-external-link-alt"></i>
to ensure dependency convergence across the entire project, for example in case
there are in your project other libraries depending on different versions of Jackson:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependencyManagement&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>com.fasterxml.jackson<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>jackson-bom<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>...<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;scope&gt;</span>import<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;type&gt;</span>pom<span class=nt>&lt;/type&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependencies&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependencyManagement&gt;</span>
</span></span></code></pre></div><p>The module <code>http-protocol</code> has transitive dependency on <code>io.vertx:vertx-web-client</code>,
which in turn depends on packages from <code>io.netty</code>.</p><p>If these dependency requirements cannot be satisfied, i.e. they cause convergence
conflicts with other versions of same packages in the classpath, you might need
to use the <a href=#arangodb-java-driver-shaded class=link>shaded version</a> of this driver, which
bundles all modules together with relocated external dependencies.</p><p>The dependency on <code>com.arangodb:velocypack</code> has been removed from core module and
is now only used as internal dependency by <code>com.arangodb:jackson-serde-vpack</code>,
thus transitively imported only when using <code>VPACK</code> content type.</p><h2 id=user-data>User Data <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#user-data class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Before version 7.0, the driver always parsed raw strings as JSON, but unfortunately
this did not allow to distinguish it from the case when the intent is to use the
raw string as such, without parsing it. From version 7.0 onward, strings are not
interpreted as JSON anymore. To represent user-data as raw JSON, the wrapper
class <code>com.arangodb.util.RawJson</code> has been added:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>RawJson</span> <span class=n>rawJsonIn</span> <span class=o>=</span> <span class=n>RawJson</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s>        {&#34;</span><span class=n>foo</span><span class=s>&#34;:&#34;</span><span class=n>bar</span><span class=s>&#34;}
</span></span></span><span class=line><span class=cl><span class=s>        &#34;&#34;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>ArangoCursor</span><span class=o>&lt;</span><span class=n>RawJson</span><span class=o>&gt;</span> <span class=n>res</span> <span class=o>=</span> <span class=n>adb</span><span class=o>.</span><span class=na>db</span><span class=o>().</span><span class=na>query</span><span class=o>(</span><span class=s>&#34;RETURN @v&#34;</span><span class=o>,</span> <span class=n>Map</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;v&#34;</span><span class=o>,</span> <span class=n>rawJsonIn</span><span class=o>),</span> <span class=n>RawJson</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>RawJson</span> <span class=n>rawJsonOut</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=n>rawJsonOut</span><span class=o>.</span><span class=na>get</span><span class=o>();</span>  <span class=c1>// {&#34;foo&#34;:&#34;bar&#34;}
</span></span></span></code></pre></div><p>To represent user-data already encoded as byte array, the wrapper class <code>RawBytes</code>
has been added. The byte array can either represent a <code>JSON</code> string (UTF-8 encoded)
or a <code>VPACK</code> value. The format used should match the driver protocol configuration
(<code>JSON</code> for <code>HTTP_JSON</code> and <code>HTTP2_JSON</code>, otherwise <code>VPACK</code>).</p><p>The following changes have been applied to <code>com.arangodb.entity.BaseDocument</code>
and <code>com.arangodb.entity.BaseEdgeDocument</code>:</p><ul><li>new method <code>removeAttribute(String)</code></li><li><code>getProperties()</code> returns an unmodifiable map</li></ul><p>Before version 7.0, when performing write operations, the metadata of the input
data objects was updated in place with the metadata received in the response.
From version 7.0 onward, the input data objects passed as arguments to API methods
are treated as immutable and the related metadata fields are not updated anymore.
The updated metadata can be found in the returned object.</p><h2 id=serialization--deserialization>Serialization / Deserialization <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#serialization--deserialization class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Up to version 6, the (de)serialization was always performed to/from <code>VPACK</code>.
In case the JSON format was required, the raw <code>VPACK</code> was then converted to <code>JSON</code>.
From version 7 onward, the serialization module is a dataformat-agnostic API.
Implementations can serialize and deserialize directly to the target dataformat,
without intermediate conversion to <code>VPACK</code>. The default implementation uses the
<code>JSON</code> format.</p><p>Support for data type <code>VPackSlice</code> has been removed in favor of Jackson type
<code>com.fasterxml.jackson.databind.JsonNode</code> and its subclasses
(<code>ArrayNode</code>, <code>ObjectNode</code>, &mldr;), for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>JsonNode</span> <span class=n>jsonNodeIn</span> <span class=o>=</span> <span class=n>JsonNodeFactory</span><span class=o>.</span><span class=na>instance</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>objectNode</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;foo&#34;</span><span class=o>,</span> <span class=s>&#34;bar&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ArangoCursor</span><span class=o>&lt;</span><span class=n>JsonNode</span><span class=o>&gt;</span> <span class=n>res</span> <span class=o>=</span> <span class=n>adb</span><span class=o>.</span><span class=na>db</span><span class=o>().</span><span class=na>query</span><span class=o>(</span><span class=s>&#34;RETURN @v&#34;</span><span class=o>,</span> <span class=n>Map</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;v&#34;</span><span class=o>,</span> <span class=n>jsonNodeIn</span><span class=o>),</span> <span class=n>JsonNode</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>JsonNode</span> <span class=n>jsonNodeOut</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>foo</span> <span class=o>=</span> <span class=n>jsonNodeOut</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;foo&#34;</span><span class=o>).</span><span class=na>textValue</span><span class=o>();</span>    <span class=c1>// bar
</span></span></span></code></pre></div><p>The dependency on <code>com.arangodb:velocypack</code> has been removed. Since version 3.0,
<code>com.arangodb:velocypack</code> does not include databind functionalities anymore.
It only offers a lower level API to deal with primitive <code>VPACK</code> types.
<code>VPACK</code> databind functionalities are now offered by
<a href=https://github.com/arangodb/jackson-dataformat-velocypack target=_blank rel="noopener noreferrer" class=link><code>jackson-dataformat-velocypack</code></a>&nbsp;<i class="fas fa-external-link-alt"></i>,
which is a Jackson backend for <code>VPACK</code> dataformat.</p><p>The user-data custom serializer implementation <code>ArangoJack</code> has been removed in
favor of <code>com.arangodb.serde.jackson.JacksonSerde</code>. This allows using Jackson API
to serialize and deserialize user-data, compatible with both <code>JSON</code> and <code>VPACK</code>.</p><p>See the detailed documentation about <a href=/3.13/develop/drivers/java/reference-version-7/serialization/ class=link>Serialization</a>
for more information.</p><h2 id=arangodb-java-driver-shaded>ArangoDB Java Driver Shaded <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#arangodb-java-driver-shaded class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>From version 7 onward, a shaded variant of the driver is also published with
Maven coordinates: <code>com.arangodb:arangodb-java-driver-shaded</code>.</p><p>It bundles and relocates the following packages:</p><ul><li><code>com.fasterxml.jackson</code></li><li><code>com.arangodb.jackson.dataformat.velocypack</code></li><li><code>io.vertx</code></li><li><code>io.netty</code></li></ul><p>Note that the <strong>internal serde</strong> internally uses Jackson classes from
<code>com.fasterxml.jackson</code> that are relocated to <code>com.arangodb.shaded.fasterxml.jackson</code>.
Therefore, the <strong>internal serde</strong> of the shaded driver is not compatible with
Jackson annotations and modules from package<code>com.fasterxml.jackson</code>, but only
with their relocated variants. In case the <strong>internal serde</strong> is used as
<strong>user-data serde</strong>, the annotations from package <code>com.arangodb.serde</code> can be
used to annotate fields, parameters, getters and setters for mapping values
representing ArangoDB documents metadata (<code>_id</code>, <code>_key</code>, <code>_rev</code>, <code>_from</code>, <code>_to</code>):</p><ul><li><code>@InternalId</code></li><li><code>@InternalKey</code></li><li><code>@InternalRev</code></li><li><code>@InternalFrom</code></li><li><code>@InternalTo</code></li></ul><p>These annotations are compatible with relocated Jackson classes.
Note that the <strong>internal serde</strong> is not part of the public API and could change
in future releases without notice, thus breaking client applications relying on
it to serialize or deserialize user-data. It is therefore recommended also in
this case either:</p><ul><li>using the default user-data serde <code>JacksonSerde</code> (from packages <code>com.arangodb:jackson-serde-json</code> or
<code>com.arangodb:jackson-serde-vpack</code>), or</li><li>providing a custom user-data serde implementation via <code>ArangoDB.Builder.serde(ArangoSerde)</code>.</li></ul><h2 id=removed-apis>Removed APIs <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#removed-apis class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The following client APIs have been removed:</p><ul><li>client APIs already deprecated in Java Driver version <code>6</code></li><li>client API to interact with deprecated server APIs:<ul><li><code>MMFiles</code> related APIs</li><li><code>ArangoDatabase.executeTraversal()</code></li><li><code>ArangoDB.getLogs()</code></li><li><code>minReplicationFactor</code> in collections and graphs</li><li><code>overwrite</code> flag in <code>DocumentCreateOptions</code></li><li><code>hash</code> and <code>skipList</code> indexes</li></ul></li></ul><p>The user-data custom serializer implementation <code>ArangoJack</code> has been removed in
favor of <code>com.arangodb.serde.jackson.JacksonSerde</code>.</p><p>Support for interpreting raw strings as JSON has been removed
(in favor of <code>com.arangodb.util.RawJson</code>).</p><p>Support of data type <code>com.arangodb.velocypack.VPackSlice</code> has been removed in
favor of Jackson type <code>com.fasterxml.jackson.databind.JsonNode</code> and its subclasses
(<code>ArrayNode</code>, <code>ObjectNode</code>, &mldr;). Raw <code>VPACK</code> data can now be used with
<code>com.arangodb.util.RawBytes</code>.</p><p>Support for custom initialization of cursors
(<code>ArangoDB._setCursorInitializer(ArangoCursorInitializer cursorInitializer)</code>)
has been removed.</p><h2 id=async-api>Async API <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#async-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>From version 7.2 onward, the driver provides a new asynchronous API.
Unlike in version 6, the asynchronous API is based on the same underlying driver
instance and therefore supports all the communication protocols and configurations
of the synchronous API. The asynchronous API is accessible via <code>ArangoDB#async()</code>,
for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ArangoDB</span> <span class=n>adb</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArangoDB</span><span class=o>.</span><span class=na>Builder</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>.</span><span class=na>build</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>ArangoDBAsync</span> <span class=n>adbAsync</span> <span class=o>=</span> <span class=n>adb</span><span class=o>.</span><span class=na>async</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>CompletableFuture</span><span class=o>&lt;</span><span class=n>ArangoDBVersion</span><span class=o>&gt;</span> <span class=n>version</span> <span class=o>=</span> <span class=n>adbAsync</span><span class=o>.</span><span class=na>getVersion</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></div><p>Under the hood, both synchronous and asynchronous API use the same internal
communication layer, which has been reworked and re-implemented in an
asynchronous way. The synchronous API blocks and waits for the result, while the
asynchronous one returns a <code>CompletableFuture&lt;></code> representing the pending
operation being performed.
Each asynchronous API method is equivalent to the corresponding synchronous
variant, except for the Cursor API.</p><h3 id=async-cursor-api>Async Cursor API <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#async-cursor-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The Cursor API (<code>ArangoCursor</code> and <code>ArangoCursorAsync</code>) is intrinsically different,
because the synchronous Cursor API is based on Java&rsquo;s <code>java.util.Iterator</code>, which
is an interface only suitable for synchronous scenarios.
On the other side, the asynchronous Cursor API provides a method
<code>com.arangodb.ArangoCursorAsync#nextBatch()</code>, which returns a
<code>CompletableFuture&lt;ArangoCursorAsync&lt;T>></code> and can be used to consume the next
batch of the cursor, for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>CompletableFuture</span><span class=o>&lt;</span><span class=n>ArangoCursorAsync</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=n>future1</span> <span class=o>=</span> <span class=n>adbAsync</span><span class=o>.</span><span class=na>db</span><span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>query</span><span class=o>(</span><span class=s>&#34;FOR i IN i..10000&#34;</span><span class=o>,</span> <span class=n>Integer</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>CompletableFuture</span><span class=o>&lt;</span><span class=n>ArangoCursorAsync</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=n>future2</span> <span class=o>=</span> <span class=n>future1</span>
</span></span><span class=line><span class=cl>        <span class=o>.</span><span class=na>thenCompose</span><span class=o>(</span><span class=n>c</span> <span class=o>-&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>batch</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=na>getResult</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// consume batch
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>return</span> <span class=n>c</span><span class=o>.</span><span class=na>nextBatch</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>});</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></div><h2 id=api-methods-changes>API methods changes <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#api-methods-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Before version 7.0, some CRUD API methods inferred the return type from the type
of the data object passed as input. Now, the return type can be explicitly set
for each CRUD API method. This type is used as deserialization target by the
user-data serde. In particular, no automatic type inference is performed anymore in:</p><ul><li><code>ArangoCollection.insertDocuments()</code></li><li><code>ArangoCollection.replaceDocuments()</code></li><li><code>ArangoCollection.updateDocuments()</code></li><li><code>ArangoCollection.deleteDocuments()</code></li></ul><p>Unless specified explicitly, the target deserialization type is <code>Void.class</code>,
thus allowing only <code>null</code> values.</p><p>CRUD operations operating with multiple documents have now an overloaded variant
which accepts raw data (<code>RawBytes</code> and <code>RawJson</code>) containing multiple documents.</p><p>CRUD operations operating with multiple documents with parametric types are now covariant:</p><ul><li><code>ArangoCollection.insertDocuments(Collection&lt;? extends T>, DocumentCreateOptions, Class&lt;T>)</code></li><li><code>ArangoCollection.replaceDocuments(Collection&lt;? extends T>, DocumentReplaceOptions, Class&lt;T>)</code></li></ul><p><code>com.arangodb.Request</code> and <code>com.arangodb.Response</code> classes have been refactored
to support generic body type. <code>ArangoDB.execute(Request&lt;T>, Class&lt;U>): Response&lt;U></code>
accepts now the target deserialization type for the response body.</p><p><code>com.arangodb.ArangoDBException</code> has been enhanced with the id of the request
causing it. This can be useful to correlate it with the debug level logs.</p><p>Graph API has been updated (#486):</p><ul><li>added <code>com.arangodb.ArangoEdgeCollection.drop()</code> and overloads</li><li>added <code>com.arangodb.ArangoVertexCollection.drop(VertexCollectionDropOptions)</code></li><li>updated <code>com.arangodb.ArangoGraph.replaceEdgeDefinition()</code></li></ul><p><code>ArangoDatabase.getDocument()</code> has been removed, in favor of <code>ArangoCollection.getDocument()</code>.</p><p><code>ArangoDatabase.query()</code> overloaded variants have now a different order of parameters:</p><ul><li><code>query(String query, Class&lt;T> type)</code></li><li><code>query(String query, Class&lt;T> type, AqlQueryOptions options)</code></li><li><code>query(String query, Class&lt;T> type, Map&lt;String,Object> bindVars)</code></li><li><code>query(String query, Class&lt;T> type, Map&lt;String,Object> bindVars, AqlQueryOptions options)</code></li></ul><p>The class <code>com.arangodb.DbName</code> has been removed. The database names can now be
passed as <code>String</code>. Support to UTF-8 characters in data definition names
(databases, collections, Views, indexes) has been added, see
<a href=/3.13/develop/drivers/java/#support-for-extended-naming-constraints class=link>Support for extended naming constraints</a>.</p><p>The name of <code>ArangoCollection</code> and <code>ArangoView</code> API classes are now final.
The related rename methods:</p><ul><li><code>com.arangodb.ArangoCollection.rename(String)</code></li><li><code>com.arangodb.ArangoView.rename(String)</code></li></ul><p>Do not change anymore the collection or view name of the instance of the related
API class on which it is invoked. To interact with the renamed collection, a new
instance of <code>ArangoCollection</code> with the new name must be created.</p><h2 id=api-entities>API entities <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#api-entities class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>All entities and options classes (in packages <code>com.arangodb.model</code> and
<code>com.arangodb.entity</code>) are now <code>final</code>.</p><p>The replication factor is now modeled with a new interface
(<code>com.arangodb.entity.ReplicationFactor</code>) with implementations:
<code>NumericReplicationFactor</code> and <code>SatelliteReplicationFactor</code>.</p><p>Cursor statistics are now in <code>com.arangodb.entity.CursorStats</code>.</p><h2 id=graalvm-native-image>GraalVM Native Image <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#graalvm-native-image class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The driver supports GraalVM Native Image compilation.
To compile with <code>--link-at-build-time</code> when <code>http-protocol</code> module is present in
the classpath, additional substitutions are be required for its transitive
dependencies (<code>Netty</code> and <code>Vert.x</code>). See this
<a href=https://github.com/arangodb/arangodb-java-driver/tree/main/test-functional/src/test-default/java/graal target=_blank rel="noopener noreferrer" class=link>example</a>&nbsp;<i class="fas fa-external-link-alt"></i>
for reference. Such substitutions are not required when compiling the shaded driver.</p><h3 id=framework-compatibility>Framework compatibility <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#framework-compatibility class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The driver can be used in the following frameworks that support
GraalVM Native Image generation:</p><ul><li><a href=https://quarkus.io target=_blank rel="noopener noreferrer" class=link>Quarkus</a>&nbsp;<i class="fas fa-external-link-alt"></i>, see <a href=https://github.com/arangodb-helper/arango-quarkus-native-example target=_blank rel="noopener noreferrer" class=link>arango-quarkus-native-example</a>&nbsp;<i class="fas fa-external-link-alt"></i></li><li><a href=https://helidon.io target=_blank rel="noopener noreferrer" class=link>Helidon</a>&nbsp;<i class="fas fa-external-link-alt"></i>, see <a href=https://github.com/arangodb-helper/arango-helidon-native-example target=_blank rel="noopener noreferrer" class=link>arango-helidon-native-example</a>&nbsp;<i class="fas fa-external-link-alt"></i></li><li><a href=https://micronaut.io target=_blank rel="noopener noreferrer" class=link>Micronaut</a>&nbsp;<i class="fas fa-external-link-alt"></i>, see <a href=https://github.com/arangodb-helper/arango-micronaut-native-example target=_blank rel="noopener noreferrer" class=link>arango-micronaut-native-example</a>&nbsp;<i class="fas fa-external-link-alt"></i></li></ul><h2 id=migration>Migration <a href=/3.13/develop/drivers/java/reference-version-7/changes-in-version-7/#migration class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To migrate your existing project to Java Driver version 7.0, it is recommended
first updating to the latest version of branch <code>6</code> and make sure that your code
does not use any deprecated API. This can be done by checking the presence of
deprecation warnings in the Java compiler output.</p><p>The deprecation notes in the related JavaDoc contain information about the
reason of the deprecation and suggest migration alternatives to use.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/develop/drivers/java/reference-version-7/serialization/><i class="fas fa-chevron-left fa-fw"></i><p>Serialization</p></a></span><span class=next></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/develop/drivers/java/reference-version-7/changes-in-version-7.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#maven-setup>Maven Setup</a></div><div class=level-2><a href=#gradle-setup>Gradle Setup</a></div><div class=level-2><a href=#http-client>HTTP client</a></div><div class=level-2><a href=#configuration-changes>Configuration changes</a></div><div class=level-2><a href=#modules>Modules</a></div><div class=level-2><a href=#transitive-dependencies>Transitive dependencies</a></div><div class=level-2><a href=#user-data>User Data</a></div><div class=level-2><a href=#serialization--deserialization>Serialization / Deserialization</a></div><div class=level-2><a href=#arangodb-java-driver-shaded>ArangoDB Java Driver Shaded</a></div><div class=level-2><a href=#removed-apis>Removed APIs</a></div><div class=level-2><a href=#async-api>Async API</a></div><div class=level-3><a href=#async-cursor-api>Async Cursor API</a></div><div class=level-2><a href=#api-methods-changes>API methods changes</a></div><div class=level-2><a href=#api-entities>API entities</a></div><div class=level-2><a href=#graalvm-native-image>GraalVM Native Image</a></div><div class=level-3><a href=#framework-compatibility>Framework compatibility</a></div><div class=level-2><a href=#migration>Migration</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>