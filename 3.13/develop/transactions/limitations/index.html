<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1747031427></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta property="og:url" content="http://localhost/3.13/develop/transactions/limitations/"><meta property="og:title" content="Limitations of transactions"><meta property="og:type" content="website"><meta property="og:description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta name=docsearch:version content="3.13"><title>Limitations of transactions | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1747031427 defer></script>
<script src=/js/featherlight.min.js?1747031427 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1747031427 defer></script>
<script src=/js/theme.js?1747031427 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Develop"><a itemprop=item class=link href=/3.13/develop/><span itemprop=name class=breadcrumb-entry>Develop</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Transactions"><a itemprop=item class=link href=/3.13/develop/transactions/><span itemprop=name class=breadcrumb-entry>Transactions</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Limitations"><a itemprop=item class=link href=/3.13/develop/transactions/limitations/><span itemprop=name class=breadcrumb-entry>Limitations</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Limitations of transactions</h1></hgroup><h2 id=in-general>In General <a href=/3.13/develop/transactions/limitations/#in-general class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Transactions in ArangoDB have been designed with particular use cases
in mind. They will be mainly useful for <em>short and small</em> data retrieval
and/or modification operations.</p><p>The implementation is <strong>not</strong> optimized for <em>very long-running</em> or <em>very voluminous</em>
operations, and may not be usable for these cases.</p><p>One limitation is that a transaction operation information must fit into main
memory. The transaction information consists of record pointers, revision numbers
and rollback information. The actual data modification operations of a transaction
are written to the write-ahead log and do not need to fit entirely into main
memory.</p><p>Ongoing transactions will also prevent the write-ahead logs from being fully
garbage-collected. Information in the write-ahead log files cannot be written
to collection data files or be discarded while transactions are ongoing.</p><p>To ensure progress of the write-ahead log garbage collection, transactions should
be kept as small as possible, and big transactions should be split into multiple
smaller transactions.</p><p>Transactions in ArangoDB cannot be nested, i.e. a transaction must not start another
transaction. If an attempt is made to call a transaction from inside a running
transaction, the server will throw error <em>1651 (nested transactions detected)</em>.</p><p>It is also disallowed to execute user transaction on some of ArangoDB&rsquo;s own system
collections. This shouldn&rsquo;t be a problem for regular usage as system collections will
not contain user data and there is no need to access them from within a user
transaction.</p><p>Some operations are not allowed inside transactions in general:</p><ul><li>creation and deletion of databases (<code>db._createDatabase()</code>, <code>db._dropDatabase()</code>)</li><li>creation and deletion of collections (<code>db._create()</code>, <code>db._drop()</code>, <code>db.&lt;collection>.rename()</code>)</li><li>creation and deletion of indexes (<code>db.&lt;collection>.ensureIndex()</code>, <code>db.&lt;collection>.dropIndex()</code>)</li></ul><p>If an attempt is made to carry out any of these operations during a transaction,
ArangoDB will abort the transaction with error code <em>1653 (disallowed operation inside
transaction)</em>.</p><p>Finally, all collections that may be modified during a transaction must be
declared beforehand, i.e. using the <em>collections</em> attribute of the object passed
to the <em>_executeTransaction</em> function. If any attempt is made to carry out a data
modification operation on a collection that was not declared in the <em>collections</em>
attribute, the transaction will be aborted and ArangoDB will throw error <em>1652
unregistered collection used in transaction</em>.
It is legal to not declare read-only collections, but this should be avoided if
possible to reduce the probability of deadlocks and non-repeatable reads.</p><h2 id=in-clusters>In Clusters <a href=/3.13/develop/transactions/limitations/#in-clusters class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Using a single instance of ArangoDB (or a OneShard database in a
cluster), multi-document / multi-collection queries are guaranteed to be
fully ACID in the
<a href=https://en.wikipedia.org/wiki/ACID_%28computer_science%29 target=_blank rel="noopener noreferrer" class=link>traditional sense</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
For more details see
<a href=/3.13/develop/operational-factors/#operation-atomicity class=link>Operation Atomicity</a>
and
<a href=/3.13/develop/operational-factors/#transactional-isolation class=link>Transactional Isolation</a>.
This is more than many other NoSQL database systems support.
In cluster mode, single-document operations are also <em>fully ACID</em>.</p><p>Multi-document / multi-collection queries and transactions offer different guarantees.
Understanding these differences is important when designing applications that need
to be resilient against outages of individual servers.</p><p>Cluster transactions share the underlying characteristics of the
<a href=/3.13/components/arangodb-server/storage-engine/ class=link>storage engine</a> that is used for the cluster deployment.
A transaction started on a Coordinator translates to one transaction per involved DB-Server.
The guarantees and characteristics of the given storage-engine apply additionally
to the cluster specific information below.
Please refer to <a href=/3.13/develop/transactions/locking-and-isolation/ class=link>Locking and Isolation</a> for more details
on the storage-engines.</p><h3 id=atomicity>Atomicity <a href=/3.13/develop/transactions/limitations/#atomicity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>A transaction on <em>one DB-Server</em> is either committed completely or not at all.</p><p>ArangoDB transactions do currently not require any form of global consensus. This makes
them relatively fast, but also vulnerable to unexpected server outages.</p><p>Should a transaction involve <a href=/3.13/deploy/cluster/#db-servers class=link>Leader Shards</a>
on <em>multiple DB-Servers</em>, the atomicity of the distributed transaction <em>during the commit operation</em>
cannot be guaranteed. Should one of the involved DB-Servers fail during the commit the transaction
is not rolled-back globally, sub-transactions may have been committed on some DB-Servers, but not on others.
Should this case occur the client application will see an error.</p><p>An improved failure handling issue might be introduced in future versions.</p><h3 id=consistency>Consistency <a href=/3.13/develop/transactions/limitations/#consistency class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>We provide consistency even in the cluster, a transaction will never leave the data in
an incorrect or corrupt state.</p><p>In ArangoDB there is always exactly one DB-Server responsible for a given shard. In both
Storage-Engines the locking procedures ensure that dependent transactions (in the sense that
the transactions modify the same documents or unique index entries) are ordered sequentially.
Therefore we can provide <a href=https://en.wikipedia.org/wiki/Consistency_model#Causal_consistency target=_blank rel="noopener noreferrer" class=link>Causal-Consistency</a>&nbsp;<i class="fas fa-external-link-alt"></i>
for your transactions.</p><p>From the applications point-of-view this also means that a given transaction can always
<a href=https://en.wikipedia.org/wiki/Consistency_model#Read-your-writes_consistency target=_blank rel="noopener noreferrer" class=link>read it&rsquo;s own writes</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
Other concurrent operations will not change the database state seen by a transaction.</p><h3 id=isolation>Isolation <a href=/3.13/develop/transactions/limitations/#isolation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The ArangoDB Cluster provides <em>Local Snapshot Isolation</em>. This means that all operations
and queries in the transactions will see the same version, or snapshot, of the data on a given
DB-Server. This snapshot is based on the state of the data at the moment in
time when the transaction begins <em>on that DB-Server</em>.</p><h3 id=durability>Durability <a href=/3.13/develop/transactions/limitations/#durability class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>It is guaranteed that successfully committed transactions are persistent. Using
replication and / or <em>waitForSync</em> increases the durability (Just as with the single-server).</p><h2 id=size-and-time-limits>Size and time limits <a href=/3.13/develop/transactions/limitations/#size-and-time-limits class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=intermediate-commits>Intermediate commits <a href=/3.13/develop/transactions/limitations/#intermediate-commits class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><a href=/3.13/aql/fundamentals/limitations/#storage-engine-properties class=link>Intermediate commits</a>
that would automatically split and commit parts of big transactions are <strong>disabled</strong>
for JavaScript Transactions and Stream Transactions in the RocksDB storage engine,
including AQL queries that run inside of such transactions.</p><h3 id=limits-for-stream-transactions>Limits for Stream transactions <a href=/3.13/develop/transactions/limitations/#limits-for-stream-transactions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>A maximum lifetime and transaction size for Stream Transactions is enforced
on the Coordinator to ensure that abandoned transactions cannot block the
cluster from operating properly:</p><ul><li>Maximum idle timeout of up to <strong>120 seconds</strong> between operations</li><li>Maximum transaction size of <strong>128 MB</strong> per DB-Server</li></ul><p>These limits are also enforced for Stream Transactions on single servers.</p><p>The default maximum idle timeout is <strong>60 seconds</strong> between operations in a
single Stream Transaction. The maximum value can be bumped up to at most 120
seconds by setting the startup option <code>--transaction.streaming-idle-timeout</code>.
Posting an operation into a non-expired Stream Transaction will reset the
transaction&rsquo;s timeout to the configured idle timeout.</p><p>Enforcing the limit is useful to free up resources used by abandoned
transactions, for example from transactions that are abandoned by client
applications due to programming errors or that were left over because client
connections were interrupted.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/develop/transactions/durability/><i class="fas fa-chevron-left fa-fw"></i><p>Durability</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/develop/foxx-microservices/><p>Foxx Microservices</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/develop/transactions/limitations.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#in-general>In General</a></div><div class=level-2><a href=#in-clusters>In Clusters</a></div><div class=level-3><a href=#atomicity>Atomicity</a></div><div class=level-3><a href=#consistency>Consistency</a></div><div class=level-3><a href=#isolation>Isolation</a></div><div class=level-3><a href=#durability>Durability</a></div><div class=level-2><a href=#size-and-time-limits>Size and time limits</a></div><div class=level-3><a href=#intermediate-commits>Intermediate commits</a></div><div class=level-3><a href=#limits-for-stream-transactions>Limits for Stream transactions</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>