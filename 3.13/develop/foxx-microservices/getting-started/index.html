<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1747031427></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta property="og:url" content="http://localhost/3.13/develop/foxx-microservices/getting-started/"><meta property="og:title" content="Getting Started"><meta property="og:type" content="website"><meta property="og:description" content="ArangoDB is a scalable graph database system with native support for other data models and a built-in search engine, for the cloud and on-premises"><meta name=docsearch:version content="3.13"><title>Getting Started | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1747031427 defer></script>
<script src=/js/featherlight.min.js?1747031427 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1747031427 defer></script>
<script src=/js/theme.js?1747031427 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Develop"><a itemprop=item class=link href=/3.13/develop/><span itemprop=name class=breadcrumb-entry>Develop</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Foxx Microservices"><a itemprop=item class=link href=/3.13/develop/foxx-microservices/><span itemprop=name class=breadcrumb-entry>Foxx Microservices</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Getting started"><a itemprop=item class=link href=/3.13/develop/foxx-microservices/getting-started/><span itemprop=name class=breadcrumb-entry>Getting started</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Getting Started</h1></hgroup><p>This practical introduction will take you from an empty folder to a first
Foxx service installed in ArangoDB, with custom endpoints which can handle
user input and query the database.</p><p>A video guide is also available:</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src="https://www.youtube-nocookie.com/embed/videoseries?list=PL0tn-TSss6NV45d1HnLA57VJFH6h1SeH7" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen></iframe></div><h2 id=manifest>Manifest <a href=/3.13/develop/foxx-microservices/getting-started/#manifest class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>We&rsquo;re going to start with an empty folder. This will be the root folder of our
services. You can name it something clever but for the course of this guide
we&rsquo;ll assume it&rsquo;s called the name of your service: <code>getting-started</code>.</p><p>First we need to create a manifest. Create a new file called <code>manifest.json</code>
and add the following content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;engines&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;arangodb&#34;</span><span class=p>:</span> <span class=s2>&#34;^3.0.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This just tells ArangoDB the service is compatible with versions 3.0.0 and
later (all the way up to but not including 4.0.0), allowing older versions
of ArangoDB to understand that this service likely won&rsquo;t work for them and
newer versions what behavior to emulate should they still support it.</p><p>The little hat to the left of the version number is not a typo, it&rsquo;s called a
&ldquo;caret&rdquo; and indicates the version range. Foxx uses semantic versioning (also
called &ldquo;semver&rdquo;) for most of its version handling. You can find out more about
how semver works at the <a href=http://semver.org target=_blank rel="noopener noreferrer" class=link>official semver website</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</p><p>Next we&rsquo;ll need to specify an entry point to our service. This is the
JavaScript file that will be executed to define our service&rsquo;s HTTP endpoints.
We can do this by adding a &ldquo;main&rdquo; field to our manifest:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;engines&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;arangodb&#34;</span><span class=p>:</span> <span class=s2>&#34;^3.0.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;main&#34;</span><span class=p>:</span> <span class=s2>&#34;index.js&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>That&rsquo;s all we need in our manifest for now.</p><h2 id=router>Router <a href=/3.13/develop/foxx-microservices/getting-started/#router class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Let&rsquo;s next create the <code>index.js</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>createRouter</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@arangodb/foxx/router&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>createRouter</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>context</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>router</span><span class=p>);</span></span></span></code></pre></div><p>The first line causes our file to be interpreted using
<a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode target=_blank rel="noopener noreferrer" class=link>strict mode</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
All examples in the ArangoDB documentation assume strict mode, so you might
want to familiarize yourself with it if you haven&rsquo;t encountered it before.</p><p>The second line imports the <code>@arangodb/foxx/router</code> module which provides a
function for creating new Foxx routers. We&rsquo;re using this function to create a
new <code>router</code> object which we&rsquo;ll be using for our service.</p><p>The <code>module.context</code> is the so-called Foxx context or service context.
This variable is available in all files that are part of your Foxx service and
provides access to Foxx APIs specific to the current service, like the <code>use</code>
method, which tells Foxx to mount the <code>router</code> in this service (and to expose
its routes to HTTP).</p><p>Next let&rsquo;s define a route that prints a generic greeting:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// continued
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/hello-world&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=s1>&#39;Hello World!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>([</span><span class=s1>&#39;text/plain&#39;</span><span class=p>],</span> <span class=s1>&#39;A generic greeting.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Generic greeting&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Prints a generic greeting.&#39;</span><span class=p>);</span></span></span></code></pre></div><p>The <code>router</code> provides the methods <code>get</code>, <code>post</code>, etc corresponding to each
HTTP verb as well as the catch-all <code>all</code>. These methods indicate that the given
route should be used to handle incoming requests with the given HTTP verb
(or any method when using <code>all</code>).</p><p>These methods take an optional path (if omitted, it defaults to <code>"/"</code>) as well
as a request handler, which is a function taking the <code>req</code>
(<a href=/3.13/develop/foxx-microservices/reference/routers/request/ class=link>request</a>) and <code>res</code>
(<a href=/3.13/develop/foxx-microservices/reference/routers/response/ class=link>response</a>) objects to handle the incoming
request and generate the outgoing response. If you have used the express
framework in Node.js, you may already be familiar with how this works,
otherwise check out the chapter on <a href=/3.13/develop/foxx-microservices/reference/routers/endpoints/ class=link>routes</a>.</p><p>The object returned by the router&rsquo;s methods provides additional methods to
attach metadata and validation to the route. We&rsquo;re using <code>summary</code> and
<code>description</code> to document what the route does – these aren&rsquo;t strictly
necessary but give us some nice auto-generated documentation.
The <code>response</code> method lets us additionally document the response content
type and what the response body will represent.</p><h2 id=try-it-out>Try it out <a href=/3.13/develop/foxx-microservices/getting-started/#try-it-out class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Follow these steps to install your service:</p><ol><li>Create a zip archive from the service folder.</li><li>In the web interface, navigate to the <strong>Services</strong> section.</li><li>Click <strong>Add Service</strong> and go to the <strong>Upload</strong> tab.</li><li>Drag and drop the zip archive in the area of the <strong>Upload</strong> button or click
it to use the file chooser.</li><li>Wait for the upload to complete, then click <strong>Install</strong>.</li><li>A dialog opens. You need to provide a <strong>Mount point</strong>, which is the URL prefix
at which the service is made available (e.g. <code>/getting-started</code>).</li><li>Click <strong>Install</strong>. The dialog disappears and the service shows up in the
list of services.</li></ol><p>You can try out your service using the interactive Swagger UI:</p><ol><li>Click the mount point or the row of your service to open the service&rsquo;s details.</li><li>Go to the <strong>API</strong> tab for the API documentation. You should see the route we
defined earlier (<code>/hello-world</code>) with the word <code>GET</code> next to it, indicating
the HTTP method it supports, and the <code>summary</code> we provided on the right.</li><li>Click the route&rsquo;s path to expand the details for this endpoint.
The <code>description</code> we provided appears in the generated documentation
as well as the description we added to the <code>response</code> (which should correctly
indicate the content type <code>text/plain</code>, i.e. plain text).</li><li>Click <strong>Try it out</strong> and then <strong>Execute</strong> to send a request to the endpoint.
You can see the equivalent cURL command for the request as well as the
service&rsquo;s response: <code>Hello World!</code>.</li></ol><p>Congratulations! You have just created, installed, and used your first Foxx service.</p><h2 id=parameter-validation>Parameter validation <a href=/3.13/develop/foxx-microservices/getting-started/#parameter-validation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Let&rsquo;s add another route that provides a more personalized greeting:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// continued
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>joi</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;joi&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/hello/:name&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=sb>`Hello </span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>pathParams</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>pathParam</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>string</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Name to greet.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>([</span><span class=s1>&#39;text/plain&#39;</span><span class=p>],</span> <span class=s1>&#39;A personalized greeting.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Personalized greeting&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Prints a personalized greeting.&#39;</span><span class=p>);</span></span></span></code></pre></div><p>The first line imports the <a href=https://www.npmjs.com/package/joi target=_blank rel="noopener noreferrer" class=link><code>joi</code> module from npm</a>&nbsp;<i class="fas fa-external-link-alt"></i>
which comes bundled with ArangoDB. Joi is a validation library that is used
throughout Foxx to define schemas and parameter types.</p><p><strong>Note</strong>: You can bundle your own modules from npm by installing them in your
service folder and making sure the <code>node_modules</code> folder is included in your
zip archive. For more information see the chapter on
<a href=/3.13/develop/foxx-microservices/guides/using-node-modules/ class=link>bundling node modules</a>.</p><p>The <code>pathParam</code> method allows us to specify parameters we are expecting in
the path. The first argument corresponds to the parameter name in the path,
the second argument is a joi schema the parameter is expected to match and
the final argument serves to describe the parameter in the API documentation.</p><p>The path parameters are accessible from the <code>pathParams</code> property of the
request object. We&rsquo;re using a template string to generate the server&rsquo;s
response containing the parameter&rsquo;s value.</p><p>Note that routes with path parameters that fail to validate for the request URL
will be skipped as if they wouldn&rsquo;t exist. This allows you to define multiple
routes that are only distinguished by the schemas of their path parameters (e.g.
a route taking only numeric parameters and one taking any string as a fallback).</p><p>Let&rsquo;s take this further and create a route that takes a JSON request body:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// continued
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/sum&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>values</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>values</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>result</span><span class=o>:</span> <span class=nx>values</span><span class=p>.</span><span class=nx>reduce</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>body</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>values</span><span class=o>:</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>array</span><span class=p>().</span><span class=nx>items</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>number</span><span class=p>().</span><span class=nx>required</span><span class=p>()).</span><span class=nx>required</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Values to add together.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>result</span><span class=o>:</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>number</span><span class=p>().</span><span class=nx>required</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Sum of the input values.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Add up numbers&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Calculates the sum of an array of number values.&#39;</span><span class=p>);</span></span></span></code></pre></div><p>Note that we used <code>post</code> to define this route instead of <code>get</code> (which does not
support request bodies). Trying to send a GET request to this route&rsquo;s URL
(in the absence of a <code>get</code> route for the same path) will result in Foxx
responding with an appropriate error response, indicating the supported
HTTP methods.</p><p>As this route not only expects a JSON object as input but also responds with
a JSON object as output we need to define two schemas. We don&rsquo;t strictly need
a response schema but it helps documenting what the route should be expected
to respond with and will show up in the API documentation.</p><p>Because we&rsquo;re passing a schema to the <code>response</code> method we don&rsquo;t need to
explicitly tell Foxx we are sending a JSON response. The presence of a schema
in the absence of a content type always implies we want JSON. Though we could
just add <code>["application/json"]</code> as an additional argument after the schema if
we wanted to make this more explicit.</p><p>The <code>body</code> method works the same way as the <code>response</code> method except the schema
will be used to validate the request body. If the request body can&rsquo;t be parsed
as JSON or doesn&rsquo;t match the schema, Foxx will reject the request with an
appropriate error response.</p><h2 id=creating-collections>Creating collections <a href=/3.13/develop/foxx-microservices/getting-started/#creating-collections class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The real power of Foxx comes from interacting with the database itself.
In order to be able to use a collection from within our service, we should
first make sure that the collection actually exists. The right place to create
collections your service is going to use is in
<a href=/3.13/develop/foxx-microservices/guides/scripts-and-scheduling/ class=link>a <em>setup</em> script</a>, which Foxx will execute for you when
installing or updating the service.</p><p>First create a new folder called &ldquo;scripts&rdquo; in the service folder, which will
be where our scripts are going to live. For simplicity&rsquo;s sake, our setup
script will live in a file called <code>setup.js</code> inside that folder:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@arangodb&#39;</span><span class=p>).</span><span class=nx>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>collectionName</span> <span class=o>=</span> <span class=s1>&#39;myFoxxCollection&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>db</span><span class=p>.</span><span class=nx>_collection</span><span class=p>(</span><span class=nx>collectionName</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>db</span><span class=p>.</span><span class=nx>_createDocumentCollection</span><span class=p>(</span><span class=nx>collectionName</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>The script uses the <a href=/3.13/develop/javascript-api/@arangodb/db-object/ class=link><code>db</code> object</a> from
the <code>@arangodb</code> module, which lets us interact with the database the Foxx
service was installed in and the collections inside that database. Because the
script may be executed multiple times (i.e. whenever we update the service or
when the server is restarted) we need to make sure we don&rsquo;t accidentally try
to create the same collection twice (which would result in an exception);
we do that by first checking whether it already exists before creating it.</p><p>The <code>_collection</code> method looks up a collection by name and returns <code>null</code> if no
collection with that name was found. The <code>_createDocumentCollection</code> method
creates a new document collection by name (<code>_createEdgeCollection</code> also exists
and works analogously for edge collections).</p><p><strong>Note</strong>: Because we have hardcoded the collection name, multiple copies of
the service installed alongside each other in the same database will share
the same collection.
Because this may not always be what you want, the <a href=/3.13/develop/foxx-microservices/reference/service-context/ class=link>Foxx context</a>
also provides the <code>collectionName</code> method which applies a mount point specific
prefix to any given collection name to make it unique to the service. It also
provides the <code>collection</code> method, which behaves almost exactly like <code>db._collection</code>
except it also applies the prefix before looking the collection up.</p><p>Next we need to tell our service about the script by adding it to the manifest file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;engines&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;arangodb&#34;</span><span class=p>:</span> <span class=s2>&#34;^3.0.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;main&#34;</span><span class=p>:</span> <span class=s2>&#34;index.js&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;setup&#34;</span><span class=p>:</span> <span class=s2>&#34;scripts/setup.js&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The only thing that has changed is that we added a &ldquo;scripts&rdquo; field specifying
the path of the setup script we just wrote.</p><p>Go back to the web interface and update the service with our new code, then
check the <em>Collections</em> tab. If everything worked right, you should see a new
collection called &ldquo;myFoxxCollection&rdquo;.</p><h2 id=accessing-collections>Accessing collections <a href=/3.13/develop/foxx-microservices/getting-started/#accessing-collections class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Let&rsquo;s expand our service by adding a few more routes to our <code>index.js</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// continued
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@arangodb&#39;</span><span class=p>).</span><span class=nx>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>errors</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@arangodb&#39;</span><span class=p>).</span><span class=nx>errors</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>foxxColl</span> <span class=o>=</span> <span class=nx>db</span><span class=p>.</span><span class=nx>_collection</span><span class=p>(</span><span class=s1>&#39;myFoxxCollection&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>DOC_NOT_FOUND</span> <span class=o>=</span> <span class=nx>errors</span><span class=p>.</span><span class=nx>ERROR_ARANGO_DOCUMENT_NOT_FOUND</span><span class=p>.</span><span class=nx>code</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/entries&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>meta</span> <span class=o>=</span> <span class=nx>foxxColl</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>meta</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>body</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Entry to store in the collection.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Entry stored in the collection.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Store an entry&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Stores an entry in the &#34;myFoxxCollection&#34; collection.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/entries/:key&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>foxxColl</span><span class=p>.</span><span class=nb>document</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>pathParams</span><span class=p>.</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>e</span><span class=p>.</span><span class=nx>isArangoError</span> <span class=o>||</span> <span class=nx>e</span><span class=p>.</span><span class=nx>errorNum</span> <span class=o>!==</span> <span class=nx>DOC_NOT_FOUND</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=nx>e</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=k>throw</span><span class=p>(</span><span class=mi>404</span><span class=p>,</span> <span class=s1>&#39;The entry does not exist&#39;</span><span class=p>,</span> <span class=nx>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>pathParam</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>string</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Key of the entry.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;Entry stored in the collection.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Retrieve an entry&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Retrieves an entry from the &#34;myFoxxCollection&#34; collection by key.&#39;</span><span class=p>);</span></span></span></code></pre></div><p>We&rsquo;re using the <code>save</code> and <code>document</code> methods of the collection object to store
and retrieve documents in the collection we created in our setup script.
Because we don&rsquo;t care what the documents look like we allow any attributes on
the request body and just accept an object.</p><p>Because the key will be automatically generated by ArangoDB when one wasn&rsquo;t
specified in the request body, we&rsquo;re using <code>Object.assign</code> to apply the
attributes of the metadata object returned by the <code>save</code> method to the document
before returning it from our first route.</p><p>The <code>document</code> method returns a document in a collection by its <code>_key</code> or <code>_id</code>.
However when no matching document exists it throws an <code>ArangoError</code> exception.
Because we want to provide a more descriptive error message than ArangoDB does
out of the box, we need to handle that error explicitly.</p><p>All <code>ArangoError</code> exceptions have a truthy attribute <code>isArangoError</code> that helps
you recognizing these errors without having to worry about <code>instanceof</code> checks.
They also provide an <code>errorNum</code> and an <code>errorMessage</code>. If you want to check for
specific errors you can just import the <code>errors</code> object from the <code>@arangodb</code>
module instead of having to memorize numeric error codes.</p><p>Instead of defining our own response logic for the error case we just use
<code>res.throw</code>, which makes the response object throw an exception Foxx can
recognize and convert to the appropriate server response. We also pass along
the exception itself so Foxx can provide more diagnostic information when we
want it to.</p><p>We could extend the post route to support arrays of objects as well, each
object following a certain schema:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// store schema in variable to make it re-usable, see .body()
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>docSchema</span> <span class=o>=</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>().</span><span class=nx>keys</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>string</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=nx>joi</span><span class=p>.</span><span class=nx>number</span><span class=p>().</span><span class=nx>required</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>unknown</span><span class=p>();</span> <span class=c1>// allow additional attributes
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/entries&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>multiple</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>isArray</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=nx>multiple</span> <span class=o>?</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span> <span class=o>:</span> <span class=p>[</span><span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>data</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>doc</span> <span class=k>of</span> <span class=nx>body</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>meta</span> <span class=o>=</span> <span class=nx>foxxColl</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>doc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nb>Object</span><span class=p>.</span><span class=nx>assign</span><span class=p>(</span><span class=nx>doc</span><span class=p>,</span> <span class=nx>meta</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>multiple</span> <span class=o>?</span> <span class=nx>data</span> <span class=o>:</span> <span class=nx>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>body</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>alternatives</span><span class=p>().</span><span class=k>try</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>docSchema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>joi</span><span class=p>.</span><span class=nx>array</span><span class=p>().</span><span class=nx>items</span><span class=p>(</span><span class=nx>docSchema</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>),</span> <span class=s1>&#39;Entry or entries to store in the collection.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>alternatives</span><span class=p>().</span><span class=k>try</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=nx>joi</span><span class=p>.</span><span class=nx>array</span><span class=p>().</span><span class=nx>items</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>object</span><span class=p>().</span><span class=nx>required</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>),</span> <span class=s1>&#39;Entry or entries stored in the collection.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;Store entry or entries&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Store a single entry or multiple entries in the &#34;myFoxxCollection&#34; collection.&#39;</span><span class=p>);</span></span></span></code></pre></div><h2 id=writing-database-queries>Writing database queries <a href=/3.13/develop/foxx-microservices/getting-started/#writing-database-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Storing and retrieving entries is fine, but right now we have to memorize each
key when we create an entry. Let&rsquo;s add a route that gives us a list of the
keys of all entries so we can use those to look an entry up in detail.</p><p>The naïve approach would be to use the <code>toArray()</code> method to convert the entire
collection to an array and just return that. But we&rsquo;re only interested in the
keys and there might potentially be so many entries that first retrieving every
single document might get unwieldy. Let&rsquo;s write a short AQL query to do this instead:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// continued
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>aql</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@arangodb&#39;</span><span class=p>).</span><span class=nx>aql</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/entries&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>keys</span> <span class=o>=</span> <span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span><span class=nx>aql</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    FOR entry IN </span><span class=si>${</span><span class=nx>foxxColl</span><span class=si>}</span><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>    RETURN entry._key
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>keys</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>response</span><span class=p>(</span><span class=nx>joi</span><span class=p>.</span><span class=nx>array</span><span class=p>().</span><span class=nx>items</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>joi</span><span class=p>.</span><span class=nx>string</span><span class=p>().</span><span class=nx>required</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>).</span><span class=nx>required</span><span class=p>(),</span> <span class=s1>&#39;List of entry keys.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>summary</span><span class=p>(</span><span class=s1>&#39;List entry keys&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nx>description</span><span class=p>(</span><span class=s1>&#39;Assembles a list of keys of entries in the collection.&#39;</span><span class=p>);</span></span></span></code></pre></div><p>Here we&rsquo;re using two new things:</p><p>The <code>_query</code> method executes an AQL query in the active database.</p><p>The <code>aql</code> template string handler allows us to write multi-line AQL queries and
also handles query parameters and collection names. Instead of hardcoding the
name of the collection we want to use in the query we can simply reference the
<code>foxxColl</code> variable we defined earlier – it recognizes the value as an ArangoDB
collection object and knows we are specifying a collection rather than a regular
value even though AQL distinguishes between the two.</p><p><strong>Note</strong>: If you aren&rsquo;t used to JavaScript template strings and template string
handlers just think of <code>aql</code> as a function that receives the multiline string
split at every <code>${}</code> expression as well as an array of the values of those
expressions – that&rsquo;s actually all there is to it.</p><p>Alternatively, here&rsquo;s a version without template strings (notice how much
cleaner the <code>aql</code> version will be in comparison when you have multiple variables):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>keys</span> <span class=o>=</span> <span class=nx>db</span><span class=p>.</span><span class=nx>_query</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;FOR entry IN @@coll RETURN entry._key&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span><span class=s1>&#39;@coll&#39;</span><span class=o>:</span> <span class=nx>foxxColl</span><span class=p>.</span><span class=nx>name</span><span class=p>()}</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></div><h2 id=next-steps>Next steps <a href=/3.13/develop/foxx-microservices/getting-started/#next-steps class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>You now know how to create a Foxx service from scratch, how to handle user
input and how to access the database from within your Foxx service to store,
retrieve and query data you store inside ArangoDB. This should allow you to
build meaningful APIs for your own applications but there are many more things
you can do with Foxx. See the <a href=/3.13/develop/foxx-microservices/guides/ class=link>Guides</a> chapter for more.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/develop/foxx-microservices/><i class="fas fa-chevron-left fa-fw"></i><p>Foxx Microservices</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/develop/foxx-microservices/guides/><p>Guides</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/develop/foxx-microservices/getting-started.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#manifest>Manifest</a></div><div class=level-2><a href=#router>Router</a></div><div class=level-2><a href=#try-it-out>Try it out</a></div><div class=level-2><a href=#parameter-validation>Parameter validation</a></div><div class=level-2><a href=#creating-collections>Creating collections</a></div><div class=level-2><a href=#accessing-collections>Accessing collections</a></div><div class=level-2><a href=#writing-database-queries>Writing database queries</a></div><div class=level-2><a href=#next-steps>Next steps</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>