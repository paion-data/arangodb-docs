<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Loosely match strings to find partial congruences and to compensate for typing errors"><meta property="og:url" content="http://localhost/3.13/index-and-search/arangosearch/fuzzy-search/"><meta property="og:title" content="Fuzzy Search with ArangoSearch"><meta property="og:type" content="website"><meta property="og:description" content="Loosely match strings to find partial congruences and to compensate for typing errors"><meta name=docsearch:version content="3.13"><title>Fuzzy Search with ArangoSearch | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Index and Search"><a itemprop=item class=link href=/3.13/index-and-search/><span itemprop=name class=breadcrumb-entry>Index and Search</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="ArangoSearch"><a itemprop=item class=link href=/3.13/index-and-search/arangosearch/><span itemprop=name class=breadcrumb-entry>ArangoSearch</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Fuzzy search"><a itemprop=item class=link href=/3.13/index-and-search/arangosearch/fuzzy-search/><span itemprop=name class=breadcrumb-entry>Fuzzy search</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Fuzzy Search with ArangoSearch</h1><p class=lead>Loosely match strings to find partial congruences and to compensate for typing errors</p></hgroup><p>Fuzzy search is an umbrella term for various approximate matching algorithms.
What they allow you to do is to find matches even if the search terms are not
spelled exactly like the words in the stored text. This includes terms that
are similar, alternatively spelled, or mistyped but potentially relevant for
the search request as well.</p><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text>If you want to try out fuzzy search with ArangoDB for yourself, then check out
our interactive
<a href=https://colab.research.google.com/github/arangodb/interactive_tutorials/blob/master/notebooks/FuzzySearch.ipynb target=_blank rel="noopener noreferrer" class=link>Fuzzy Search tutorial</a>&nbsp;<i class="fas fa-external-link-alt"></i>.</div></div></div></div><h2 id=similarity-measures>Similarity Measures <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#similarity-measures class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>How the approximate string matching algorithms usually work is that they
measure how similar (or different) two strings are. The following similarity
measures are available in ArangoDB:</p><ul><li><strong>Levenshtein distance</strong> and a variant called Damerau-Levenshtein distance,
which work best with short strings</li><li><strong><em>n</em>-gram similarity</strong> and a variant called positional <em>n</em>-gram similarity,
that are well-suited to assess the similarity of longer strings that share
subsequences</li></ul><h3 id=levenshtein-distance>Levenshtein Distance <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#levenshtein-distance class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The Levenshtein distance is an <em>edit distance</em> string metric. It is informally
defined as the minimum number of single-character edits to go from one string
to the other. The allowed operations are:</p><ul><li>insertions</li><li>deletions</li><li>substitutions</li></ul><p>The lowest possible number of the required operations is the Levenshtein
distance. Consider the following two strings:</p><pre tabindex=0><code>galaxy
galxy
</code></pre><p>The latter word is misspelled (it is missing the second <code>a</code>). We can correct it
by adding an <code>a</code>. One operation in total means that the Levenshtein distance is
<code>1</code>. It also is for the following pair of strings, but this time requiring the
removal of a character (an extra <code>l</code>):</p><pre tabindex=0><code>galaxy
gallaxy
</code></pre><p>In the following example, the <code>e</code> needs to be replaced with an <code>a</code>:</p><pre tabindex=0><code>galaxy
gelaxy
</code></pre><p>This is again one operation, so the edit distance is <code>1</code>. Here is an example that
requires more than one operation:</p><pre tabindex=0><code>galaxy
glaaxy
</code></pre><p>The first <code>a</code> and the <code>l</code> are in the wrong order, perhaps cause the latter
string was entered hastily. We can remove the <code>l</code> from the second position and
insert an <code>l</code> at the third position to correct the string. Therefore, the
Levenshtein distance is <code>2</code>. We could also substitute the second and third
character instead, but the edit distance remains the same.</p><h3 id=damerau-levenshtein-distance>Damerau-Levenshtein Distance <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#damerau-levenshtein-distance class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The Damerau-Levenshtein distance is like the <a href=#levenshtein-distance class=link>Levenshtein distance</a>
but with transpositions as additional operation. Consider the following example
where the latter string has the <code>a</code> and <code>l</code> in the wrong order:</p><pre tabindex=0><code>galaxy
glaaxy
</code></pre><p>This can be corrected by shifting the <code>l</code> one character to the right. Hence,
the Damerau-Levenshtein distance is only <code>1</code>. The pure Levenshtein distance
is <code>2</code>.</p><h3 id=n-gram-similarity>N-Gram Similarity <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#n-gram-similarity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <em>n</em>-grams of a string are all of its possible substrings of a given length.
The <code>n</code> in <em>n</em>-gram stands for that substring size. <em>N</em>-grams of size 2 are
called 2-grams or <em>bigrams</em>, and <em>n</em>-grams of size 3 are called 3-grams or
<em>trigrams</em>.</p><p>Here is an example for the word <code>avocado</code> that has three trigrams:</p><pre tabindex=0><code>avocado

avo
 voc
  oca
   cad
    ado
</code></pre><p>To compare the similarity of two sets of <em>n</em>-grams, one can simply count how
many <em>n</em>-grams of the target string match the source string (the target string
being the search term and the source string being the stored string), and
divide the sum by the number of the target string&rsquo;s <em>n</em>-grams. Only fully
matching <em>n</em>-grams count.</p><p>Consider the following example with <code>avocado</code> as source string and <code>vocals</code> as
target string:</p><pre tabindex=0><code>avocado   vocals

avo       voc
 voc       oca
  oca       cal
   cad       als
    ado
</code></pre><p>We find the trigrams <code>voc</code> and <code>oca</code> from the right side also on the left side.
The other two do not have a corresponding trigram on the left side. That means,
<code>2 / 4</code> trigrams match, resulting in a similarity of <code>0.5</code> using this
similarity measure.</p><h3 id=positional-n-gram-similarity>Positional N-Gram Similarity <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#positional-n-gram-similarity class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Instead of considering only full <em>n</em>-gram matches, one can also consider
partial matches where the characters are in the same positions and counting the
longest common sequence.</p><pre tabindex=0><code>avocado   vocals

avo       voc
voc       oca
oca       cal
cad       als
ado
</code></pre><p>In above example, <code>voc</code> and <code>oca</code> on the right side have a fully matching
trigram on the left side. <code>cal</code> and <code>als</code> do not, but there is <code>cad</code> which has
a <code>c</code> in the first position and an <code>a</code> in the second position, and both <code>avo</code>
and <code>ado</code> have a matching <code>a</code> in the first position.</p><pre tabindex=0><code>voc   voc   3 / 3 = 1
oca   oca   3 / 3 = 1
cad   cal   2 / 3 = 0.666…
ado   als   1 / 3 = 0.333…
</code></pre><p>We sum up the highest similarity we found for each trigram and divide by the
total <em>n</em>-gram count, which ever of the two is higher (here the left side with
5 trigrams). The result is <code>3 / 5</code> or <code>0.6</code> in positional <em>n</em>-gram similarity.</p><h2 id=fuzzy-search-in-arangodb>Fuzzy Search in ArangoDB <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#fuzzy-search-in-arangodb class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>There are the following AQL string functions to calculate the
<a href=#similarity-measures class=link>similarity</a> of two arbitrary strings:</p><ul><li><a href=/3.13/aql/functions/string/#levenshtein_distance class=link><code>LEVENSHTEIN_DISTANCE()</code></a></li><li><a href=/3.13/aql/functions/string/#ngram_similarity class=link><code>NGRAM_SIMILARITY()</code></a></li><li><a href=/3.13/aql/functions/string/#ngram_positional_similarity class=link><code>NGRAM_POSITIONAL_SIMILARITY()</code></a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>RETURN</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=nf>LEVENSHTEIN_DISTANCE</span><span class=p>(</span><span class=s2>&#34;galaxy&#34;</span><span class=p>,</span> <span class=s2>&#34;glaaxy&#34;</span><span class=p>),</span>           <span class=c1>// 1 (with transpositions)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nf>NGRAM_SIMILARITY</span><span class=p>(</span><span class=s2>&#34;avocado&#34;</span><span class=p>,</span> <span class=s2>&#34;vocals&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>            <span class=c1>// 0.5 (using trigrams)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nf>NGRAM_POSITIONAL_SIMILARITY</span><span class=p>(</span><span class=s2>&#34;avocado&#34;</span><span class=p>,</span> <span class=s2>&#34;vocals&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=c1>// 0.6 (using trigrams)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>]</span></span></span></code></pre></div><p>To perform fuzzy searches, there are two ArangoSearch functions:</p><ul><li><a href=/3.13/aql/functions/arangosearch/#levenshtein_match class=link><code>LEVENSHTEIN_MATCH()</code></a></li><li><a href=/3.13/aql/functions/arangosearch/#ngram_match class=link><code>NGRAM_MATCH()</code></a></li></ul><p>They can be used in conjunction with a View for index-accelerated fuzzy search
queries. The string similarity affects the overall <code>BM25()</code> / <code>TFIDF()</code> score
when <a href=/3.13/index-and-search/arangosearch/ranking/ class=link>ranking</a> results.</p><h3 id=searching-with-levenshtein_match>Searching with <code>LEVENSHTEIN_MATCH()</code> <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#searching-with-levenshtein_match class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=dataset>Dataset <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#dataset class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><a href=/3.13/index-and-search/arangosearch/example-datasets/#imdb-movie-dataset class=link>IMDB movie dataset</a></p><h4 id=custom-analyzer>Custom Analyzer <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#custom-analyzer class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Create a <code>text</code> Analyzer in arangosh to tokenize text, normalize case to all
lowercase and to remove diacritics, but with stemming disabled unlike the
built-in <code>text_en</code> Analyzer. The search will be accent- and case-insensitive,
and the Levenshtein distance between the stored and searched text will be taken
into account accurately. With stemming enabled, it would be less accurate with
respect to the original strings, but potentially find more matches that are
also relevant.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;text_en_no_stem&#34;</span><span class=p>,</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>locale</span><span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> <span class=nx>accent</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=k>case</span><span class=o>:</span> <span class=s2>&#34;lower&#34;</span><span class=p>,</span> <span class=nx>stemming</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>stopwords</span><span class=o>:</span> <span class=p>[]</span> <span class=p>},</span> <span class=p>[</span><span class=s2>&#34;frequency&#34;</span><span class=p>,</span> <span class=s2>&#34;norm&#34;</span><span class=p>]);</span></span></span></code></pre></div><div class=expand><a class=expand-label onclick=toggleExpandShortcode(event)>Show output</a><div class=expand-content style=display:none><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=s2>&#34;_system::text_en_no_stem&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span> <span class=o>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;properties&#34;</span> <span class=o>:</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;locale&#34;</span> <span class=o>:</span> <span class=s2>&#34;en&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;case&#34;</span> <span class=o>:</span> <span class=s2>&#34;lower&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;stopwords&#34;</span> <span class=o>:</span> <span class=p>[</span> <span class=p>],</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;accent&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;stemming&#34;</span> <span class=o>:</span> <span class=kc>false</span> 
</span></span><span class=line><span class=cl>  <span class=p>},</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;features&#34;</span> <span class=o>:</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;frequency&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;norm&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><br><p>The <code>frequency</code> and <code>norm</code> <a href=/3.13/index-and-search/analyzers/#analyzer-features class=link>Analyzer features</a>
are set because the following examples require them for the <code>BM25()</code> scoring
function to work.</p><h4 id=view-definition>View definition <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#view-definition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-text&#34;</span><span class=p>,</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;description&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;text_en_no_stem&#34;</span> <span class=p>}</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_createView</span><span class=p>(</span><span class=s2>&#34;imdb_alias&#34;</span><span class=p>,</span> <span class=s2>&#34;search-alias&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>indexes</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>collection</span><span class=o>:</span> <span class=s2>&#34;imdb_vertices&#34;</span><span class=p>,</span> <span class=nx>index</span><span class=o>:</span> <span class=s2>&#34;inv-text&#34;</span> <span class=p>}</span> <span class=p>]</span> <span class=p>});</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;links&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;imdb_vertices&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;analyzers&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;text_en_no_stem&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div></div></div><h4 id=aql-queries>AQL queries <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#aql-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Search for the token <code>galxy</code> in the movie descriptions with some fuzziness.
The maximum allowed Levenshtein distance is set to <code>1</code>. Everything with a
Levenshtein distance equal to or lower than this value is a match and the
respective documents are included in the search result. The query finds
the token <code>galaxy</code> as the edit distance to <code>galxy</code> is <code>1</code>.</p><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>imdb_alias</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>LEVENSHTEIN_MATCH</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>doc</span><span class=p>.</span><span class=n>description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;galxy&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en_no_stem&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=mi>1</span><span class=p>,</span>    <span class=c1>// max distance
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kc>false</span> <span class=c1>// without transpositions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>description</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>imdb</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>ANALYZER</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nf>LEVENSHTEIN_MATCH</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>doc</span><span class=p>.</span><span class=n>description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nf>TOKENS</span><span class=p>(</span><span class=s2>&#34;galxy&#34;</span><span class=p>,</span> <span class=s2>&#34;text_en_no_stem&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=mi>1</span><span class=p>,</span>    <span class=c1>// max distance
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kc>false</span> <span class=c1>// without transpositions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;text_en_no_stem&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>SORT</span> <span class=nf>BM25</span><span class=p>(</span><span class=n>doc</span><span class=p>)</span> <span class=kr>DESC</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>title</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>description</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span></span></span></code></pre></div></div></div></div><table><thead><tr><th style=text-align:left>title</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td style=text-align:left>Stargate: The Ark of Truth</td><td style=text-align:left>… in the Ori&rsquo;s own home <strong>galaxy</strong>. … SG-1 travels to the Ori <strong>galaxy</strong> aboard the Odyssey. … finds themselves in a distant <strong>galaxy</strong> fighting two powerful enemies.</td></tr><tr><td style=text-align:left>The Ice Pirates</td><td style=text-align:left>… the most precious commodity in the <strong>galaxy</strong> is water. … the unreachable centre of the <strong>galaxy</strong> at the end of the galactic trade wars. The <strong>galaxy</strong> is ruled by an evil emperor …</td></tr><tr><td style=text-align:left>Star Wars: Episode III: Revenge of the Sith</td><td style=text-align:left>… leading a massive clone army into a <strong>galaxy</strong>-wide battle against the Separatists. When the sinister Sith unveil a thousand-year-old plot to rule the <strong>galaxy</strong>, …</td></tr><tr><td style=text-align:left>…</td><td style=text-align:left>…</td></tr></tbody></table><h3 id=searching-with-ngram_match>Searching with <code>NGRAM_MATCH()</code> <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#searching-with-ngram_match class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=dataset-1>Dataset <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#dataset-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><a href=/3.13/index-and-search/arangosearch/example-datasets/#imdb-movie-dataset class=link>IMDB movie dataset</a></p><h4 id=custom-analyzer-1>Custom Analyzer <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#custom-analyzer-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><code>NGRAM_MATCH()</code> requires an <code>ngram</code> Analyzer. For this example, create a
trigram Analyzer in arangosh with a minimum and maximum <em>n</em>-gram size of 3,
not including the original string:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>analyzers</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;@arangodb/analyzers&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>analyzers</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=s2>&#34;trigram&#34;</span><span class=p>,</span> <span class=s2>&#34;ngram&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>min</span><span class=o>:</span> <span class=mi>3</span><span class=p>,</span> <span class=nx>max</span><span class=o>:</span> <span class=mi>3</span><span class=p>,</span> <span class=nx>preserveOriginal</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>streamType</span><span class=o>:</span> <span class=s2>&#34;utf8&#34;</span> <span class=p>},</span> <span class=p>[</span><span class=s2>&#34;frequency&#34;</span><span class=p>,</span> <span class=s2>&#34;position&#34;</span><span class=p>]);</span></span></span></code></pre></div><div class=expand><a class=expand-label onclick=toggleExpandShortcode(event)>Show output</a><div class=expand-content style=display:none><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span> <span class=o>:</span> <span class=s2>&#34;_system::trigram&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span> <span class=o>:</span> <span class=s2>&#34;ngram&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;properties&#34;</span> <span class=o>:</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;min&#34;</span> <span class=o>:</span> <span class=mi>3</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;max&#34;</span> <span class=o>:</span> <span class=mi>3</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;preserveOriginal&#34;</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;streamType&#34;</span> <span class=o>:</span> <span class=s2>&#34;utf8&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;startMarker&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;endMarker&#34;</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>},</span> 
</span></span><span class=line><span class=cl>  <span class=s2>&#34;features&#34;</span> <span class=o>:</span> <span class=p>[</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;frequency&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;position&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><br><p>The <code>frequency</code> and <code>position</code> <a href=/3.13/index-and-search/analyzers/#analyzer-features class=link>Analyzer features</a>
are set because the following examples require them for the <code>NGRAM_MATCH()</code>
filter function to work.</p><h4 id=view-definition-1>View definition <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#view-definition-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><div class=tab-panel><div class=tab-content><div class=tab-nav><button data-tab-group=view-definition data-tab-item="`search-alias` View" class="tab-nav-button selected" onclick='switchTab("view-definition","`search-alias` View",event)'>
<span><code>search-alias</code> View</span></button>
<button data-tab-group=view-definition data-tab-item="`arangosearch` View" class=tab-nav-button onclick='switchTab("view-definition","`arangosearch` View",event)'>
<span><code>arangosearch</code> View</span></button></div><div data-tab-item="`search-alias` View" data-tab-group=view-definition class="tab-item
selected"><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>imdb_vertices</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;inv-ngram&#34;</span><span class=p>,</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;inverted&#34;</span><span class=p>,</span> <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=nx>analyzer</span><span class=o>:</span> <span class=s2>&#34;trigram&#34;</span> <span class=p>}</span> <span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_createView</span><span class=p>(</span><span class=s2>&#34;imdb&#34;</span><span class=p>,</span> <span class=s2>&#34;search-alias&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>indexes</span><span class=o>:</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>collection</span><span class=o>:</span> <span class=s2>&#34;imdb_vertices&#34;</span><span class=p>,</span> <span class=nx>index</span><span class=o>:</span> <span class=s2>&#34;inv-ngram&#34;</span> <span class=p>}</span> <span class=p>]</span> <span class=p>});</span></span></span></code></pre></div></div><div data-tab-item="`arangosearch` View" data-tab-group=view-definition class=tab-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;links&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;imdb_vertices&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;analyzers&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;trigram&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div></div></div><h4 id=aql-queries-1>AQL queries <a href=/3.13/index-and-search/arangosearch/fuzzy-search/#aql-queries-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Search for actor names with an <em>n</em>-gram similarity of at least 50%.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>imdb</span>
</span></span><span class=line><span class=cl>  <span class=kp>SEARCH</span> <span class=nf>NGRAM_MATCH</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>doc</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;avocado&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mf>0.5</span><span class=p>,</span>      <span class=c1>// similarity threshold
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s2>&#34;trigram&#34;</span> <span class=c1>// custom n-gram Analyzer
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>:</span> <span class=n>doc</span><span class=p>.</span><span class=n>name</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span></span></span></code></pre></div><table><thead><tr><th style=text-align:left>name</th></tr></thead><tbody><tr><td style=text-align:left>Nancy S<strong>avoca</strong></td></tr><tr><td style=text-align:left>John S<strong>avoca</strong></td></tr></tbody></table><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/index-and-search/arangosearch/faceted-search/><i class="fas fa-chevron-left fa-fw"></i><p>Faceted search</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/index-and-search/arangosearch/geospatial-search/><p>Geospatial search</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/index-and-search/arangosearch/fuzzy-search.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#similarity-measures>Similarity Measures</a></div><div class=level-3><a href=#levenshtein-distance>Levenshtein Distance</a></div><div class=level-3><a href=#damerau-levenshtein-distance>Damerau-Levenshtein Distance</a></div><div class=level-3><a href=#n-gram-similarity>N-Gram Similarity</a></div><div class=level-3><a href=#positional-n-gram-similarity>Positional N-Gram Similarity</a></div><div class=level-2><a href=#fuzzy-search-in-arangodb>Fuzzy Search in ArangoDB</a></div><div class=level-3><a href=#searching-with-levenshtein_match>Searching with <code>LEVENSHTEIN_MATCH()</code></a></div><div class=level-4><a href=#dataset>Dataset</a></div><div class=level-4><a href=#custom-analyzer>Custom Analyzer</a></div><div class=level-4><a href=#view-definition>View definition</a></div><div class=level-4><a href=#aql-queries>AQL queries</a></div><div class=level-3><a href=#searching-with-ngram_match>Searching with <code>NGRAM_MATCH()</code></a></div><div class=level-4><a href=#dataset-1>Dataset</a></div><div class=level-4><a href=#custom-analyzer-1>Custom Analyzer</a></div><div class=level-4><a href=#view-definition-1>View definition</a></div><div class=level-4><a href=#aql-queries-1>AQL queries</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>