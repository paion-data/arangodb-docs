<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1747031427></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Multi-dimensional indexes allow you to index two- or higher-dimensional data such as time ranges, for efficient intersection of multiple range queries"><meta property="og:url" content="http://localhost/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/"><meta property="og:title" content="Multi-dimensional indexes"><meta property="og:type" content="website"><meta property="og:description" content="Multi-dimensional indexes allow you to index two- or higher-dimensional data such as time ranges, for efficient intersection of multiple range queries"><meta name=docsearch:version content="3.13"><title>Multi-dimensional indexes | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1747031427 defer></script>
<script src=/js/featherlight.min.js?1747031427 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1747031427 defer></script>
<script src=/js/theme.js?1747031427 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.13"><a itemprop=item class=link href=/3.13/><span itemprop=name class=breadcrumb-entry>3.13.0</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Index and Search"><a itemprop=item class=link href=/3.13/index-and-search/><span itemprop=name class=breadcrumb-entry>Index and Search</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Indexing"><a itemprop=item class=link href=/3.13/index-and-search/indexing/><span itemprop=name class=breadcrumb-entry>Indexing</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Working with Indexes"><a itemprop=item class=link href=/3.13/index-and-search/indexing/working-with-indexes/><span itemprop=name class=breadcrumb-entry>Working with Indexes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Multi-dimensional Indexes"><a itemprop=item class=link href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/><span itemprop=name class=breadcrumb-entry>Multi-dimensional Indexes</span></a></li></ol></nav><article class=default><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>ArangoDB v3.13 is under development and not released yet.
This documentation is not final and potentially incomplete.</p></div></div></div></div><hgroup><h1>Multi-dimensional indexes</h1><p class=lead>Multi-dimensional indexes allow you to index two- or higher-dimensional data such as time ranges, for efficient intersection of multiple range queries</p></hgroup><p>A multi-dimensional index maps multi-dimensional data in the form of multiple
numeric attributes to one dimension while mostly preserving locality so that
similar values in all of the dimensions remain close to each other in the mapping
to a single dimension. Queries that filter by multiple value ranges at once can
be better accelerated with such an index compared to a persistent index.</p><p>You can choose between two subtypes of multi-dimensional indexes:</p><ul><li>An <code>mdi</code> index with a <code>fields</code> property that describes which document
attributes to use as dimensions</li><li>An <code>mdi-prefixed</code> index with a <code>fields</code> property as well as a <code>prefixFields</code>
property to specify one or more mandatory document attributes to narrow down
the search space using equality checks, see <a href=#prefix-fields class=link>Prefix fields</a></li></ul><p>Both subtypes require that the attributes described by <code>fields</code> have numeric
values. You can optionally omit documents from the index that have any of
the <code>fields</code> or <code>prefixFields</code> attributes not set or set to <code>null</code> by declaring
the index as sparse with <code>sparse: true</code>.</p><p>Multi-dimensional indexes can be created with a uniqueness constraint with
<code>unique: true</code>. This only allows a single document with a given combination of
attribute values, using all of the <code>fields</code> attributes and (for <code>mdi-prefixed</code>
indexes) <code>prefixFields</code>. Documents omitted because of <code>sparse: true</code> are exempt.</p><p>You can <a href=#storing-additional-values-in-indexes class=link>store additional attributes</a> in
multi-dimensional indexes with the <code>storedValues</code> property. They can be used for
projections (unlike the <code>fields</code> attributes) so that indexes can cover more
queries without having to access the full documents.</p><p>Non-unique <code>mdi</code> indexes have a fixed selectivity estimate of <code>1</code>. For <code>mdi</code>
indexes with <code>unique: true</code> as well as for <code>mdi-prefixed</code> indexes, you can
control whether index selectivity estimates are maintained for the index.
It is enabled by default and you can disable it with <code>estimates: false</code>.
Not maintaining index selectivity estimates can have a slightly positive impact
on write performance but the query optimizer is not able to determine the
usefulness of different competing indexes in AQL queries when there are multiple
candidate indexes to choose from.</p><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text>The <code>mdi</code> index type was previously called <code>zkd</code>.</div></div></div></div><h2 id=querying-documents-within-a-3d-box>Querying documents within a 3D box <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#querying-documents-within-a-3d-box class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Assume we have documents in a collection <code>points</code> of the form</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;x&#34;</span><span class=p>:</span> <span class=mf>12.9</span><span class=p>,</span> <span class=nt>&#34;y&#34;</span><span class=p>:</span> <span class=mf>-284.0</span><span class=p>,</span> <span class=nt>&#34;z&#34;</span><span class=p>:</span> <span class=mf>0.02</span><span class=p>}</span>
</span></span></code></pre></div><p>and we want to query all documents that are contained within a box defined by
<code>[x0, x1] * [y0, y1] * [z0, z1]</code>.</p><p>To do so one creates a multi-dimensional index on the attributes <code>x</code>, <code>y</code> and
<code>z</code>, e.g. in <em>arangosh</em>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>points</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;mdi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;x&#34;</span><span class=p>,</span> <span class=s2>&#34;y&#34;</span><span class=p>,</span> <span class=s2>&#34;z&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>fieldValueTypes</span><span class=o>:</span> <span class=s2>&#34;double&#34;</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Unlike with other indexes, the order of the <code>fields</code> does not matter.</p><p><code>fieldValueTypes</code> is required and the only allowed value is <code>"double"</code> to use a
double-precision (64-bit) floating-point format internally.</p><p>Now we can use the index in a query:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>p</span> <span class=kr>IN</span> <span class=n>points</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>x0</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&lt;=</span> <span class=n>x1</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>y0</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>y</span> <span class=o>&amp;&amp;</span> <span class=n>p</span><span class=p>.</span><span class=n>y</span> <span class=o>&lt;=</span> <span class=n>y1</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>z0</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>z</span> <span class=o>&amp;&amp;</span> <span class=n>p</span><span class=p>.</span><span class=n>z</span> <span class=o>&lt;=</span> <span class=n>z1</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><h2 id=possible-range-queries>Possible range queries <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#possible-range-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Having an index on a set of fields does not require you to specify a full range
for every field. For each field you can decide if you want to bound
it from both sides, from one side only (i.e. only an upper or lower bound)
or not bound it at all.</p><p>Furthermore you can use any comparison operator. The index supports <code>&lt;=</code> and <code>>=</code>
naturally, <code>==</code> will be translated to the bound <code>[c, c]</code>. Strict comparison
is translated to their non-strict counterparts and a post-filter is inserted.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>p</span> <span class=kr>IN</span> <span class=n>points</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=mi>2</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>9</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>p</span><span class=p>.</span><span class=n>y</span> <span class=o>&gt;=</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>p</span><span class=p>.</span><span class=n>z</span> <span class=o>==</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><div class="box notices cstyle tip"><div class=box-content-container><div class=box-content><i class="fas fa-check"></i><div class=box-text><p>The <code>null</code> value is less than all other values in AQL. Therefore, range queries
without a lower bound need to include <code>null</code> but <strong>sparse</strong> indexes do not
include <code>null</code> values. For example, <code>FILTER p.x &lt; 9</code> sets an upper bound, but
unless you also set a lower bound like <code>AND p.x >= 2</code>, the lower bound is
basically <code>p.x >= null</code>.</p><p>You can explicitly exclude <code>null</code> in range queries so that sparse indexes can be
utilized: <code>FILTER p.x &lt; 9 AND p.x != null</code></p></div></div></div></div><h2 id=example-use-case>Example Use Case <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#example-use-case class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>If you build a calendar using ArangoDB you could create a collection for each user
that contains the appointments. The documents would roughly look as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;from&#34;</span><span class=p>:</span> <span class=mi>345365</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;to&#34;</span><span class=p>:</span> <span class=mi>678934</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;what&#34;</span><span class=p>:</span> <span class=s2>&#34;Dentist&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>from</code>/<code>to</code> are the timestamps when an appointment starts/ends. Having an
multi-dimensional index on the fields <code>["from", "to"]</code> allows you to query
for all appointments within a given time range efficiently.</p><h3 id=finding-all-appointments-within-a-time-range>Finding all appointments within a time range <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#finding-all-appointments-within-a-time-range class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Given a time range <code>[f, t]</code> we want to find all appointments <code>[from, to]</code> that
are completely contained in <code>[f, t]</code>. Those appointments clearly satisfy the
condition</p><pre tabindex=0><code>f &lt;= from and to &lt;= t
</code></pre><p>Thus our query would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>app</span> <span class=kr>IN</span> <span class=n>appointments</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>f</span> <span class=o>&lt;=</span> <span class=n>app</span><span class=p>.</span><span class=n>from</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>app</span><span class=p>.</span><span class=kp>to</span> <span class=o>&lt;=</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>app</span></span></span></code></pre></div><h3 id=finding-all-appointments-that-intersect-a-time-range>Finding all appointments that intersect a time range <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#finding-all-appointments-that-intersect-a-time-range class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Given a time range <code>[f, t]</code> we want to find all appointments <code>[from, to]</code> that
intersect <code>[f, t]</code>. Two intervals <code>[f, t]</code> and <code>[from, to]</code> intersect if
and only if</p><pre tabindex=0><code>f &lt;= to and from &lt;= t
</code></pre><p>Thus our query would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>app</span> <span class=kr>IN</span> <span class=n>appointments</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>f</span> <span class=o>&lt;=</span> <span class=n>app</span><span class=p>.</span><span class=kp>to</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>app</span><span class=p>.</span><span class=n>from</span> <span class=o>&lt;=</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>app</span></span></span></code></pre></div><h2 id=prefix-fields>Prefix fields <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#prefix-fields class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Multi-dimensional indexes can accelerate range queries well but they are
inefficient for queries that check for equality of values. For use cases where
you have a combination of equality and range conditions in queries, you can use
the <code>mdi-prefixed</code> subtype instead of <code>mdi</code>. It has all the features of the
<code>mdi</code> subtype but additionally lets you define one or more document attributes
you want to use for equality checks. This combination allows to efficiently
narrow down the search space to a subset of multi-dimensional index data before
performing the range checking.</p><p>The attributes for equality checking are specified via the <code>prefixFields</code>
property of <code>mdi-prefix</code> indexes. These attributes can have non-numeric values,
unlike the attributes you use as <code>fields</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;mdi-prefixed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>prefixFields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;v&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;x&#34;</span><span class=p>,</span> <span class=s2>&#34;y&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>fieldValueTypes</span><span class=o>:</span> <span class=s2>&#34;double&#34;</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>You need to specify all of the <code>prefixFields</code> attributes in your queries to
utilize the index.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>p</span> <span class=kr>IN</span> <span class=n>points</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>p</span><span class=p>.</span><span class=n>v</span> <span class=o>==</span> <span class=s2>&#34;type&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>p</span><span class=p>.</span><span class=n>w</span> <span class=o>==</span> <span class=s2>&#34;group&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=mi>2</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&amp;&amp;</span> <span class=n>p</span><span class=p>.</span><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>9</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>p</span><span class=p>.</span><span class=n>y</span> <span class=o>&gt;=</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><p>You can create <code>mdi-prefixed</code> indexes on edge collections with the <code>_from</code> or
<code>_to</code> edge attribute as the first prefix field. Graph traversals with range filters
can then utilize such indexes. See <a href=/3.13/index-and-search/indexing/working-with-indexes/vertex-centric-indexes/ class=link>Vertex-centric indexes</a>
for details.</p><h2 id=storing-additional-values-in-indexes>Storing additional values in indexes <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#storing-additional-values-in-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p><small>Introduced in: v3.12.0</small></p><p>Multi-dimensional indexes allow you to store additional attributes in the index
that can be used to satisfy projections of the document. They cannot be used for
index lookups or for sorting, but for projections only. They allow multi-dimensional
indexes to fully cover more queries and avoid extra document lookups. This can
have a great positive effect on index scan performance if the number of scanned
index entries is large.</p><p>You can set the <code>storedValues</code> option and specify the additional attributes as
an array of attribute paths when creating a new <code>mdi</code> or <code>mdi-prefixed</code> index,
similar to the <code>fields</code> option:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=o>&lt;</span><span class=nx>collection</span><span class=o>&gt;</span><span class=p>.</span><span class=nx>ensureIndex</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;mdi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>fields</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;x&#34;</span><span class=p>,</span> <span class=s2>&#34;y&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>fieldValueTypes</span><span class=o>:</span> <span class=s2>&#34;double&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>storedValues</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;y&#34;</span><span class=p>,</span> <span class=s2>&#34;z&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>This indexes the <code>x</code> and <code>y</code> attributes so that the index can be used for range
queries by these attributes. Using these document attributes like for returning
them from the query is not covered by the index, however, unless you add the
attributes to <code>storedValues</code> in addition to <code>fields</code>. The reason is that the
index doesn&rsquo;t store the original values of the attributes.</p><p>You can have the same attributes in <code>storedValues</code> and <code>fields</code> as the attributes
in <code>fields</code> cannot be used for projections, but you can also store additional
attributes that are not listed in <code>fields</code>.
The above example stores the <code>y</code> and <code>z</code> attribute values in the index using
<code>storedValues</code>. The index can thus supply the values for projections without
having to look up the full document.</p><p>Attributes in <code>storedValues</code> cannot overlap with the attributes specified in
<code>prefixFields</code>. There is no reason to store them in the index because you need
to specify them in queries in order to use <code>mdi-prefixed</code> indexes.</p><p>In unique indexes, only the index attributes in <code>fields</code> and (for <code>mdi-prefixed</code>
indexes) <code>prefixFields</code> are checked for uniqueness. The index attributes in
<code>storedValues</code> are not checked for their uniqueness.</p><p>You cannot create multiple multi-dimensional indexes with the same <code>sparse</code>,
<code>unique</code>, <code>fields</code> and (for <code>mdi-prefixed</code> indexes) <code>prefixFields</code> attributes
but different <code>storedValues</code> settings. That means the value of <code>storedValues</code> is
not considered by index creation calls when checking if an index is already
present or needs to be created.</p><p>Non-existing attributes are stored as <code>null</code> values.</p><p>The maximum number of attributes that you can use in <code>storedValues</code> is 32.</p><h2 id=lookahead-index-hint>Lookahead Index Hint <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#lookahead-index-hint class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p><small>Introduced in: v3.10.0</small></p><p>Using the lookahead index hint can increase the performance for certain use
cases. Specifying a lookahead value greater than zero makes the index fetch
more documents that are no longer in the search box, before seeking to the
next lookup position. Because the seek operation is computationally expensive,
probing more documents before seeking may reduce the number of seeks, if
matching documents are found. Please keep in mind that it might also affect
performance negatively if documents are fetched unnecessarily.</p><p>You can specify the <code>lookahead</code> value using the <code>OPTIONS</code> keyword:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>app</span> <span class=kr>IN</span> <span class=n>appointments</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>lookahead</span><span class=o>:</span> <span class=mi>32</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kr>FILTER</span> <span class=nv>@to</span> <span class=o>&lt;=</span> <span class=n>app</span><span class=p>.</span><span class=kp>to</span>
</span></span><span class=line><span class=cl>    <span class=kr>FILTER</span> <span class=n>app</span><span class=p>.</span><span class=n>from</span> <span class=o>&lt;=</span> <span class=nv>@from</span>
</span></span><span class=line><span class=cl>    <span class=kr>RETURN</span> <span class=n>app</span></span></span></code></pre></div><h2 id=limitations>Limitations <a href=/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/#limitations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><ul><li>Using array expansions for attributes is not possible (e.g. <code>array[*].attr</code>)</li><li>You can only index numeric values that are representable as IEEE-754 double.</li><li>A high number of dimensions (more than 5) can impact the performance considerably.</li><li>The performance can vary depending on the dataset. Densely packed points can
lead to a high number of seeks. This behavior is typical for indexing using
space filling curves.</li></ul><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.13/index-and-search/indexing/working-with-indexes/fulltext-indexes/><i class="fas fa-chevron-left fa-fw"></i><p>Fulltext Indexes</p></a></span><span class=next><a class="nav nav-next link" href=/3.13/index-and-search/indexing/working-with-indexes/geo-spatial-indexes/><p>Geo-spatial Indexes</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.13/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#querying-documents-within-a-3d-box>Querying documents within a 3D box</a></div><div class=level-2><a href=#possible-range-queries>Possible range queries</a></div><div class=level-2><a href=#example-use-case>Example Use Case</a></div><div class=level-3><a href=#finding-all-appointments-within-a-time-range>Finding all appointments within a time range</a></div><div class=level-3><a href=#finding-all-appointments-that-intersect-a-time-range>Finding all appointments that intersect a time range</a></div><div class=level-2><a href=#prefix-fields>Prefix fields</a></div><div class=level-2><a href=#storing-additional-values-in-indexes>Storing additional values in indexes</a></div><div class=level-2><a href=#lookahead-index-hint>Lookahead Index Hint</a></div><div class=level-2><a href=#limitations>Limitations</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>