<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Extended SmartGraphs, new AQL and index features for efficiency, new Analyzers"><meta property="og:url" content="http://localhost/3.12/release-notes/version-3.9/whats-new-in-3-9/"><meta property="og:title" content="Features and Improvements in ArangoDB 3.9"><meta property="og:type" content="website"><meta property="og:description" content="Extended SmartGraphs, new AQL and index features for efficiency, new Analyzers"><meta name=docsearch:version content="3.12"><title>Features and Improvements in ArangoDB 3.9 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.12"><a itemprop=item class=link href=/3.12/><span itemprop=name class=breadcrumb-entry>3.12.4</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Release Notes"><a itemprop=item class=link href=/3.12/release-notes/><span itemprop=name class=breadcrumb-entry>Release Notes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Version 3.9"><a itemprop=item class=link href=/3.12/release-notes/version-3.9/><span itemprop=name class=breadcrumb-entry>Version 3.9</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="What&rsquo;s New in 3.9"><a itemprop=item class=link href=/3.12/release-notes/version-3.9/whats-new-in-3-9/><span itemprop=name class=breadcrumb-entry>What&rsquo;s New in 3.9</span></a></li></ol></nav><article class=default><hgroup><h1>Features and Improvements in ArangoDB 3.9</h1><p class=lead>Extended SmartGraphs, new AQL and index features for efficiency, new Analyzers</p></hgroup><p>The following list shows in detail which features have been added or improved in
ArangoDB 3.9. ArangoDB 3.9 also contains several bug fixes that are not listed
here.</p><h2 id=disjoint-smartgraphs-using-satellitecollections-enterprise-edition>(Disjoint) SmartGraphs using SatelliteCollections (Enterprise Edition) <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#disjoint-smartgraphs-using-satellitecollections-enterprise-edition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>SmartGraphs have been extended with a new option to create SmartGraphs
using SatelliteCollections.
These SmartGraphs are capable of using SatelliteCollections within their graph
definition and therefore can make use of all the benefits of
<a href=/3.12/develop/satellitecollections/ class=link>SatelliteCollections</a>.</p><p>Edge definitions can now be created between SmartCollections and
SatelliteCollections. As SatelliteCollections are globally replicated to each
participating DB-Server, regular graph traversals, weighted traversals,
shortest path, and k shortest paths queries can partially be executed locally on
each DB-Server. This means that query execution can be fully local whenever
actual data from the SatelliteCollections is being processed. This can improve
data locality and reduce the number of network hops between cluster nodes.</p><p>In case you do have collections that are needed in almost every traversal but
are small enough to be copied over to every participating DB-Server,
SmartGraphs with SatelliteCollections are the perfect fit, as this will increase
the amount of local query execution.</p><p>SmartGraphs using SatelliteCollections can also be disjoint. A Disjoint SmartGraph
prohibits edges connecting different SmartGraph components. The same rule applies to
<a href=/3.12/graphs/smartgraphs/ class=link>Disjoint SmartGraphs using SatelliteCollections</a>.
If your graph does not need edges between vertices with different SmartGraph
attribute values, then you should enable this option. This topology restriction
allows the query optimizer to improve traversal execution times, because the
execution can be pushed down to a single DB-Server in many cases.</p><p><a href=/3.12/graphs/smartgraphs/ class=link>SmartGraphs using SatelliteCollections</a>
are only available in the Enterprise Edition.</p><h2 id=arangosearch>ArangoSearch <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangosearch class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=segmentation-and-collation-analyzers>Segmentation and Collation Analyzers <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#segmentation-and-collation-analyzers class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new <code>segmentation</code> Analyzer type allows you to tokenize text in a
language-agnostic manner as per
<a href=https://unicode.org/reports/tr29 target=_blank rel="noopener noreferrer" class=link>Unicode Standard Annex #29</a>&nbsp;<i class="fas fa-external-link-alt"></i>,
making it suitable for mixed language strings. It can optionally preserve all
non-whitespace or all characters instead of keeping alphanumeric characters only,
as well as apply case conversion.</p><p>The <code>collation</code> Analyzer converts the input into a set of language-specific
tokens. This makes comparisons follow the rules of the respective language,
most notable in range queries against Views.</p><p>See:</p><ul><li><a href=/3.12/index-and-search/analyzers/#segmentation class=link><code>segmentation</code> Analyzer</a></li><li><a href=/3.12/index-and-search/analyzers/#collation class=link><code>collation</code> Analyzer</a></li></ul><h3 id=analyzer-locale-normalization>Analyzer locale normalization <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#analyzer-locale-normalization class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Analyzers with a <code>locale</code> property no longer require that you specify the UTF-8
encoding (<code>.utf-8</code>) that ArangoDB uses for strings.</p><p>The syntax for specifying the language, and possibly a country, variant,
keywords, is now the same as described in the
<a href=https://unicode-org.github.io/icu/userguide/locale/ target=_blank rel="noopener noreferrer" class=link>ICU Documentation</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
The new <code>collation</code> Analyzer is currently the only Analyzer that supports all
four: <code>language[_COUNTRY][_VARIANT][@keywords]</code> (square bracket denote optional
parts). The <code>text</code> and <code>norm</code> Analyzers support <code>language[_COUNTRY][_VARIANT]</code>, the
<code>stem</code> Analyzer only <code>language</code>.</p><p>The former syntax is still supported but automatically normalized to the
new syntax.</p><h3 id=arangosearch-column-cache-enterprise-edition>ArangoSearch column cache (Enterprise Edition) <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangosearch-column-cache-enterprise-edition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Views of the type <code>arangosearch</code> support new caching options.</p><p><small>Introduced in: v3.9.5</small></p><ul><li><p>You can enable the new <code>cache</code> option for individual View links or fields
to always cache field normalization values in memory. This can improve the
performance of scoring and ranking queries.</p><p>It also enables caching of auxiliary data used for querying fields that are
indexed with Geo Analyzers. This can improve the performance of geo-spatial
queries.</p></li><li><p>You can enable the new <code>cache</code> option in the definition of a <code>storedValues</code>
View property to always cache stored values in memory. This can improve the
query performance if stored values are involved.</p></li></ul><hr><p><small>Introduced in: v3.9.6</small></p><ul><li><p>You can enable the new <code>primarySortCache</code> View property to always cache the
primary sort columns in memory. This can improve the performance of queries
that utilize the primary sort order.</p></li><li><p>You can enable the new <code>primaryKeyCache</code> View property to always cache the
primary key column in memory. This can improve the performance of queries
that return many documents.</p></li></ul><p>The cache size can be controlled with the new <code>--arangosearch.columns-cache-limit</code>
startup option and monitored via the new <code>arangodb_search_columns_cache_size</code>
metric.</p><p><a href=/3.12/index-and-search/arangosearch/arangosearch-views-reference/ class=link>ArangoSearch caching</a> is only available in the
Enterprise Edition.</p><p>See <a href=/3.12/index-and-search/arangosearch/performance/ class=link>Optimizing View query performance</a>
for examples.</p><h2 id=ui>UI <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#ui class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=rebalance-shards-for-all-databases-in-web-ui>Rebalance Shards for all databases in Web UI <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#rebalance-shards-for-all-databases-in-web-ui class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The rebalance shards section displays a button for rebalancing shards.
In previous versions, this button only appeared for the <code>_system</code> database,
but now it appears in user-created databases as well if the user has the write
permission for the database.</p><p>There is also a new startup option to limit the
<a href=#maximum-number-of-move-shards class=link>Maximum number of move shards</a>.</p><h3 id=analyzers-in-web-interface>Analyzers in Web Interface <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#analyzers-in-web-interface class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>A new menu item <em>ANALYZERS</em> has been added to the side navigation bar of the
Web UI. Through this page, you can view existing Analyzers as well create new
Analyzers. The UI is full-featured and lets you feed in all parameters and
options that you could otherwise input through the HTTP or JavaScript API.</p><p>It also lets you copy configuration from an existing Analyzer, allowing for a
much quicker workflow when your new Analyzer is very similar to an existing one.</p><p>It offers two edit/view modes - a form mode where a standard web form is used to
capture user input, and a JSON mode where experienced users can directly write
the raw Analyzer configuration in JSON format.</p><h3 id=additional-fields-in-views-creation-form>Additional Fields in Views Creation Form <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#additional-fields-in-views-creation-form class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>ArangoSearch Views have 6 immutable fields (apart from <code>name</code> and <code>type</code>) that
can only be set once at the time of creation. The web interface now includes
these fields in the View creation form, so that you can set them when creating
Views through the UI:</p><ul><li><code>primarySort</code></li><li><code>primarySortCompression</code></li><li><code>storedValues</code></li><li><code>writebufferIdle</code></li><li><code>writebufferActive</code></li><li><code>writebufferSizeMax</code></li></ul><h3 id=web-interface-session-handling>Web interface session handling <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#web-interface-session-handling class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The previously inactive startup parameter <code>--server.session-timeout</code> was
revived and now controls the timeout for web interface sessions (and other
sessions that are based on JWTs created by the <code>/_open/auth</code> API).</p><p>For security reasons, the default timeout value for web interface sessions
has been reduced to one hour, after which a session is ended automatically.
Web interface sessions that are active (i.e. that have any user activity)
are automatically extended until the user ends the session explicitly or
if there is a period of one hour without any user activity.</p><p>The timeout value for web interface sessions can be adjusted via the
<code>--server.session-timeout</code> startup parameter (in seconds).</p><h3 id=configurable-root-redirect>Configurable root redirect <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#configurable-root-redirect class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Added two options to <code>arangod</code> to allow HTTP redirection customization for
root (<code>/</code>) call of the HTTP API:</p><ul><li><p><code>--http.permanently-redirect-root</code>: if <code>true</code> (default), use a permanent
redirection (use HTTP 301 code), if <code>false</code> fall back to temporary redirection
(use HTTP 302 code).</p></li><li><p><code>--http.redirect-root-to</code>: redirect of root URL to a specified path.
Redirects to <code>/_admin/aardvark/index.html</code> if not set (default).</p></li></ul><p>These options are useful to override the built-in web interface with some
user-defined action.</p><h2 id=aql>AQL <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#aql class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=upsert-with-index-hint>Upsert with Index Hint <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#upsert-with-index-hint class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Added support for the <code>indexHint</code> and <code>forceIndexHint</code> options to the <code>UPSERT</code>
operation. It will be used as a hint for the document lookup that is performed
as part of the <code>UPSERT</code> operation, and can help in cases such as <code>UPSERT</code> not
picking the best index automatically.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>UPSERT</span> <span class=p>{</span> <span class=n>a</span><span class=o>:</span> <span class=mi>1234</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>INSERT</span> <span class=p>{</span> <span class=n>a</span><span class=o>:</span> <span class=mi>1234</span><span class=p>,</span> <span class=n>name</span><span class=o>:</span> <span class=s2>&#34;AB&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>UPDATE</span> <span class=p>{</span><span class=n>name</span><span class=o>:</span> <span class=s2>&#34;ABC&#34;</span><span class=p>}</span> <span class=kr>IN</span> <span class=n>myCollection</span>
</span></span><span class=line><span class=cl>  <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>indexHint</span><span class=o>:</span> <span class=s2>&#34;index_name&#34;</span><span class=p>,</span> <span class=n>forceIndexHint</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span></span></span></code></pre></div><p>See <a href=/3.12/aql/high-level-operations/upsert/#indexhint class=link><code>UPSERT</code> Options</a></p><h3 id=decay-functions>Decay Functions <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#decay-functions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Added three decay functions to AQL:</p><ul><li><a href=/3.12/aql/functions/numeric/#decay_exp class=link>DECAY_EXP()</a></li><li><a href=/3.12/aql/functions/numeric/#decay_linear class=link>DECAY_LINEAR()</a></li><li><a href=/3.12/aql/functions/numeric/#decay_gauss class=link>DECAY_GAUSS()</a></li></ul><p>Decay functions calculate a score with a function that decays depending on the
distance of a numeric value from a user given origin.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>DECAY_GAUSS</span><span class=p>(</span><span class=mi>41</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DECAY_LINEAR</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>)</span> <span class=c1>// 0.6
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>DECAY_EXP</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>)</span>    <span class=c1>// 0.7247796636776955
</span></span></span></code></pre></div><h3 id=vector-functions>Vector Functions <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#vector-functions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Added three vector functions to AQL for calculating the cosine similarity
(<code>COSINE_SIMILARITY</code>), Manhattan distance (named <code>L1_DISTANCE</code>), and Euclidean
distance (named <code>L2_DISTANCE</code>):</p><ul><li><a href=/3.12/aql/functions/numeric/#cosine_similarity class=link>COSINE_SIMILARITY()</a></li><li><a href=/3.12/aql/functions/numeric/#l1_distance class=link>L1_DISTANCE()</a></li><li><a href=/3.12/aql/functions/numeric/#l2_distance class=link>L2_DISTANCE()</a></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=nf>COSINE_SIMILARITY</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>])</span> <span class=c1>// 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>L1_DISTANCE</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span><span class=mi>2</span><span class=p>])</span> <span class=c1>// 6
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>L2_DISTANCE</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span><span class=mi>2</span><span class=p>])</span> <span class=c1>// 4.1231056256176606
</span></span></span></code></pre></div><h3 id=traversal-filtering-optimizations>Traversal filtering optimizations <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#traversal-filtering-optimizations class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>A post-filter on the vertex and/or edge result of a traversal will now be
applied during the traversal to avoid generating the full output for AQL.
This will have a positive impact on performance when filtering on the
vertex/edge but still returning the path.</p><p>Previously all paths were produced even for non-matching vertices/edges.
The new optimization now will check on the vertex/edge filter condition
first and only produce the remaining paths.</p><p>For example, the query</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>v</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>p</span> <span class=kr>IN</span> <span class=mi>10</span> <span class=kr>OUTBOUND</span> <span class=nv>@start</span> <span class=kr>GRAPH</span> <span class=s2>&#34;myGraph&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>v</span><span class=p>.</span><span class=n>isRelevant</span> <span class=o>==</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><p>can now be optimized, and the traversal statement will only produce
paths for which the last vertex satisfies <code>isRelevant == true</code>.</p><p>This optimization is now part of the existing <code>optimize-traversals</code> rule and
you will see the conditions under <code>Filter / Prune Conditions</code> in the query
explain output (<code>FILTER (v.`isRelevant` == true)</code> in this example):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>          <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>        <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>TraversalNode</span>        <span class=mi>1</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>v</span>  <span class=cm>/* vertex */</span><span class=p>,</span> <span class=n>p</span>  <span class=cm>/* paths: vertices, edges */</span> <span class=kr>IN</span> <span class=mi>1</span><span class=mf>0</span><span class=o>..</span><span class=mi>10</span>  <span class=cm>/* min..maxPathDepth */</span> <span class=kr>OUTBOUND</span> <span class=s1>&#39;A&#39;</span> <span class=cm>/* startnode */</span>  <span class=kr>GRAPH</span> <span class=s1>&#39;myGraph&#39;</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>      <span class=mi>1</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#5</span> <span class=o>=</span> <span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>`isRelevant`</span> <span class=o>==</span> <span class=kc>true</span><span class=p>)</span>   <span class=cm>/* simple expression */</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>FilterNode</span>           <span class=mi>1</span>       <span class=o>-</span> <span class=kr>FILTER</span> <span class=nl>#5</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>           <span class=mi>1</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Indexes</span> <span class=n>used</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>By</span>   <span class=n>Name</span>   <span class=n>Type</span>   <span class=n>Collection</span>   <span class=n>Unique</span>   <span class=n>Sparse</span>   <span class=n>Selectivity</span>   <span class=n>Fields</span>        <span class=n>Ranges</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>edge</span>   <span class=n>edge</span>   <span class=n>edge</span>         <span class=kc>false</span>    <span class=kc>false</span>       <span class=mi>10</span><span class=mf>0.00</span> <span class=o>%</span>   <span class=p>[</span> <span class=n>`_from`</span> <span class=p>]</span>   <span class=n>base</span> <span class=kr>OUTBOUND</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Traversals</span> <span class=n>on</span> <span class=n>graphs</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>  <span class=n>Depth</span>   <span class=n>Vertex</span> <span class=n>collections</span>  <span class=n>Edge</span> <span class=n>collections</span>  <span class=n>Options</span>                                  <span class=kr>Filter</span> <span class=o>/</span> <span class=kp>Prune</span> <span class=n>Conditions</span>      
</span></span><span class=line><span class=cl> <span class=mi>2</span>   <span class=mi>1</span><span class=mf>0</span><span class=o>..</span><span class=mi>10</span>  <span class=n>vert</span>                <span class=n>edge</span>              <span class=n>uniqueVertices</span><span class=o>:</span> <span class=kr>none</span><span class=p>,</span> <span class=n>uniqueEdges</span><span class=o>:</span> <span class=n>path</span>  <span class=kr>FILTER</span> <span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>`isRelevant`</span> <span class=o>==</span> <span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Optimization</span> <span class=n>rules</span> <span class=n>applied</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>RuleName</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>optimize</span><span class=o>-</span><span class=n>traversals</span></span></span></code></pre></div><h3 id=traversal-partial-path-buildup>Traversal partial path buildup <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#traversal-partial-path-buildup class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>There is now a performance optimization for traversals in which the path
is returned, but only a specific sub-attribute of the path is used later
(e.g. <code>vertices</code>, <code>edges</code>, or <code>weight</code> sub-attribute).</p><p>For example, the query</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>v</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>p</span> <span class=kr>IN</span> <span class=mf>1</span><span class=o>..</span><span class=mi>3</span> <span class=kr>OUTBOUND</span> <span class=nv>@start</span> <span class=kr>GRAPH</span> <span class=s2>&#34;myGraph&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span><span class=p>.</span><span class=n>vertices</span></span></span></code></pre></div><p>only requires the buildup of the <code>vertices</code> sub-attribute of the path result <code>p</code>
but not the buildup of the <code>edges</code> sub-attribute. The optimization can be
observed in the query explain output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>          <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>        <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>TraversalNode</span>        <span class=mi>1</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>v</span>  <span class=cm>/* vertex */</span><span class=p>,</span> <span class=n>p</span>  <span class=cm>/* paths: vertices */</span> <span class=kr>IN</span> <span class=mf>1</span><span class=o>..</span><span class=mi>3</span>  <span class=cm>/* min..maxPathDepth */</span> <span class=kr>OUTBOUND</span> <span class=s1>&#39;A&#39;</span> <span class=cm>/* startnode */</span>  <span class=kr>GRAPH</span> <span class=s1>&#39;myGraph&#39;</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>      <span class=mi>1</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#5</span> <span class=o>=</span> <span class=n>p</span><span class=p>.</span><span class=n>`vertices`</span>   <span class=cm>/* attribute expression */</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>ReturnNode</span>           <span class=mi>1</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=nl>#5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Indexes</span> <span class=n>used</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>By</span>   <span class=n>Name</span>   <span class=n>Type</span>   <span class=n>Collection</span>   <span class=n>Unique</span>   <span class=n>Sparse</span>   <span class=n>Selectivity</span>   <span class=n>Fields</span>        <span class=n>Ranges</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>edge</span>   <span class=n>edge</span>   <span class=n>edge</span>         <span class=kc>false</span>    <span class=kc>false</span>       <span class=mi>10</span><span class=mf>0.00</span> <span class=o>%</span>   <span class=p>[</span> <span class=n>`_from`</span> <span class=p>]</span>   <span class=n>base</span> <span class=kr>OUTBOUND</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Traversals</span> <span class=n>on</span> <span class=n>graphs</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>  <span class=n>Depth</span>  <span class=n>Vertex</span> <span class=n>collections</span>  <span class=n>Edge</span> <span class=n>collections</span>  <span class=n>Options</span>                                  <span class=kr>Filter</span> <span class=o>/</span> <span class=kp>Prune</span> <span class=n>Conditions</span>
</span></span><span class=line><span class=cl> <span class=mi>2</span>   <span class=mf>1</span><span class=o>..</span><span class=mi>3</span>   <span class=n>vert</span>                <span class=n>edge</span>              <span class=n>uniqueVertices</span><span class=o>:</span> <span class=kr>none</span><span class=p>,</span> <span class=n>uniqueEdges</span><span class=o>:</span> <span class=n>path</span>                           
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Optimization</span> <span class=n>rules</span> <span class=n>applied</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>RuleName</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>optimize</span><span class=o>-</span><span class=n>traversals</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=kr>remove</span><span class=o>-</span><span class=n>redundant</span><span class=o>-</span><span class=n>path</span><span class=o>-</span><span class=n>var</span></span></span></code></pre></div><p>The <code>remove-redundant-path-var</code> optimization rule is applied and the
TraversalNode&rsquo;s comment indicates that only the <code>vertices</code> sub-attribute is
built up for this query: <code>p /* paths: vertices */</code></p><p>This optimization should have a positive impact on performance for larger
traversal result sets.</p><h3 id=prune-variable>Prune Variable <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#prune-variable class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Added an option to store the <code>PRUNE</code> expression as a variable. Now, the <code>PRUNE</code>
condition can be stored in a variable and be used later in the query without
having to repeat the <code>PRUNE</code> condition:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>v</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>p</span> <span class=kr>IN</span> <span class=mi>10</span> <span class=kr>OUTBOUND</span> <span class=nv>@start</span> <span class=kr>GRAPH</span> <span class=s2>&#34;myGraph&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kp>PRUNE</span> <span class=n>pruneCondition</span> <span class=o>=</span> <span class=n>v</span><span class=p>.</span><span class=n>isRelevant</span> <span class=o>==</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>pruneCondition</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><p>The <code>v.isRelevant == true</code> condition is stored in the <code>pruneCondition</code> variable
and used as a condition for <code>FILTER</code> later.</p><p>See <a href=/3.12/aql/graphs/traversals/#pruning class=link>Pruning</a>.</p><h3 id=warnings-on-invalid-options>Warnings on invalid OPTIONS <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#warnings-on-invalid-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Invalid use of <code>OPTIONS</code> in AQL queries will now raise a warning when the query
is parsed. This is useful to detect misspelled attribute names in <code>OPTIONS</code>, e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>INSERT</span> <span class=o>..</span><span class=p>.</span> <span class=kr>INTO</span> <span class=n>collection</span>
</span></span><span class=line><span class=cl>  <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>overwrightMode</span><span class=o>:</span> <span class=s1>&#39;ignore&#39;</span> <span class=p>}</span> <span class=cm>/* should have been &#39;overwriteMode&#39; */</span></span></span></code></pre></div><p>It is also useful to detect the usage of valid <code>OPTIONS</code> attribute names that
are used at a wrong position in the query, e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>collection</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>==</span> <span class=mi>1234</span>
</span></span><span class=line><span class=cl>  <span class=kr>INSERT</span> <span class=n>doc</span> <span class=kr>INTO</span> <span class=n>other</span>
</span></span><span class=line><span class=cl>    <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>indexHint</span><span class=o>:</span> <span class=s1>&#39;myIndex&#39;</span> <span class=p>}</span> <span class=cm>/* should have been used above for FOR */</span></span></span></code></pre></div><p>In case options are used incorrectly, a warning with code 1575 will be raised
during query parsing or optimization. By default, warnings are reported but do
not lead to the query being aborted. This can be toggled by the startup option
<code>--query.fail-on-warnings</code> or the per-query runtime option <code>failOnWarnings</code>.</p><h3 id=memory-usage-tracking>Memory usage tracking <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#memory-usage-tracking class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The AQL operations <code>K_SHORTEST_PATHS</code> and <code>SHORTEST_PATH</code> are now included
in the memory usage tracking performed by AQL, so that memory acquired by these
operations will be accounted for and checked against the configured memory
limit (options <code>--query.memory-limit</code> and <code>--query.memory-limit-global</code>).</p><h3 id=execution-of-complex-queries>Execution of complex queries <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#execution-of-complex-queries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Very large queries (in terms of query execution plan complexity) are now split
into multiple segments which are executed using separate stacks. This prevents a
potential stack overflow. To configure the number of execution nodes after such a
stack splitting is performed, use the <code>--query.max-nodes-per-callstack</code> startup option.
The default value is 200 for macOS, and 250
for the other supported platforms. The value can be adjusted per query via the
<code>maxNodesPerCallstack</code> query option. Please note that the default values
should work and adjusting the option is only useful for testing and debugging.</p><h3 id=query-complexity-limits>Query complexity limits <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#query-complexity-limits class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>AQL now has some hard-coded query complexity limits, to prevent large
programmatically generated queries from causing trouble (too deep recursion,
enormous memory usage, long query optimization and distribution passes etc.).</p><p>The following limits have been introduced:</p><ul><li>a recursion limit for AQL query expressions. An expression can now be
up to 500 levels deep. An example expression is <code>1 + 2 + 3 + 4</code>, which
is 3 levels deep <code>1 + (2 + (3 + 4))</code>.
The expression recursion is limited to 500 levels.</li><li>a limit for the number of execution nodes in the initial query
execution plan.
The number of execution nodes in the initial query execution plan is
limited to 4000. This number includes all execution nodes of the
initial execution plan, even if some of them could be
optimized away later by the query optimizer during plan optimization.</li></ul><p>AQL queries that violate these limits will fail to run, and instead abort
with error <code>1524</code> (&ldquo;too much nesting or too many objects&rdquo;) during setup.</p><h3 id=disableindex-hint><code>disableIndex</code> hint <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#disableindex-hint class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.1</small></p><p>In some rare cases, an AQL query can be executed faster if it ignores indexes.
You can force the optimizer not use an index for any given <code>FOR</code>
loop by setting the new <code>disableIndex</code> hint to <code>true</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>collection</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>disableIndex</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>value</span> <span class=o>&lt;=</span> <span class=mi>99</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>other</span></span></span></code></pre></div><p>See the <a href=/3.12/aql/high-level-operations/for/#disableindex class=link><code>FOR</code> Operation Options</a> for details.</p><h3 id=maxprojections-hint><code>maxProjections</code> hint <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#maxprojections-hint class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.1</small></p><p>If an AQL query accesses 5 or fewer attributes of a collection in a <code>FOR</code> loop,
the query optimizer changes the strategy for retrieving the data from the
storage engine. Instead of extracting full documents, only subsets of the
documents are fetched.</p><p>Such projections are typically faster as long as there are not too many of them
but it depends on the number of attributes and their size. The new <code>maxProjections</code>
hint lets you adjust the threshold to fine-tune your queries.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>collection</span> <span class=kp>OPTIONS</span> <span class=p>{</span> <span class=n>maxProjections</span><span class=o>:</span> <span class=mi>7</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=p>[</span> <span class=n>doc</span><span class=p>.</span><span class=n>val1</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val2</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val3</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val4</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val5</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val6</span><span class=p>,</span> <span class=n>doc</span><span class=p>.</span><span class=n>val7</span> <span class=p>]</span></span></span></code></pre></div><p>See the <a href=/3.12/aql/high-level-operations/for/#maxprojections class=link><code>FOR</code> Operation Options</a> for details.</p><h3 id=rocksdb-block-cache-control>RocksDB block cache control <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#rocksdb-block-cache-control class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The new query option <code>fillBlockCache</code> can be used to control the population
of the RocksDB block cache with data read by the query. The default value for
this per-query option is <code>true</code>, which means that any data read by the query
will be inserted into the RocksDB block cache if not already present in there.
This mimics the previous behavior and is a sensible default.</p><p>Setting the option to <code>false</code> allows to not store any data read by the query
in the RocksDB block cache. This is useful for queries that read a lot of (cold)
data which would lead to the eviction of the hot data from the block cache.</p><h3 id=aql-function-to-return-a-shard-id-for-a-document>AQL function to return a shard ID for a document <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#aql-function-to-return-a-shard-id-for-a-document class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>A new <a href=/3.12/aql/functions/miscellaneous/#shard_id class=link>AQL function</a> is available which allows you to
obtain the responsible shard for any document in a collection by specifying its shard keys.</p><h3 id=improved-query-explanation-for-index-scans>Improved query explanation for index scans <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#improved-query-explanation-for-index-scans class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.3</small></p><p>The AQL query explainer now displays <code>index scan + document lookup</code> comments for
queries that use an index for filtering, but need to fetch more document data
from the storage engine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>doc</span><span class=p>.</span><span class=n>attr</span> <span class=o>==</span> <span class=mi>42</span> <span class=c1>// indexed attribute
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>        <span class=n>Est</span><span class=p>.</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>      <span class=mi>1</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>   <span class=n>IndexNode</span>          <span class=mi>1</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span>   <span class=cm>/* persistent index scan, index scan + document lookup */</span>    
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>ReturnNode</span>         <span class=mi>1</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=n>doc</span></span></span></code></pre></div><p>Previously, it was labeled as <code>index scan</code> only, obfuscating the fact that
there are document lookups needed. Covering index queries are still labeled
<code>index scan, index only</code> as before.</p><h3 id=number-of-cluster-requests-in-profiling-output>Number of cluster requests in profiling output <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#number-of-cluster-requests-in-profiling-output class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.5</small></p><p>The query profiling output in the web interface and <em>arangosh</em> now shows the
number of HTTP <code>Requests</code> for queries that you run against cluster deployments
in the <code>Query Statistics</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=n>Query</span> <span class=n>String</span> <span class=p>(</span><span class=mi>33</span> <span class=n>chars</span><span class=p>,</span> <span class=n>cacheable</span><span class=o>:</span> <span class=kc>false</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span>
</span></span><span class=line><span class=cl>   <span class=kr>RETURN</span> <span class=n>doc</span><span class=p>.</span><span class=n>_key</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Execution</span> <span class=n>plan</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>NodeType</span>          <span class=n>Site</span>  <span class=n>Calls</span>   <span class=n>Items</span>   <span class=n>Filtered</span>   <span class=n>Runtime</span> <span class=p>[</span><span class=n>s</span><span class=p>]</span>   <span class=n>Comment</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>SingletonNode</span>     <span class=n>DBS</span>       <span class=mi>3</span>       <span class=mi>3</span>          <span class=mi>0</span>       <span class=mf>0.00024</span>   <span class=o>*</span> <span class=n>ROOT</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>   <span class=n>IndexNode</span>         <span class=n>DBS</span>       <span class=mi>3</span>       <span class=mi>0</span>          <span class=mi>0</span>       <span class=mf>0.00060</span>     <span class=o>-</span> <span class=kr>FOR</span> <span class=n>doc</span> <span class=kr>IN</span> <span class=n>coll</span>   <span class=cm>/* primary index scan, index only (projections: `_key`), 3 shard(s) */</span>    
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=n>CalculationNode</span>   <span class=n>DBS</span>       <span class=mi>3</span>       <span class=mi>0</span>          <span class=mi>0</span>       <span class=mf>0.00025</span>       <span class=o>-</span> <span class=kd>LET</span> <span class=nl>#1</span> <span class=o>=</span> <span class=n>doc</span><span class=p>.</span><span class=n>`_key`</span>   <span class=cm>/* attribute expression */</span>   <span class=cm>/* collections used: doc : coll */</span>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>   <span class=n>RemoteNode</span>        <span class=n>COOR</span>      <span class=mi>6</span>       <span class=mi>0</span>          <span class=mi>0</span>       <span class=mf>0.00227</span>       <span class=o>-</span> <span class=n>REMOTE</span>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>   <span class=n>GatherNode</span>        <span class=n>COOR</span>      <span class=mi>2</span>       <span class=mi>0</span>          <span class=mi>0</span>       <span class=mf>0.00209</span>       <span class=o>-</span> <span class=n>GATHER</span>   <span class=cm>/* parallel, unsorted */</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>ReturnNode</span>        <span class=n>COOR</span>      <span class=mi>2</span>       <span class=mi>0</span>          <span class=mi>0</span>       <span class=mf>0.00008</span>       <span class=o>-</span> <span class=kr>RETURN</span> <span class=nl>#1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Indexes</span> <span class=n>used</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>By</span>   <span class=n>Name</span>      <span class=n>Type</span>      <span class=n>Collection</span>   <span class=n>Unique</span>   <span class=n>Sparse</span>   <span class=n>Cache</span>   <span class=n>Selectivity</span>   <span class=n>Fields</span>       <span class=n>Stored</span> <span class=n>values</span>   <span class=n>Ranges</span>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>   <span class=n>primary</span>   <span class=n>primary</span>   <span class=n>coll</span>         <span class=kc>true</span>     <span class=kc>false</span>    <span class=kc>false</span>      <span class=mi>10</span><span class=mf>0.00</span> <span class=o>%</span>   <span class=p>[</span> <span class=n>`_key`</span> <span class=p>]</span>   <span class=p>[</span>  <span class=p>]</span>            <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Optimization</span> <span class=n>rules</span> <span class=n>applied</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Id</span>   <span class=n>RuleName</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>   <span class=n>scatter</span><span class=o>-</span><span class=kr>in</span><span class=o>-</span><span class=n>cluster</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>   <span class=n>distribute</span><span class=o>-</span><span class=n>filtercalc</span><span class=o>-</span><span class=kp>to</span><span class=o>-</span><span class=n>cluster</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>   <span class=kr>remove</span><span class=o>-</span><span class=n>unnecessary</span><span class=o>-</span><span class=n>remote</span><span class=o>-</span><span class=n>scatter</span>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>   <span class=n>reduce</span><span class=o>-</span><span class=n>extraction</span><span class=o>-</span><span class=kp>to</span><span class=o>-</span><span class=n>projection</span>
</span></span><span class=line><span class=cl>  <span class=mi>5</span>   <span class=n>parallelize</span><span class=o>-</span><span class=n>gather</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Query</span> <span class=n>Statistics</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=n>Writes</span> <span class=n>Exec</span>   <span class=n>Writes</span> <span class=n>Ign</span>   <span class=n>Scan</span> <span class=n>Full</span>   <span class=n>Scan</span> <span class=n>Index</span>   <span class=n>Cache</span> <span class=n>Hits</span><span class=o>/</span><span class=n>Misses</span>   <span class=n>Filtered</span>   <span class=n>Requests</span>   <span class=n>Peak</span> <span class=n>Mem</span> <span class=p>[</span><span class=n>b</span><span class=p>]</span>   <span class=n>Exec</span> <span class=n>Time</span> <span class=p>[</span><span class=n>s</span><span class=p>]</span>
</span></span><span class=line><span class=cl>           <span class=mi>0</span>            <span class=mi>0</span>           <span class=mi>0</span>            <span class=mi>0</span>               <span class=mi>0</span> <span class=o>/</span> <span class=mi>0</span>          <span class=mi>0</span>          <span class=mi>9</span>          <span class=mi>32768</span>         <span class=mf>0.00564</span></span></span></code></pre></div><h3 id=edge-cache-refilling-experimental>Edge cache refilling (experimental) <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#edge-cache-refilling-experimental class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.6</small></p><p>A new feature to automatically refill the in-memory edge cache is available.
When edges are added, modified, or removed, these changes are tracked and a
background thread tries to update the edge cache accordingly if the feature is
enabled, by adding new, updating existing, or deleting and refilling cache
entries.</p><p>You can enable it for individual <code>INSERT</code>, <code>UPDATE</code>, <code>REPLACE</code>, and <code>REMOVE</code>
operations in AQL queries (using <code>OPTIONS { refillIndexCaches: true }</code>), for
individual document API requests that insert, update, replace, or remove single
or multiple edge documents (by setting <code>refillIndexCaches=true</code> as query
parameter), as well as enable it by default using the new
<code>--rocksdb.auto-refill-index-caches-on-modify</code> startup option.</p><p>The new <code>--rocksdb.auto-refill-index-caches-queue-capacity</code> startup option
restricts how many edge cache entries the background thread can queue at most.
This limits the memory usage for the case of the background thread being slower
than other operations that invalidate edge cache entries.</p><p>The background refilling is done on a best-effort basis and not guaranteed to
succeed, for example, if there is no memory available for the cache subsystem,
or during cache grow/shrink operations. A background thread is used so that
foreground write operations are not slowed down by a lot. It may still cause
additional I/O activity to look up data from the storage engine to repopulate
the cache.</p><p>In addition to refilling the edge cache, the cache can also automatically be
seeded on server startup. Use the new <code>--rocksdb.auto-fill-index-caches-on-startup</code>
startup option to enable this feature. It may cause additional CPU and I/O load.
You can limit how many index filling operations can execute concurrently with the
<code>--rocksdb.max-concurrent-index-fill-tasks</code> option. The lower this number, the
lower the impact of the cache filling, but the longer it takes to complete.</p><p>The following metrics are available:</p><table><thead><tr><th style=text-align:left>Label</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>rocksdb_cache_auto_refill_loaded_total</code></td><td style=text-align:left>Total number of queued items for in-memory index caches refilling.</td></tr><tr><td style=text-align:left><code>rocksdb_cache_auto_refill_dropped_total</code></td><td style=text-align:left>Total number of dropped items for in-memory index caches refilling.</td></tr><tr><td style=text-align:left><code>rocksdb_cache_full_index_refills_total</code></td><td style=text-align:left>Total number of in-memory index caches refill operations for entire indexes.</td></tr></tbody></table><p>This feature is experimental.</p><p>Also see:</p><ul><li><a href=/3.12/aql/high-level-operations/insert/#refillindexcaches class=link>AQL <code>INSERT</code> operation</a></li><li><a href=/3.12/aql/high-level-operations/update/#refillindexcaches class=link>AQL <code>UPDATE</code> operation</a></li><li><a href=/3.12/aql/high-level-operations/replace/#refillindexcaches class=link>AQL <code>REPLACE</code> operation</a></li><li><a href=/3.12/aql/high-level-operations/remove/#refillindexcaches class=link>AQL <code>REMOVE</code> operation</a></li><li><a href=/3.12/develop/http-api/documents/ class=link>Document HTTP API</a></li><li><a href=#edge-cache-refill-options class=link>Edge cache refill options</a></li></ul><h2 id=multi-dimensional-indexes-experimental>Multi-dimensional Indexes (experimental) <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#multi-dimensional-indexes-experimental class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>ArangoDB 3.9 features a new index type <code>zkd</code>. It can be created like other
indexes on collections. In contrast to the <code>persistent</code> index type (same for
<code>hash</code> and <code>skiplist</code>, which today are just aliases for <code>persistent</code>), it lifts
the following restriction.</p><p>A <code>persistent</code> index can only be used with query filters where a conjunction of
equalities on a prefix of indexed fields covers the filter. For example, given a
collection with a <code>persistent</code> index on the fields <code>["a", "b"]</code>. Then the
following filters <em>can</em> be satisfied by the index:</p><ul><li><code>FILTER doc.a == @a</code></li><li><code>FILTER doc.a == @a && doc.b == @b</code></li><li><code>FILTER doc.a == @a && @bl &lt;= doc.b && doc.b &lt;= @bu</code></li></ul><p>While the following filters <em>cannot</em>, or only partially, be satisfied by a
<code>persistent</code> index:</p><ul><li><code>FILTER doc.b == @b</code></li><li><code>FILTER @bl &lt;= doc.b && doc.b &lt;= @bu</code></li><li><code>FILTER @al &lt;= doc.a && doc.a &lt;= @au && @bl &lt;= doc.b && doc.b &lt;= @bu</code></li></ul><p>A <code>zkd</code> index can be used to satisfy them all. An example where this is useful
are documents with an assigned time interval, where a query should find all
documents that contain a given time point, or overlap with some time interval.</p><p>There are also drawbacks in comparison with <code>persistent</code> indexes. For one, the
<code>zkd</code> index is not sorted. Secondly, it has a significantly higher overhead, and
the emerging performance is much more dependent on the distribution of the
dataset, making it less predictable. A third limitation is that <code>zkd</code> indexes
can only be created for index values which are IEEE 754 doubles.</p><p><a href=/3.12/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/ class=link>Multi-dimensional Indexes</a> are an experimental feature.</p><h2 id=server-options>Server options <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#server-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=maximum-number-of-move-shards>Maximum number of move shards <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#maximum-number-of-move-shards class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <code>--cluster.max-number-of-move-shards</code> startup option limits the maximum
number of move shards operations that can be made when the <strong>Rebalance Shards</strong>
button is clicked in the Web UI. For backwards compatibility purposes, the
default value is <code>10</code>. If the value is <code>0</code>, then the tab containing this button
will be inactive and the button cannot be clicked.</p><h3 id=extended-naming-convention-for-databases>Extended naming convention for databases <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#extended-naming-convention-for-databases class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>There is a new startup option <code>--database.extended-names-databases</code> to allow
database names to contain most UTF-8 characters. This feature is
<strong>experimental</strong> in ArangoDB 3.9, but will become the norm in a future version.</p><p>Running the server with the option enabled provides support for database names
that are not comprised within the ASCII table, such as Japanese or Arabic
letters, emojis, letters with accentuation. Also, many ASCII characters that
were formerly banned in the traditional naming convention are now accepted.</p><p>Example database names that can be used with the new naming convention:
<code>"Espaa", "", "", "", "@abc123", "Kbenhavn", "Mnchen", "", "abc? &lt;> 123!"</code></p><p>The ArangoDB client tools <em>arangobench</em>, <em>arangodump</em>, <em>arangoexport</em>,
<em>arangoimport</em>, <em>arangorestore</em>, and <em>arangosh</em> ship with full support for the
extended database naming convention.</p><p>Note that the default value for <code>--database.extended-names-databases</code> is <code>false</code>
for compatibility with existing client drivers and applications that only support
ASCII names according to the traditional database naming convention used in previous
ArangoDB versions. Enabling the feature may lead to incompatibilities up to the
ArangoDB instance becoming inaccessible for such drivers and client applications.</p><p>Please be aware that dumps containing extended database names cannot be restored
into older versions that only support the traditional naming convention. In a
cluster setup, it is required to use the same database naming convention for all
Coordinators and DB-Servers of the cluster. Otherwise the startup will be
refused. In DC2DC setups it is also required to use the same database naming
convention for both datacenters to avoid incompatibilities.</p><p>Also see <a href=/3.12/concepts/data-structure/databases/#database-names class=link>Database names</a>.</p><h3 id=icu-language>ICU Language <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#icu-language class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.1</small></p><p>A new server startup option for setting the language was added. The new
<code>--icu-language</code> option will replace the existing <code>--default-language</code> option,
and only one of the two can be set.</p><p>Also see <a href=/3.12/components/arangodb-server/options/#--icu-language class=link>ArangoDB Server General Options</a>.</p><h3 id=logging>Logging <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#logging class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The server now has two flags for retaining or escaping control and Unicode
characters in the log. The flag <code>--log.escape</code> is now deprecated and, instead,
the new flags <code>--log.escape-control-chars</code> and <code>--log.escape-unicode-chars</code>
should be used.</p><ul><li><p><code>--log.escape-control-chars</code>:</p><p>This flag applies to the control characters, that have hex codes below <code>\x20</code>,
and also the character <code>DEL</code> with hex code <code>\x7f</code>.</p><p>When the flag value is set to <code>false</code>, control characters will be retained
when they have a visible representation, and replaced with a space character
in case they do not have a visible representation. For example, the control
character <code>\n</code> is visible, so a <code>\n</code> will be displayed in the log. Contrary,
the control character <code>BEL</code> is not visible, so a space will be displayed
instead.</p><p>When the flag value is set to <code>true</code>, the hex code for the character is
displayed, for example, the <code>BEL</code> character will be displayed as its hex code,
<code>\x07</code>.</p><p>The default value for this flag is <code>true</code> to ensure compatibility with
previous versions.</p></li><li><p><code>--log.escape-unicode-chars</code>:</p><p>If its value is set to <code>false</code>, Unicode characters will be retained and
written to the log as-is. For example, <code></code> will be logged as <code></code>. If the
flag value is set to <code>true</code>, any Unicode characters are escaped, and the hex
codes for all Unicode characters are logged instead. For example, <code></code> would
be logged as its hex code, <code>\u72AC</code>.</p><p>The default value for this flag is set to <code>false</code> for compatibility with
previous versions.</p></li></ul><p>Also see <a href=/3.12/components/arangodb-server/options/#log class=link>Logging</a>.</p><h3 id=version-information>Version information <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#version-information class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <em>arangod</em> server now provides a command <code>--version-json</code> to print version
information in JSON format. This output can be used by tools that need to
programmatically inspect an <em>arangod</em> executable.</p><p>A pseudo log topic <code>"all"</code> was added. Setting the log level for the &ldquo;all&rdquo; log
topic will adjust the log level for <strong>all existing log topics</strong>. For example,
<code>--log.level all=debug</code> will set all log topics to log level &ldquo;debug&rdquo;.</p><h3 id=cluster-option-for-shard-synchronization-timeout>Cluster option for shard synchronization timeout <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#cluster-option-for-shard-synchronization-timeout class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.2</small></p><p>A <code>--cluster.shard-synchronization-attempt-timeout</code> startup option has been
added, letting you limit the amount of time to spend in shard synchronization
attempts (in seconds).</p><p>The default timeout value is 20 minutes. Running into the timeout does not lead
to a synchronization failure, but continues the synchronization shortly after.
Setting a timeout can help to split the synchronization of large shards into
smaller chunks and release snapshots and archived WAL files on the leader earlier.</p><p>This change also introduces a new <code>arangodb_sync_timeouts_total</code> metric that
counts the number of timed-out shard synchronization attempts.</p><h3 id=rocksdb-range-delete-operations-in-cluster>RocksDB range delete operations in cluster <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#rocksdb-range-delete-operations-in-cluster class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.3</small></p><p>The new <code>--rocksdb.use-range-delete-in-wal</code> startup option controls whether the
collection truncate operation in a cluster can use RangeDelete operations in
RocksDB. Using RangeDeletes is fast and reduces the algorithmic complexity of
the truncate operation to O(1), compared to O(n) when this option is turned off
(with n being the number of documents in the collection/shard).</p><p>Previous versions of ArangoDB used RangeDeletes only on a single server, but
never in a cluster.</p><p>The default value for this startup option is <code>true</code>, and the option should only
be changed in case of emergency. This option is only honored in the cluster.
Single server and Active Failover deployments use RangeDeletes regardless of the
value of this option.</p><p>Note that it is not guaranteed that all truncate operations use a RangeDelete
operation. For collections containing a low number of documents, the O(n)
truncate method may still be used.</p><h3 id=rocksdb-periodic-compaction-ttl>RocksDB periodic compaction TTL <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#rocksdb-periodic-compaction-ttl class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.3</small></p><p>A <code>--rocksdb.periodic-compaction-ttl</code> startup option has been added to control
the time-to-live (in seconds) for periodic compaction of .sst files in RocksDB,
based on the .sst file age.</p><p>The default value from RocksDB is ~30 days. You can set the option to <code>0</code> to
avoid periodic auto-compaction.</p><h3 id=option-for-file-copying-method-on-linux>Option for file copying method on Linux <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#option-for-file-copying-method-on-linux class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.4</small></p><p>A Linux-specific <code>--use-splice-syscall</code> startup option has been added to control
whether the Linux-specific <code>splice()</code> syscall should be used for copying file
contents. Set it to <code>false</code> to use a less efficient, but more portable user-space
file copying method, which should work on all file systems.</p><p>See <a href=/3.12/components/arangodb-server/options/#--use-splice-syscall class=link>ArangoDB Server Options</a>
for details.</p><h3 id=aql-query-logging>AQL query logging <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#aql-query-logging class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.5</small></p><p>There are three new startup options to configure how AQL queries are logged:</p><ul><li><code>--query.log-failed</code> for logging all failed AQL queries, to be used during
development or to catch unexpected failed queries in production (off by default)</li><li><code>--query.log-memory-usage-threshold</code> to define a peak memory threshold from
which on a warning is logged for AQL queries that exceed it (default: 4 GB)</li><li><code>--query.max-artifact-log-length</code> for controlling the length of logged query
strings and bind parameter values. Both are truncated to 4096 bytes by default.</li></ul><h3 id=arangosearch-column-cache-limit>ArangoSearch column cache limit <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangosearch-column-cache-limit class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.5</small></p><p>The new <code>--arangosearch.columns-cache-limit</code> startup option lets you control how
much memory (in bytes) the <a href=#arangosearch-column-cache-enterprise-edition class=link>ArangoSearch column cache</a>
is allowed to use.</p><h3 id=cluster-supervision-options>Cluster supervision options <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#cluster-supervision-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.6</small></p><p>The following new options allow you to delay supervision actions for a
configurable amount of time. This is desirable in case DB-Servers are restarted
or fail and come back quickly because it gives the cluster a chance to get in
sync and fully resilient without deploying additional shard replicas and thus
without causing any data imbalance:</p><ul><li><p><code>--agency.supervision-delay-add-follower</code>:
The delay in supervision, before an AddFollower job is executed (in seconds).</p></li><li><p><code>--agency.supervision-delay-failed-follower</code>:
The delay in supervision, before a FailedFollower job is executed (in seconds).</p></li></ul><p><small>Introduced in: v3.9.7</small></p><p>A <code>--agency.supervision-failed-leader-adds-follower</code> startup option has been
added with a default of <code>true</code> (behavior as before). If you set this option to
<code>false</code>, a <code>FailedLeader</code> job does not automatically configure a new shard
follower, thereby preventing unnecessary network traffic, CPU load, and I/O load
for the case that the server comes back quickly. If the server has permanently
failed, an <code>AddFollower</code> job is created anyway eventually, as governed by the
<code>--agency.supervision-delay-add-follower</code> option.</p><h3 id=edge-cache-refill-options>Edge cache refill options <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#edge-cache-refill-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.6</small></p><ul><li><code>--rocksdb.auto-refill-index-caches-on-modify</code>: Whether to automatically
(re-)fill in-memory edge cache entries on insert/update/replace operations
by default. Default: <code>false</code>.</li><li><code>--rocksdb.auto-refill-index-caches-queue-capacity</code>: How many changes can be
queued at most for automatically refilling the edge cache. Default: <code>131072</code>.</li><li><code>--rocksdb.auto-fill-index-caches-on-startup</code>: Whether to automatically fill
the in-memory edge cache with entries on server startup. Default: <code>false</code>.</li><li><code>--rocksdb.max-concurrent-index-fill-tasks</code>: The maximum number of index fill
tasks that can run concurrently on server startup. Default: the number of
cores divided by 8, but at least <code>1</code>.</li></ul><hr><p><small>Introduced in: v3.9.10</small></p><ul><li><code>--rocksdb.auto-refill-index-caches-on-followers</code>: Control whether automatic
refilling of in-memory caches should happen on followers or only leaders.
The default value is <code>true</code>, i.e. refilling happens on followers, too.</li></ul><h3 id=rocksdb-auto-flushing>RocksDB auto-flushing <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#rocksdb-auto-flushing class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.10</small></p><p>A new feature for automatically flushing RocksDB Write-Ahead Log (WAL) files and
in-memory column family data has been added.</p><p>An auto-flush occurs if the number of live WAL files exceeds a certain threshold.
This ensures that WAL files are moved to the archive when there are a lot of
live WAL files present, for example, after a restart. In this case, RocksDB does
not count any previously existing WAL files when calculating the size of WAL
files and comparing its <code>max_total_wal_size</code>. Auto-flushing fixes this problem,
but may prevent WAL files from being moved to the archive quickly.</p><p>You can configure the feature via the following new startup options:</p><ul><li><code>--rocksdb.auto-flush-min-live-wal-files</code>:
The minimum number of live WAL files that triggers an auto-flush. Defaults to <code>10</code>.</li><li><code>--rocksdb.auto-flush-check-interval</code>:
The interval (in seconds) in which auto-flushes are executed. Defaults to <code>3600</code>.
Note that an auto-flush is only executed if the number of live WAL files
exceeds the configured threshold and the last auto-flush is longer ago than
the configured auto-flush check interval. This avoids too frequent auto-flushes.</li></ul><h3 id=custom-arguments-to-rclone>Custom arguments to rclone <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#custom-arguments-to-rclone class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.11</small></p><p>The <code>--rclone.argument</code> startup option can be used to prepend custom arguments
to rclone. For example, you can enable debug logging to a separate file on
startup as follows:</p><pre tabindex=0><code>arangod --rclone.argument &#34;--log-level=DEBUG&#34; --rclone.argument &#34;--log-file=rclone.log&#34;
</code></pre><h2 id=overload-control>Overload control <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#overload-control class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Starting with version 3.9.0, ArangoDB returns an <code>x-arango-queue-time-seconds</code>
HTTP header with all responses. This header contains the most recent request
queueing/dequeuing time (in seconds) as tracked by the server&rsquo;s scheduler.
This value can be used by client applications and drivers to detect server
overload and react on it.</p><p>The arangod startup option <code>--http.return-queue-time-header</code> can be set to
<code>false</code> to suppress these headers in responses sent by arangod.</p><p>In a cluster, the value returned in the <code>x-arango-queue-time-seconds</code> header
is the most recent queueing/dequeuing request time of the Coordinator the
request was sent to, except if the request is forwarded by the Coordinator to
another Coordinator. In that case, the value will indicate the current
queueing/dequeuing time of the forwarded-to Coordinator.</p><p>In addition, client applications and drivers can optionally augment the
requests they send to arangod with the header <code>x-arango-queue-time-seconds</code>.
If set, the value of the header should contain the maximum server-side
queuing time (in seconds) that the client application is willing to accept.
If the header is set in an incoming request, arangod will compare the current
dequeuing time from its scheduler with the maximum queue time value contained
in the request header. If the current queueing time exceeds the value set
in the header, arangod will reject the request and return HTTP 412
(precondition failed) with the error code 21004 (queue time violated).
In a cluster, the <code>x-arango-queue-time-seconds</code> request header will be
checked on the receiving Coordinator, before any request forwarding.</p><h2 id=support-info-api>Support info API <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#support-info-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>A new HTTP REST API endpoint <code>GET /_admin/support-info</code> was added for retrieving
deployment information for support purposes. The endpoint returns data about the
ArangoDB version used, the host (operating system, server ID, CPU and storage capacity,
current utilization, a few metrics) and the other servers in the deployment
(in case of active failover or cluster deployments).</p><p>As this API may reveal sensitive data about the deployment, it can only be
accessed from inside the <code>_system</code> database. In addition, there is a policy control
startup option <code>--server.support-info-api</code> that controls if and to whom the API
is made available. This option can have the following values:</p><ul><li><code>disabled</code>: support info API is disabled.</li><li><code>jwt</code>: support info API can only be accessed via superuser JWT.</li><li><code>hardened</code> (default): if <code>--server.harden</code> is set, the support info API can only be
accessed via superuser JWT. Otherwise it can be accessed by admin users only.</li><li><code>public</code>: everyone with access to the <code>_system</code> database can access the support info API.</li></ul><h2 id=license-management-enterprise-edition>License Management (Enterprise Edition) <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#license-management-enterprise-edition class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The Enterprise Edition of ArangoDB requires a license to activate it.
ArangoDB 3.9 comes with a new license management that lets you test ArangoDB
for three hours before requiring a license key to keep the Enterprise Edition
features activated.</p><p>There is a new JavaScript API for querying the license status and to set a
license key (typically run in <em>arangosh</em>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_getLicense</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_setLicense</span><span class=p>(</span><span class=s2>&#34;&lt;license-string&gt;&#34;</span><span class=p>);</span></span></span></code></pre></div><p>There are two new REST API routes to do the same, <code>GET /_admin/license</code> and
<code>PUT /_admin/license</code>.</p><p>See <a href=/3.12/operations/administration/license-management/ class=link>License Management</a> and the
<a href=/3.12/develop/http-api/administration/#license class=link>License Management HTTP API</a>.</p><h2 id=miscellaneous-changes>Miscellaneous changes <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#miscellaneous-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=collection-statuses>Collection statuses <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#collection-statuses class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The previously existing collection statuses &ldquo;new born&rdquo;, &ldquo;loading&rdquo;, &ldquo;unloading&rdquo;
and &ldquo;unloaded&rdquo; were removed, as they weren&rsquo;t actively used in arangod.</p><p>These statuses were last relevant with the MMFiles storage engine, when it was
important to differentiate which collections were present in main memory and
which weren&rsquo;t. With the RocksDB storage engine, all that is automatically
handled anyway, and the mentioned statuses are not important anymore.</p><p>The &ldquo;Load&rdquo; and &ldquo;Unload&rdquo; buttons for collections have also been removed from the
web interface. This change also obsoletes the <code>load()</code> and <code>unload()</code> calls for
collections as well as their HTTP API equivalents. The APIs will remain in place
for now for downwards-compatibility but have been changed to no-ops.
They will eventually be removed in a future version of ArangoDB.</p><h3 id=cluster-internal-timeouts>Cluster-internal timeouts <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#cluster-internal-timeouts class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The internal timeouts for inactive cluster transactions on DB-Servers was
increased from 3 to 5 minutes.</p><p>Previously transactions on DB-Servers could expire quickly, which led to
spurious &ldquo;query ID not found&rdquo; or &ldquo;transaction ID not found&rdquo; errors on DB
servers for multi-server queries/transactions with unbalanced access patterns
for the different participating DB-Servers.</p><p>Transaction timeouts on Coordinators remain unchanged, so any queries/transactions
that are abandoned will be aborted there, which will also be propagated to
DB-Servers.</p><h3 id=deployment-mode-leader-follower-no-longer-supported>Deployment mode &ldquo;leader-follower&rdquo; no longer supported <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#deployment-mode-leader-follower-no-longer-supported class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The Leader/Follower deployment mode in which two single servers were
set up as a leader and follower pair (without any kind of automatic
failover) was deprecated and removed from the documentation.</p><p>Recommended alternatives are the Active Failover deployment option and the OneShard feature in a cluster.</p><h3 id=traffic-accounting-metrics>Traffic accounting metrics <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#traffic-accounting-metrics class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.8.9, v3.9.6</small></p><p>The following metrics for traffic accounting have been added:</p><table><thead><tr><th style=text-align:left>Label</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>arangodb_client_user_connection_statistics_bytes_received</code></td><td style=text-align:left>Bytes received for requests, only user traffic.</td></tr><tr><td style=text-align:left><code>arangodb_client_user_connection_statistics_bytes_sent</code></td><td style=text-align:left>Bytes sent for responses, only user traffic.</td></tr><tr><td style=text-align:left><code>arangodb_http1_connections_total</code></td><td style=text-align:left>Total number of HTTP/1.1 connections accepted.</td></tr></tbody></table><h3 id=io-heartbeat>I/O heartbeat <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#io-heartbeat class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.8.7, v3.9.2</small></p><p>An I/O heartbeat has been added which checks that the underlying volume is
writable with reasonable performance. The test is done every 15 seconds and can
be switched off.</p><p>Use the accompanying new metrics to check for test failures:</p><table><thead><tr><th style=text-align:left>Label</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>arangodb_ioheartbeat_delays_total</code></td><td style=text-align:left>Total number of delayed I/O heartbeats.</td></tr><tr><td style=text-align:left><code>arangodb_ioheartbeat_duration</code></td><td style=text-align:left>Histogram of execution times in microseconds.</td></tr><tr><td style=text-align:left><code>arangodb_ioheartbeat_failures_total</code></td><td style=text-align:left>Total number of failures.</td></tr></tbody></table><p>These metrics are only populated if the new <code>--database.io-heartbeat</code> startup
option is set to <code>true</code> (which is the default).</p><h3 id=lock-stripes-option-for-rocksdb-transactions>Lock stripes option for RocksDB transactions <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#lock-stripes-option-for-rocksdb-transactions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.2</small></p><p>The new <code>--rocksdb.transaction-lock-stripes</code> option controls the number of lock
stripes to use for RocksDB&rsquo;s transaction lock manager. Higher values can be used
to reduce a potential contention in the lock manager.</p><p>The option defaults to the number of available cores, but is increased to a
value of <code>16</code> if the number of cores is lower.</p><h3 id=configurable-cache_oblivious-option-for-jemalloc>Configurable <code>CACHE_OBLIVIOUS</code> option for jemalloc <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#configurable-cache_oblivious-option-for-jemalloc class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.7</small></p><p>The jemalloc memory allocator supports an option to toggle cache-oblivious large
allocation alignment. It is enabled by default, but disabling it helps to save
4096 bytes of memory for every allocation which is at least 16384 bytes large.
This is particularly beneficial for the RocksDB buffer cache.</p><p>You can now configure the option by setting a <code>CACHE_OBLIVIOUS</code> environment
variable to the string <code>true</code> or <code>false</code> before starting ArangoDB.</p><p>See <a href=/3.12/components/arangodb-server/environment-variables/ class=link>ArangoDB Server environment variables</a>
for details.</p><h3 id=wal-file-tracking-metrics>WAL file tracking metrics <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#wal-file-tracking-metrics class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.10</small></p><p>The following metrics for write-ahead log (WAL) file tracking have been added:</p><table><thead><tr><th style=text-align:left>Label</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>rocksdb_live_wal_files</code></td><td style=text-align:left>Number of live RocksDB WAL files.</td></tr><tr><td style=text-align:left><code>rocksdb_wal_released_tick_flush</code></td><td style=text-align:left>Lower bound sequence number from which WAL files need to be kept because of external flushing needs.</td></tr><tr><td style=text-align:left><code>rocksdb_wal_released_tick_replication</code></td><td style=text-align:left>Lower bound sequence number from which WAL files need to be kept because of replication.</td></tr><tr><td style=text-align:left><code>arangodb_flush_subscriptions</code></td><td style=text-align:left>Number of currently active flush subscriptions.</td></tr></tbody></table><h3 id=sending-delay-metrics-for-internal-requests>Sending delay metrics for internal requests <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#sending-delay-metrics-for-internal-requests class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.9.11</small></p><p>The following metrics for diagnosing delays in cluster-internal network requests
have been added:</p><table><thead><tr><th style=text-align:left>Label</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left><code>arangodb_network_dequeue_duration</code></td><td style=text-align:left>Internal request duration for the dequeue in seconds.</td></tr><tr><td style=text-align:left><code>arangodb_network_response_duration</code></td><td style=text-align:left>Internal request duration from fully sent till response received in seconds.</td></tr><tr><td style=text-align:left><code>arangodb_network_send_duration</code></td><td style=text-align:left>Internal request send duration in seconds.</td></tr><tr><td style=text-align:left><code>arangodb_network_unfinished_sends_total</code></td><td style=text-align:left>Number of internal requests for which sending has not finished.</td></tr></tbody></table><h2 id=client-tools>Client tools <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#client-tools class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=increased-default-number-of-threads>Increased default number of threads <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#increased-default-number-of-threads class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The default value for the <code>--threads</code> startup parameter was changed from
2 to the maximum of 2 and the number of available CPU cores for the following
client tools:</p><ul><li>arangodump</li><li>arangoimport</li><li>arangorestore</li></ul><p>The <code>--threads</code> option works dynamically, its value depends on the number of available CPU cores. If the amount of available CPU cores is less than <code>3</code>, a threads value of <code>2</code> is used. Otherwise the value of threads is set to the number of available CPU cores.</p><p>This change can help to improve performance of imports, dumps or restore
processes on machines with multiple cores in case the <code>--threads</code> parameter
was not previously used. As a trade-off, the change may lead to an increased
load on servers, so any scripted imports, dumps or restore processes that
want to keep the server load under control should set the number of client
threads explicitly when invoking any of the above client tools.</p><h3 id=arangoimport>arangoimport <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangoimport class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><em>arangoimport</em> received a new startup option <code>--merge-attributes</code> that allows
you to create additional attributes in CSV/TSV imports based on other attribute
values and hard-coded string literals/separators.</p><p>The following example would add a new attribute named <code>fullName</code> that consists
of the values of the <code>firstName</code> and <code>lastName</code> columns, separated by a colon
character <code>:</code>, as well as as an additional attribute <code>nameAndId</code> that builds on
the new <code>fullName</code> attribute and concatenates it with a hyphen <code>-</code> and the value
of the <code>id</code> column:</p><pre tabindex=0><code>arangoimport \
  --merge-attributes fullName=[firstName]:[lastName] \
  --merge-attributes nameAndId=[fullName]-[id] \
  ...
</code></pre><p>Also see <a href=/3.12/components/tools/arangoimport/examples-csv/#merging-attributes class=link>Merging Attributes</a>.</p><p><em>arangoimport</em> also provides a new <code>--datatype</code> startup option, in order to fix
the datatypes for certain attributes in CSV/TSV imports. For example, in the
following CSV input file, it is unclear if the numeric values should be
imported as numbers or as stringified numbers for the individual attributes:</p><pre tabindex=0><code>key,price,weight,fk
123456,200,5,585852
864924,120,10,9998242
9949,70,11.5,499494
6939926,2130,5,96962612
</code></pre><p>To determine the datatypes for the individual columns, <em>arangoimport</em> can be
invoked with the <code>--datatype</code> startup option, once for each attribute:</p><pre tabindex=0><code>--datatype key=string
--datatype price=number
--datatype weight=number
--datatype fk=string
</code></pre><p>This will turn the numeric-looking values in the <code>key</code> attribute into strings
but treat the attributes <code>price</code> and <code>weight</code> as numbers. Finally, the values in
attribute <code>fk</code> will be treated as strings again.</p><p>See <a href=/3.12/components/tools/arangoimport/examples-csv/#overriding-data-types-per-attribute class=link>Overriding data types per attribute</a>.</p><h3 id=arangobench>arangobench <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangobench class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Histogram is now switched off by default (the <code>--histogram.generate</code> flag set to false). To display it, set the flag to true.
If this option is disabled, but other histogram flags are addressed, e.g. <code>--histogram.interval-size 500</code>, everything will still run normally, but a warning message will be displayed saying that the histogram is switched off and using that flag has no effect.</p><p><em>arangobench</em> now prints a short description of the test case started, so
it is easier to figure out what operations are carried out by a test case.
Several test cases in arangobench have been deprecated because they do not
target real world use cases but were rather writing for some internal testing.
The deprecated test cases will be removed in a future version to clear up
the list of test cases.</p><p><em>arangobench</em> now supports multiple Coordinators. The flag <code>--server.endpoint</code>
can be specified multiple times, as in the example below:</p><pre tabindex=0><code>arangobench \
  --server.endpoint tcp://[::1]::8529 \
  --server.endpoint tcp://[::1]::8530 \
  --server.endpoint tcp://[::1]::8531 \
  ...
</code></pre><p>This does not compromise the use of the other client tools, that preserve
the behavior of having one Coordinator and one endpoint.</p><p>Also see <a href=/3.12/components/tools/arangobench/#general-configuration class=link><em>arangobench</em> Options</a></p><h3 id=arangodump>arangodump <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangodump class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><em>arangodump</em> now supports multiple Coordinators. The flag <code>--server.endpoint</code>
can be used multiple times, as in the example below:</p><pre tabindex=0><code>arangodump \
  --server.endpoint tcp://[::1]::8529 \
  --server.endpoint tcp://[::1]::8530 \
  --server.endpoint tcp://[::1]::8531 \
  ...
</code></pre><p>This does not compromise the use of the other client tools that preserve
the behavior of having one Coordinator and one endpoint.</p><p>Also see <a href=/3.12/components/tools/arangodump/examples/ class=link><em>arangodump</em> examples</a></p><h3 id=arangorestore>arangorestore <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangorestore class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><em>arangorestore</em> now supports multiple Coordinators. The flag <code>--server.endpoint</code>
can be used multiple times, as in the example below:</p><pre tabindex=0><code>arangorestore \
  --server.endpoint tcp://[::1]::8529 \
  --server.endpoint tcp://[::1]::8530 \
  --server.endpoint tcp://[::1]::8531 \
  ...
</code></pre><p>This does not compromise the use of the other client tools that preserve
the behavior of having one Coordinator and one endpoint.</p><hr><p><small>Introduced in: v3.8.7, v3.9.2</small></p><p>A new <code>--enable-revision-trees</code> option has been added to <em>arangorestore</em>, which
adds the <code>syncByRevision</code> and <code>usesRevisionsAsDocumentIds</code> attributes to the
collection structure if they are missing. As a consequence, these collections
created by arangorestore are able to use revision trees and a faster
getting-in-sync procedure after a restart.</p><p>The option defaults to <code>true</code>, meaning that the attributes are added if they are
missing. If you set the option to <code>false</code>, the attributes are not added to the
collection structure. If the attributes are already present in the dump data, they
are not modified by arangorestore, irrespective of the setting of this option.</p><p>Also see <a href=/3.12/components/tools/arangorestore/examples/ class=link><em>arangorestore</em> examples</a>.</p><h3 id=arangovpack>arangovpack <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#arangovpack class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <em>arangovpack</em> utility supports more input and output formats (JSON and
VelocyPack, plain or hex-encoded). The former options <code>--json</code> and <code>--pretty</code>
have been removed and have been replaced with separate options for specifying
the input and output types:</p><ul><li><code>--input-type</code> (<code>json</code>, <code>json-hex</code>, <code>vpack</code>, <code>vpack-hex</code>)</li><li><code>--output-type</code> (<code>json</code>, <code>json-pretty</code>, <code>vpack</code>, <code>vpack-hex</code>)</li></ul><p>The former option <code>--print-non-json</code> has been replaced with the new option
<code>--fail-on-non-json</code> which makes <a href=/3.12/components/tools/arangovpack/ class=link>arangovpack</a>
fail when trying to emit non-JSON types to JSON output.</p><h2 id=internal-changes>Internal changes <a href=/3.12/release-notes/version-3.9/whats-new-in-3-9/#internal-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The compiler version used to build the ArangoDB Linux executables has been
upgraded from g++ 9.3.0 to g++ 10.2.1.
g++ 10 is also the expected version of g++ when compiling ArangoDB from
source.</p><p>The bundled version of the Snappy compression library has been upgraded from
version 1.1.8 to version 1.1.9.</p><p>The bundled version of the RocksDB library has been upgraded from 6.8 to 6.27.</p><p>For ArangoDB 3.9, the bundled version of rclone is 1.51.0.</p><p>The minimum architecture requirements have been raised from the Westmere
architecture to the Sandy Bridge architecture. 256-bit AVX instructions are
now expected to be present on all targets that run ArangoDB 3.9 executables.
If a target does not support AVX instructions, it may fail with SIGILL at
runtime.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.12/release-notes/version-3.9/><i class="fas fa-chevron-left fa-fw"></i><p>Version 3.9</p></a></span><span class=next><a class="nav nav-next link" href=/3.12/release-notes/version-3.9/known-issues-in-3-9/><p>Known Issues in 3.9</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.12/release-notes/version-3.9/whats-new-in-3-9.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#disjoint-smartgraphs-using-satellitecollections-enterprise-edition>(Disjoint) SmartGraphs using SatelliteCollections (Enterprise Edition)</a></div><div class=level-2><a href=#arangosearch>ArangoSearch</a></div><div class=level-3><a href=#segmentation-and-collation-analyzers>Segmentation and Collation Analyzers</a></div><div class=level-3><a href=#analyzer-locale-normalization>Analyzer locale normalization</a></div><div class=level-3><a href=#arangosearch-column-cache-enterprise-edition>ArangoSearch column cache (Enterprise Edition)</a></div><div class=level-2><a href=#ui>UI</a></div><div class=level-3><a href=#rebalance-shards-for-all-databases-in-web-ui>Rebalance Shards for all databases in Web UI</a></div><div class=level-3><a href=#analyzers-in-web-interface>Analyzers in Web Interface</a></div><div class=level-3><a href=#additional-fields-in-views-creation-form>Additional Fields in Views Creation Form</a></div><div class=level-3><a href=#web-interface-session-handling>Web interface session handling</a></div><div class=level-3><a href=#configurable-root-redirect>Configurable root redirect</a></div><div class=level-2><a href=#aql>AQL</a></div><div class=level-3><a href=#upsert-with-index-hint>Upsert with Index Hint</a></div><div class=level-3><a href=#decay-functions>Decay Functions</a></div><div class=level-3><a href=#vector-functions>Vector Functions</a></div><div class=level-3><a href=#traversal-filtering-optimizations>Traversal filtering optimizations</a></div><div class=level-3><a href=#traversal-partial-path-buildup>Traversal partial path buildup</a></div><div class=level-3><a href=#prune-variable>Prune Variable</a></div><div class=level-3><a href=#warnings-on-invalid-options>Warnings on invalid OPTIONS</a></div><div class=level-3><a href=#memory-usage-tracking>Memory usage tracking</a></div><div class=level-3><a href=#execution-of-complex-queries>Execution of complex queries</a></div><div class=level-3><a href=#query-complexity-limits>Query complexity limits</a></div><div class=level-3><a href=#disableindex-hint><code>disableIndex</code> hint</a></div><div class=level-3><a href=#maxprojections-hint><code>maxProjections</code> hint</a></div><div class=level-3><a href=#rocksdb-block-cache-control>RocksDB block cache control</a></div><div class=level-3><a href=#aql-function-to-return-a-shard-id-for-a-document>AQL function to return a shard ID for a document</a></div><div class=level-3><a href=#improved-query-explanation-for-index-scans>Improved query explanation for index scans</a></div><div class=level-3><a href=#number-of-cluster-requests-in-profiling-output>Number of cluster requests in profiling output</a></div><div class=level-3><a href=#edge-cache-refilling-experimental>Edge cache refilling (experimental)</a></div><div class=level-2><a href=#multi-dimensional-indexes-experimental>Multi-dimensional Indexes (experimental)</a></div><div class=level-2><a href=#server-options>Server options</a></div><div class=level-3><a href=#maximum-number-of-move-shards>Maximum number of move shards</a></div><div class=level-3><a href=#extended-naming-convention-for-databases>Extended naming convention for databases</a></div><div class=level-3><a href=#icu-language>ICU Language</a></div><div class=level-3><a href=#logging>Logging</a></div><div class=level-3><a href=#version-information>Version information</a></div><div class=level-3><a href=#cluster-option-for-shard-synchronization-timeout>Cluster option for shard synchronization timeout</a></div><div class=level-3><a href=#rocksdb-range-delete-operations-in-cluster>RocksDB range delete operations in cluster</a></div><div class=level-3><a href=#rocksdb-periodic-compaction-ttl>RocksDB periodic compaction TTL</a></div><div class=level-3><a href=#option-for-file-copying-method-on-linux>Option for file copying method on Linux</a></div><div class=level-3><a href=#aql-query-logging>AQL query logging</a></div><div class=level-3><a href=#arangosearch-column-cache-limit>ArangoSearch column cache limit</a></div><div class=level-3><a href=#cluster-supervision-options>Cluster supervision options</a></div><div class=level-3><a href=#edge-cache-refill-options>Edge cache refill options</a></div><div class=level-3><a href=#rocksdb-auto-flushing>RocksDB auto-flushing</a></div><div class=level-3><a href=#custom-arguments-to-rclone>Custom arguments to rclone</a></div><div class=level-2><a href=#overload-control>Overload control</a></div><div class=level-2><a href=#support-info-api>Support info API</a></div><div class=level-2><a href=#license-management-enterprise-edition>License Management (Enterprise Edition)</a></div><div class=level-2><a href=#miscellaneous-changes>Miscellaneous changes</a></div><div class=level-3><a href=#collection-statuses>Collection statuses</a></div><div class=level-3><a href=#cluster-internal-timeouts>Cluster-internal timeouts</a></div><div class=level-3><a href=#deployment-mode-leader-follower-no-longer-supported>Deployment mode &ldquo;leader-follower&rdquo; no longer supported</a></div><div class=level-3><a href=#traffic-accounting-metrics>Traffic accounting metrics</a></div><div class=level-3><a href=#io-heartbeat>I/O heartbeat</a></div><div class=level-3><a href=#lock-stripes-option-for-rocksdb-transactions>Lock stripes option for RocksDB transactions</a></div><div class=level-3><a href=#configurable-cache_oblivious-option-for-jemalloc>Configurable <code>CACHE_OBLIVIOUS</code> option for jemalloc</a></div><div class=level-3><a href=#wal-file-tracking-metrics>WAL file tracking metrics</a></div><div class=level-3><a href=#sending-delay-metrics-for-internal-requests>Sending delay metrics for internal requests</a></div><div class=level-2><a href=#client-tools>Client tools</a></div><div class=level-3><a href=#increased-default-number-of-threads>Increased default number of threads</a></div><div class=level-3><a href=#arangoimport>arangoimport</a></div><div class=level-3><a href=#arangobench>arangobench</a></div><div class=level-3><a href=#arangodump>arangodump</a></div><div class=level-3><a href=#arangorestore>arangorestore</a></div><div class=level-3><a href=#arangovpack>arangovpack</a></div><div class=level-2><a href=#internal-changes>Internal changes</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>