<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="A summary of the changes to the HTTP API and other interfaces that are relevant for developers, like maintainers of drivers and integrations for ArangoDB"><meta property="og:url" content="http://localhost/3.12/release-notes/version-3.12/api-changes-in-3-12/"><meta property="og:title" content="API Changes in ArangoDB 3.12"><meta property="og:type" content="website"><meta property="og:description" content="A summary of the changes to the HTTP API and other interfaces that are relevant for developers, like maintainers of drivers and integrations for ArangoDB"><meta name=docsearch:version content="3.12"><title>API Changes in ArangoDB 3.12 | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.12"><a itemprop=item class=link href=/3.12/><span itemprop=name class=breadcrumb-entry>3.12.4</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Release Notes"><a itemprop=item class=link href=/3.12/release-notes/><span itemprop=name class=breadcrumb-entry>Release Notes</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Version 3.12"><a itemprop=item class=link href=/3.12/release-notes/version-3.12/><span itemprop=name class=breadcrumb-entry>Version 3.12</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="API changes in 3.12"><a itemprop=item class=link href=/3.12/release-notes/version-3.12/api-changes-in-3-12/><span itemprop=name class=breadcrumb-entry>API changes in 3.12</span></a></li></ol></nav><article class=default><hgroup><h1>API Changes in ArangoDB 3.12</h1><p class=lead>A summary of the changes to the HTTP API and other interfaces that are relevant for developers, like maintainers of drivers and integrations for ArangoDB</p></hgroup><h2 id=http-restful-api>HTTP RESTful API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#http-restful-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=behavior-changes>Behavior changes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#behavior-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=velocystream-protocol-removed>VelocyStream protocol removed <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#velocystream-protocol-removed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>ArangoDB&rsquo;s own bi-directional asynchronous binary protocol VelocyStream is no
longer supported.</p><p>The server immediately closes the connection if you attempt to use the
VelocyStream protocol. If you specify any scheme starting with <code>vst</code> in the
<code>--server.endpoint</code> startup option of a client tool, the HTTP protocol is used
instead.</p><p>The following metrics related to VelocyStream have been removed:</p><ul><li><code>arangodb_request_body_size_vst</code></li><li><code>arangodb_vst_connections_total</code></li></ul><p>VelocyPack remains as ArangoDB&rsquo;s binary storage format and you can continue to
use it in transport over the HTTP protocol, as well as use JSON over the
HTTP protocol.</p><h4 id=http-headers>HTTP headers <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#http-headers class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The following long-deprecated features have been removed from ArangoDB&rsquo;s HTTP
server:</p><ul><li><p>Overriding the HTTP method by setting one of the HTTP headers:</p><ul><li><code>x-http-method</code></li><li><code>x-http-method-override</code></li><li><code>x-method-override</code></li></ul><p>This functionality posed a potential security risk and was thus removed.
Previously, it was only enabled when explicitly starting the
server with the <code>--http.allow-method-override</code> startup option.
The functionality has now been removed and setting the startup option does
nothing.</p></li><li><p>Optionally hiding ArangoDB&rsquo;s <code>server</code> response header. This functionality
could optionally be enabled by starting the server with the startup option
<code>--http.hide-product-header</code>.
The functionality has now been removed and setting the startup option does
nothing.</p></li></ul><h4 id=--databaseextended-names-enabled-by-default><code>--database.extended-names</code> enabled by default <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#--databaseextended-names-enabled-by-default class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <code>--database.extended-names</code> startup option is now enabled by default.
The names of databases, collections, Views, and indexes may contain Unicode
characters using the default settings.</p><h4 id=collection-api>Collection API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#collection-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>When creating a collection using the <code>POST /_api/collection</code> endpoint, the
server log now displays a <code>deprecation</code> message if illegal combinations and
unknown attributes and values are detected in the request body.</p><p>Note that all invalid elements and value combinations will be rejected in future
versions. The following options are already validated more strictly in v3.12
and incorrect use can lead to errors:</p><ul><li><code>keyOptions</code>: The <code>increment</code> and <code>offset</code> sub-attributes are only allowed if
the <code>type</code> sub-attribute is <code>"autoincrement"</code>. The <code>lastValue</code> sub-attribute
is only allowed if the <code>type</code> sub-attribute is <code>"traditional"</code>, <code>"autoincrement"</code>,
or <code>"padded"</code>.</li><li><code>shardKeys</code>: Each array element needs to be a string.</li></ul><h4 id=index-api>Index API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#index-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><h5 id=stored-values-can-contain-the-_id-attribute>Stored values can contain the <code>_id</code> attribute <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#stored-values-can-contain-the-_id-attribute class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h5><p>The usage of the <code>_id</code> system attribute was previously disallowed for
<code>persistent</code> indexes inside of <code>storedValues</code>. This is now allowed in v3.12.</p><p>Note that it is still forbidden to use <code>_id</code> as a top-level attribute or
sub-attribute in <code>fields</code> of persistent indexes. On the other hand, inverted
indexes have been allowing to index and store the <code>_id</code> system attribute.</p><h4 id=optimizer-rule-changes>Optimizer rule changes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#optimizer-rule-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Due to the <a href=/3.12/release-notes/version-3.12/whats-new-in-3-12/#improved-joins class=link>improved joins</a> in AQL, there
is a new <code>join-index-nodes</code> optimizer rule and a <code>JoinNode</code> that may appear in
execution plans.</p><p>The <code>remove-unnecessary-projections</code> AQL optimizer rule has been renamed to
<code>optimize-projections</code> and now includes an additional optimization.</p><p>Moreover, a <code>remove-unnecessary-calculations-4</code> and <code>batch-materialize-documents</code>
rule have been added.</p><p>A <code>push-limit-into-index</code> rule has been added in v3.12.2.</p><p>A <code>replace-entries-with-object-iteration</code> rule has been added in v3.12.3.</p><p>A <code>use-index-for-collect</code> and a <code>use-vector-index</code> rule have been added in v3.12.4.</p><p>The affected endpoints are <code>POST /_api/cursor</code>, <code>POST /_api/explain</code>, and
<code>GET /_api/query/rules</code>.</p><h4 id=gharial-api>Gharial API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#gharial-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <code>PATCH /_api/gharial/{graph}/edge/{collection}/{edge}</code> endpoint to update
edges in named graphs now validates the referenced vertex when modifying either
the <code>_from</code> or <code>_to</code> edge attribute. Previously, the validation only occurred if
both were set in the request.</p><h4 id=validation-of-smartgraphattribute-in-smartgraphs>Validation of <code>smartGraphAttribute</code> in SmartGraphs <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#validation-of-smartgraphattribute-in-smartgraphs class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.10.13, v3.11.7</small></p><p>The attribute defined by the <code>smartGraphAttribute</code> graph property is not allowed to be
changed in the documents of SmartGraph vertex collections. This is now strictly enforced.
You must set the attribute when creating a document. Any attempt to modify or remove
the attribute afterward by update or replace operations now throws an error. Previously,
the <code>smartGraphAttribute</code> value was checked only when inserting documents into a
SmartGraph vertex collection, but not for update or replace operations.</p><p>The missing checks on update and replace operations allowed to retroactively
modify the value of the <code>smartGraphAttribute</code> for existing documents, which
could have led to problems when the data of such a SmartGraph vertex collection was
replicated to a new follower shard. On the new follower shard, the documents
went through the full validation and led to documents with modified
<code>smartGraphAttribute</code> values being rejected on the follower. This could have
led to follower shards not getting in sync.</p><p>Now, the value of the <code>smartGraphAttribute</code> is fully validated with every
insert, update, or replace operation, and every attempt to modify the value of
the <code>smartGraphAttribute</code> retroactively fails with the <code>4003</code> error,
<code>ERROR_KEY_MUST_BE_PREFIXED_WITH_SMART_GRAPH_ATTRIBUTE</code>.
Additionally, if upon insertion the <code>smartGraphAttribute</code> is missing for a
SmartGraph vertex, the error code is error <code>4001</code>, <code>ERROR_NO_SMART_GRAPH_ATTRIBUTE</code>.</p><p>To retroactively repair the data in any of the affected collections, it is
possible to update every (affected) document with the correct value of the
<code>smartGraphAttribute</code> via an AQL query as follows:</p><pre tabindex=0><code>FOR doc IN @@collection
  LET expected = SUBSTRING(doc._key, 0, FIND_FIRST(doc._key, &#39;:&#39;))
  LET actual = doc.@attr
  FILTER expected != actual
  UPDATE doc WITH {@attr: expected} IN @@collection
  COLLECT WITH COUNT INTO updated
  RETURN updated
</code></pre><p>This updates all documents with the correct (expected) value of the
<code>smartGraphAttribute</code> if it deviates from the expected value. The query
returns the number of updated documents as well.</p><p>The bind parameters necessary to run this query are:</p><ul><li><code>@@collection</code>: name of a SmartGraph vertex collection to be updated</li><li><code>@attr</code>: attribute name of the <code>smartGraphAttribute</code> of the collection</li></ul><h4 id=limit-to-the-number-of-databases-in-a-deployment>Limit to the number of databases in a deployment <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#limit-to-the-number-of-databases-in-a-deployment class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.10.10, v3.11.2</small></p><p>The new <code>--database.max-databases</code> startup option can cap the number of databases
and creating databases using the <code>POST /_api/database</code> endpoint can thus now fail
for this reason if your deployment is at or above the configured maximum. Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;code&#34;</span><span class=p>:</span> <span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;error&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;errorMessage&#34;</span><span class=p>:</span> <span class=s2>&#34;unable to create additional database because it would exceed the configured maximum number of databases (2)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;errorNum&#34;</span><span class=p>:</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=adjustable-stream-transaction-size>Adjustable Stream Transaction size <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#adjustable-stream-transaction-size class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <a href=/3.12/develop/http-api/transactions/stream-transactions/ class=link>Stream Transactions HTTP API</a>
may now allow larger transactions or be limited to smaller transactions because
the maximum transaction size can now be configured with the
<code>--transaction.streaming-max-transaction-size</code> startup option.
The default value remains 128 MiB up to v3.12.3.
From v3.12.4 onward, the default value is 512 MiB.</p><h4 id=analyzer-api>Analyzer API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#analyzer-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <a href=/3.12/develop/http-api/analyzers/ class=link><code>/_api/analyzer</code> endpoints</a> supports
a new <code>multi_delimiter</code> Analyzer that accepts an array of strings in a
<code>delimiters</code> attribute of the <code>properties</code> object.</p><h4 id=adjustable-writeconcern-for-collections-with-distributeshardslike>Adjustable <code>writeConcern</code> for collections with <code>distributeShardsLike</code> <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#adjustable-writeconcern-for-collections-with-distributeshardslike class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Collections that are sharded like another collection via the <code>distributeShardsLike</code>
property use the <code>replicationFactor</code>, <code>numberOfShards</code>, and <code>shardingStrategy</code>
properties of the prototype collection. In previous versions, the <code>writeConcern</code>
property of the prototype collection was used as well. Now, you can independently
set a <code>writeConcern</code> when creating a collection with <code>distributeShardsLike</code>.
The property defaults to the <code>writeConcern</code> of the prototype collection if you
don&rsquo;t specify it explicitly. You can adjust the <code>writeConcern</code> later on in
either case.</p><h4 id=log-api>Log API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#log-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <a href=/3.12/develop/http-api/monitoring/logs/ class=link><code>/_admin/log/*</code> endpoints</a> no
longer use the <code>ldap</code> log topic. Changing the log level of the <code>ldap</code> topic or
any other unknown topic is not an error, however. Also see
<a href=/3.12/release-notes/version-3.12/incompatible-changes-in-3-12/#ldap-authentication-support-removed class=link>Incompatible changes in ArangoDB 3.12</a>.</p><p>A new <code>deprecation</code> log topic has been added. It warns about deprecated features
and the usage of options that will not be allowed or have no effect in a future
version.</p><h4 id=error-code-12-removed>Error code <code>12</code> removed <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#error-code-12-removed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The unused error <code>ERROR_OUT_OF_MEMORY_MMAP</code> with the number <code>12</code> has been removed.</p><h4 id=mmap-log-topic-removed><code>mmap</code> log topic removed <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#mmap-log-topic-removed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.1</small></p><p>The <code>mmap</code> log topic for logging information related to memory mapping has been
unused since v3.12.0 and has now been removed. The <code>/_admin/log/level</code> endpoints
no longer include this log topic in responses and attempts to set the log level
for this topic are ignored.</p><h3 id=endpoint-return-value-changes>Endpoint return value changes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#endpoint-return-value-changes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=storage-engine-api>Storage engine API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#storage-engine-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><ul><li><p>The storage engine API at <code>GET /_api/engine</code> does not return the attribute
<code>dfdb</code> anymore.</p></li><li><p>On single servers and DB-Servers, the <code>GET /_api/engine</code> endpoint now
returns an <code>endianness</code> attribute. Currently, only Little Endian is supported
as an architecture by ArangoDB. The value is therefore <code>"little"</code>.</p></li></ul><h3 id=endpoints-added>Endpoints added <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#endpoints-added class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=effective-and-available-startup-options>Effective and available startup options <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#effective-and-available-startup-options class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The new <code>GET /_admin/options</code> and <code>GET /_admin/options-description</code> HTTP API
endpoints allow you to return the effective configuration and the available
startup options of the queried <em>arangod</em> instance.</p><p>Previously, it was only possible to <a href=/3.12/operations/administration/configuration/#fetch-current-configuration-options class=link>fetch the current configuration</a>
on single servers and Coordinators using a JavaScript transaction, and to list
the available startup options with <code>--dump-options</code>.</p><p>See the <a href=/3.12/develop/http-api/administration/#startup-options class=link>HTTP interface for administration</a>
for details.</p><h4 id=available-key-generators>Available key generators <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#available-key-generators class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>You can now retrieve the available key generators for collections using the new
<code>GET /_api/key-generators</code> endpoint.</p><p>See the <a href=/3.12/develop/http-api/collections/#get-the-available-key-generators class=link>HTTP API description</a></p><h4 id=shard-usage-metrics>Shard usage metrics <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#shard-usage-metrics class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>With <code>GET /_admin/usage-metrics</code> you can retrieve detailed shard usage metrics on
DB-Servers.</p><p>These metrics can be enabled by setting the <code>--server.export-shard-usage-metrics</code>
startup option to <code>enabled-per-shard</code> to make DB-Servers collect per-shard
usage metrics, or to <code>enabled-per-shard-per-user</code> to make DB-Servers collect
usage metrics per shard and per user whenever a shard is accessed.</p><p>For more information, see the <a href=/3.12/develop/http-api/monitoring/metrics/#get-usage-metrics class=link>HTTP API description</a>
and <a href=/3.12/release-notes/version-3.12/whats-new-in-3-12/#monitoring-per-collectiondatabaseuser class=link>Monitoring per collection/database/user</a>.</p><h4 id=reset-log-levels>Reset log levels <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#reset-log-levels class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.1</small></p><p>A new <code>DELETE /_admin/log/level</code> endpoint has been added that lets you reset the
log level settings to the values they had at server startup. This is useful for
tools that temporarily change log levels but do not want to fetch and remember
the previous log levels settings. Such tools can now simply call this new
endpoint to restore the original log levels.</p><p>See the <a href=/3.12/develop/http-api/monitoring/logs/#reset-the-server-log-levels class=link>Log API</a>
for details.</p><h4 id=query-plan-cache-api>Query plan cache API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#query-plan-cache-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.4</small></p><p>Two endpoints have been added to let you list the entries and clear the cache
for AQL execution plans. Query plan caching works on a per-database basis.</p><ul><li><code>GET /_api/query-plan-cache</code></li><li><code>DELETE /_api/query-plan-cache</code></li></ul><p>See <a href=/3.12/develop/http-api/queries/aql-query-plan-cache/ class=link>HTTP interface for the query plan cache</a>
for details.</p><h3 id=endpoints-augmented>Endpoints augmented <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#endpoints-augmented class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=view-api>View API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#view-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>Views of type <code>arangosearch</code> accept a new <code>optimizeTopK</code> View property for the
ArangoSearch WAND optimization. It is an immutable array of strings, optional,
and defaults to <code>[]</code>.</p><p>See the <a href=/3.12/index-and-search/arangosearch/arangosearch-views-reference/#view-properties class=link><code>optimizeTopK</code> View property</a>
for details.</p><h4 id=document-api>Document API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#document-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The following endpoints accept a new <code>versionAttribute</code> query parameter that adds
external versioning support:</p><ul><li><code>PATCH /_api/document/{collection}/{key}</code> (single document update)</li><li><code>PATCH /_api/document/{collection}</code> (multiple document update)</li><li><code>PUT /_api/document/{collection}</code> (single document replace)</li><li><code>PUT /_api/document/{collection}/{key}</code> (multiple document replace)</li><li><code>POST /_api/document/{collection}</code> (single document insert, when used to update/replace a document)</li><li><code>POST /_api/document/{collection}/{key}</code> (multiple document insert, when used to update/replace a document)</li></ul><p>If set, the attribute with the name specified by the option is looked up in the
stored document and the attribute value is compared numerically to the value of
the versioning attribute in the supplied document that is supposed to update/replace it.
The document is only changed if the new number is higher. See the
<a href=/3.12/develop/http-api/documents/#create-a-document class=link>Document API</a> for details.</p><h4 id=cursor-api>Cursor API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#cursor-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><h5 id=documentlookups-and-seeks-statistics><code>documentLookups</code> and <code>seeks</code> statistics <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#documentlookups-and-seeks-statistics class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h5><p>Two new statistics are included in the response when you execute an AQL query:</p><ul><li><code>documentLookups</code>: The number of real document lookups caused by late materialization
as well as <code>IndexNode</code>s that had to load document attributes not covered
by the index. This is how many documents had to be fetched from storage after
an index scan that initially covered the attribute access for these documents.</li><li><code>seeks</code>: The number of seek calls done by RocksDB iterators for merge joins
(<code>JoinNode</code> in the execution plan).</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;result&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=s2>&#34;extra&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;stats&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;documentLookups&#34;</span><span class=o>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;seeks&#34;</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h4 id=query-plan-cache-attributes>Query plan cache attributes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#query-plan-cache-attributes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.4</small></p><p>The following endpoints related to AQL queries support a new <code>usePlanCache</code>
query option in the <code>options</code> object:</p><ul><li><code>POST /_api/cursor</code></li><li><code>POST /_api/explain</code></li></ul><p>An error is raised if <code>usePlanCache</code> is set to <code>true</code> but the query is not
eligible for plan caching (a new error code
<code>ERROR_QUERY_NOT_ELIGIBLE_FOR_PLAN_CACHING</code> with the number <code>1584</code>). See
<a href=/3.12/aql/execution-and-performance/caching-query-plans/ class=link>The execution plan cache for AQL queries</a>
for details.</p><p>If a cached query plan is utilized, the above endpoints include a new
<code>planCacheKey</code> attribute at the top-level of the response with the key of the
cached plan (string).</p><p>See <a href=/3.12/develop/http-api/queries/aql-queries/#cursors class=link>HTTP interfaces for AQL queries</a>
for details.</p><h4 id=index-api-1>Index API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#index-api-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><h5 id=optimizetopk-for-inverted-indexes><code>optimizeTopK</code> for inverted indexes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#optimizetopk-for-inverted-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h5><p>Indexes of type <code>inverted</code> accept a new <code>optimizeTopK</code> property for the
ArangoSearch WAND optimization. It is an array of strings, optional, and
defaults to <code>[]</code>.</p><p>See the <a href=/3.12/develop/http-api/indexes/inverted/ class=link>inverted index <code>optimizeTopK</code> property</a>
for details.</p><h5 id=multi-dimensional-indexes>Multi-dimensional indexes <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#multi-dimensional-indexes class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h5><p>The previously experimental <code>zkd</code> index type is now stable and has been renamed
to <code>mdi</code>. Existing indexes keep the <code>zkd</code> type. The HTTP API still allows the old
name to create new indexes that behave exactly like <code>mdi</code> indexes but this is
discouraged. The <code>zkd</code> alias may get removed in a future version.</p><p>An additional <code>mdi-prefixed</code> index variant has been added. This is a new index
type in the API with the same settings as the <code>mdi</code> index but with one additional
<code>prefixFields</code> attribute. It is a required setting for the <code>mdi-prefixed</code> index
type and accepts an array of strings similar to the <code>fields</code> attribute. You can
use it to narrow down the search space using equality checks.</p><p>Both multi-dimensional index variants now support a <code>sparse</code> setting (boolean)
and <code>storedValues</code> setting (array of strings) that were not supported by the
<code>zkd</code> index type in previous versions.</p><p>See <a href=/3.12/index-and-search/indexing/working-with-indexes/multi-dimensional-indexes/ class=link>Working with multi-dimensional indexes</a>
for details.</p><h5 id=progress-indication-on-the-index-generation>Progress indication on the index generation <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#progress-indication-on-the-index-generation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h5><p><small>Introduced in: v3.10.13, v3.11.7</small></p><p>The <code>GET /_api/index</code> endpoint may now include a <code>progress</code> attribute for the
elements in the <code>indexes</code> array. For every index that is currently being created,
it indicates the progress of the index generation (in percent).</p><p>To return indexes that are not yet fully built but are in the building phase,
add the <code>withHidden=true</code> query parameter to the call of the endpoint.</p><pre tabindex=0><code>curl &#34;http://localhost:8529/_api/index?collection=myCollection&amp;withHidden=true&#34;
</code></pre><h4 id=vector-indexes-experimental>Vector indexes (experimental) <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#vector-indexes-experimental class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.4</small></p><p>A new <code>vector</code> index type has been added as an experimental feature.
See this <a href=https://arangodb.com/2024/11/vector-search-in-arangodb-practical-insights-and-hands-on-examples/ target=_blank rel="noopener noreferrer" class=link>blog post</a>&nbsp;<i class="fas fa-external-link-alt"></i>
for details.</p><h4 id=optimizer-rule-descriptions>Optimizer rule descriptions <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#optimizer-rule-descriptions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.10.9, v3.11.2</small></p><p>The <code>GET /_api/query/rules</code> endpoint now includes a <code>description</code> attribute for
every optimizer rule that briefly explains what it does.</p><h4 id=query-parsing-api>Query parsing API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#query-parsing-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <code>POST /_api/query</code> endpoint for parsing AQL queries now unconditionally
returns the <code>warnings</code> attribute, even if no warnings were produced while parsing
the query. In that case, <code>warnings</code> contains an empty array.
In previous versions, no <code>warnings</code> attribute was returned when parsing a query
produced no warnings.</p><h4 id=metrics-api>Metrics API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#metrics-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The metrics endpoint includes the following new metrics about AQL queries,
ongoing dumps, ArangoSearch parallelism and used file descriptors:</p><ul><li><code>arangodb_aql_cursors_active</code></li><li><code>arangodb_dump_memory_usage</code></li><li><code>arangodb_dump_ongoing</code></li><li><code>arangodb_dump_threads_blocked_total</code></li><li><code>arangodb_search_execution_threads_demand</code></li><li><code>arangodb_search_file_descriptors</code></li></ul><p>The following new metrics for improved memory observability have been added:</p><ul><li><code>arangodb_agency_node_memory_usage</code></li><li><code>arangodb_aql_cursors_memory_usage</code></li><li><code>arangodb_index_estimates_memory_usage</code></li><li><code>arangodb_internal_cluster_info_memory_usage</code></li><li><code>arangodb_requests_memory_usage</code></li><li><code>arangodb_revision_tree_buffered_memory_usage</code></li><li><code>arangodb_scheduler_queue_memory_usage</code></li><li><code>arangodb_scheduler_stack_memory_usage</code></li><li><code>arangodb_search_consolidations_memory_usage</code></li><li><code>arangodb_search_mapped_memory</code></li><li><code>arangodb_search_readers_memory_usage</code></li><li><code>arangodb_search_writers_memory_usage</code></li><li><code>arangodb_transactions_internal_memory_usage</code></li><li><code>arangodb_transactions_rest_memory_usage</code></li></ul><hr><p><small>Introduced in: v3.11.2</small></p><p>The following metrics have been added about the LZ4 compression for values in
the in-memory edge cache:</p><ul><li><code>rocksdb_cache_edge_inserts_effective_entries_size_total</code></li><li><code>rocksdb_cache_edge_inserts_uncompressed_entries_size_total</code></li><li><code>rocksdb_cache_edge_compression_ratio</code></li></ul><hr><p><small>Introduced in: v3.10.11, v3.11.4</small></p><p>The following metrics have been added to improve the observability of in-memory
cache subsystem:</p><ul><li><code>rocksdb_cache_free_memory_tasks_total</code></li><li><code>rocksdb_cache_free_memory_tasks_duration_total</code></li><li><code>rocksdb_cache_migrate_tasks_total</code></li><li><code>rocksdb_cache_migrate_tasks_duration_total</code></li></ul><hr><p><small>Introduced in: v3.11.4</small></p><p>The following metrics have been added to improve the observability of in-memory
edge cache:</p><ul><li><code>rocksdb_cache_edge_compressed_inserts_total</code></li><li><code>rocksdb_cache_edge_empty_inserts_total</code></li><li><code>rocksdb_cache_edge_inserts_total</code></li></ul><hr><p><small>Introduced in: v3.11.5</small></p><p>The following metrics have been added to monitor and detect temporary or
permanent connectivity issues as well as how many scheduler threads are in the
detached state:</p><ul><li><code>arangodb_network_connectivity_failures_coordinators</code></li><li><code>arangodb_network_connectivity_failures_dbservers_total</code></li><li><code>arangodb_scheduler_num_detached_threads</code></li></ul><hr><p><small>Introduced in: v3.10.13, v3.11.7</small></p><p>The following metrics have been introduced to track per-shard requests on
DB-Servers:</p><ul><li><code>arangodb_collection_leader_reads_total</code></li><li><code>arangodb_collection_leader_writes_total</code></li><li><code>arangodb_collection_requests_bytes_read_total</code></li><li><code>arangodb_collection_requests_bytes_written_total</code></li></ul><hr><p><small>Introduced in: v3.12.1</small></p><p>The following metrics have been added for observability:</p><ul><li><code>arangodb_vocbase_shards_read_only_by_write_concern</code></li><li><code>arangodb_logger_messages_dropped_total</code></li><li><code>arangodb_scheduler_high_prio_dequeue_hist</code></li><li><code>arangodb_scheduler_medium_prio_dequeue_hist</code></li><li><code>arangodb_scheduler_low_prio_dequeue_hist</code></li><li><code>arangodb_scheduler_maintenance_prio_dequeue_hist</code></li></ul><hr><p><small>Introduced in: v3.12.4</small></p><p>The following metric about partially committed or aborted transactions on
DB-Servers in a cluster has been added:</p><ul><li><code>arangodb_vocbase_transactions_lost_subordinates_total</code></li></ul><h4 id=stream-transactions-api>Stream Transactions API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#stream-transactions-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.1</small></p><p>A <code>skipFastLockRound</code> option has been added to the <code>POST /_api/transaction/begin</code>
endpoint that lets you disable the fast lock round for Stream Transactions.
The option defaults to <code>false</code> so that fast locking is tried.</p><p>See the <a href=/3.12/develop/http-api/transactions/stream-transactions/#begin-a-stream-transaction class=link>HTTP API</a>
for details.</p><h4 id=log-api-1>Log API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#log-api-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.2</small></p><p>The <code>GET /_admin/log/level</code> and <code>PUT /_admin/log/level</code> endpoints have been
extended with a <code>withAppenders</code> query option to let you query and set log level
settings for individual log outputs:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl http://localhost:8529/_admin/log/level?withAppenders<span class=o>=</span><span class=nb>true</span>
</span></span></code></pre></div><p>If enabled, the response structure is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;global&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;agency&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;agencycomm&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;agencystore&#34;</span><span class=p>:</span> <span class=s2>&#34;WARNING&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>...</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;appenders&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;-&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agency&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agencycomm&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agencystore&#34;</span><span class=p>:</span> <span class=s2>&#34;WARNING&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>...</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;file:///path/to/file&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agency&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agencycomm&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;agencystore&#34;</span><span class=p>:</span> <span class=s2>&#34;WARNING&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>...</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=err>...</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The keys under <code>appenders</code> correspond to the configured log outputs
(<code>--log.output</code> startup option, <code>-</code> stands for the standard output).
The <code>global</code> levels are automatically set to the most verbose log level for that
topic across all appenders.</p><p>To change any of the log levels at runtime, you can send a request following the
same structure:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>curl -XPUT -d <span class=s1>&#39;{&#34;global&#34;:{&#34;queries&#34;:&#34;DEBUG&#34;},&#34;appenders&#34;:{&#34;-&#34;:{&#34;requests&#34;:&#34;ERROR&#34;}}}&#39;</span> http://localhost:8529/_admin/log/level?withAppenders<span class=o>=</span><span class=nb>true</span>
</span></span></code></pre></div><p>Setting a global log level applies the value to all outputs for the specified
topic. You can only change the log levels for individual log outputs (appenders)
but not add new outputs at runtime.</p><h3 id=endpoints-deprecated>Endpoints deprecated <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#endpoints-deprecated class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=javascript-transactions-api>JavaScript Transactions API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#javascript-transactions-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>JavaScript Transactions and thus the <code>POST /_api/transaction</code> endpoint is
deprecated from v3.12.0 onward and will be removed in a future version.
The endpoints for Stream Transactions (<code>POST /_api/transaction/begin</code> etc.)
are unaffected.</p><h3 id=endpoints-removed>Endpoints removed <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#endpoints-removed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><h4 id=database-target-version-api>Database target version API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#database-target-version-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <code>GET /_admin/database/target-version</code> endpoint has been removed in favor of the
more general version API with the endpoint <code>GET /_api/version</code>.
The endpoint was deprecated since v3.11.3.</p><h4 id=javascript-based-traversal-using-_apitraversal>JavaScript-based traversal using <code>/_api/traversal</code> <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#javascript-based-traversal-using-_apitraversal class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The long-deprecated JavaScript-based traversal functionality has been removed
in v3.12.0, including the REST API endpoint <code>/_api/traversal</code>.</p><p>The functionality provided by this API was deprecated and unmaintained since
v3.4.0. JavaScript-based traversals have been replaced with AQL traversals in
v2.8.0. Additionally, the JavaScript-based traversal REST API could not handle
larger amounts of data and was thus very limited.</p><p>Users of the <code>/_api/traversal</code> REST API should use
<a href=/3.12/aql/graphs/traversals/ class=link>AQL traversal queries</a> instead.</p><h4 id=pregel-api>Pregel API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#pregel-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p>The <code>/_api/control_pregel/*</code> endpoints have been removed in v3.12.0 as Pregel
graph processing is no longer supported. The <code>arangodb_pregel_*</code> metrics and the
<code>pregel</code> log topic have been removed as well from the respective endpoints.</p><h4 id=batch-request-api>Batch request API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#batch-request-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Removed in: v3.12.3</small></p><p>The <code>/_api/batch</code> endpoints that let you send multiple operations in a single
HTTP request was deprecated in v3.8.0 and has now been removed.</p><p>To send multiple documents at once to an ArangoDB instance, please use the
<a href=/3.12/develop/http-api/documents/#multiple-document-operations class=link>HTTP interface for documents</a>
that can insert, update, replace, or remove arrays of documents.</p><h2 id=javascript-api>JavaScript API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#javascript-api class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><h3 id=collection-creation>Collection creation <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#collection-creation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>When creating a collection using the <code>db._create()</code>, <code>db._createDocumentCollection()</code>, or
<code>db._createEdgeCollection()</code> method, the server log now displays a deprecation message if illegal
combinations and unknown properties are detected in the <code>properties</code> object.</p><p>Note that all invalid elements and combinations will be rejected in future
versions.</p><h3 id=arangodbgraphtraversal-module><code>@arangodb/graph/traversal</code> module <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#arangodbgraphtraversal-module class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The long-deprecated JavaScript-based traversal functionality has been removed in
v3.12.0, including the bundled <code>@arangodb/graph/traversal</code> JavaScript module.</p><p>The functionality provided by this traversal module was deprecated and
unmaintained since v3.4.0. JavaScript-based traversals have been replaced with
AQL traversals in v2.8.0. Additionally, the JavaScript-based traversals could
not handle larger amounts of data and were thus very limited.</p><p>Users of the JavaScript-based traversal API should use
<a href=/3.12/aql/graphs/traversals/ class=link>AQL traversal queries</a> instead.</p><h3 id=collection-object><code>collection</code> object <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#collection-object class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The following methods now accept a <code>versionAttribute</code> option that adds external
versioning support:</p><ul><li><code>collection.update(object, data, options)</code></li><li><code>collection.replace(object, data, options)</code></li><li><code>collection.insert(data, options)</code> when used to update/replace a document</li></ul><p>If set, the attribute with the name specified by the option is looked up in the
stored document and the attribute value is compared numerically to the value of
the versioning attribute in the supplied document that is supposed to update/replace it.
The document is only changed if the new number is higher. See the
<a href=/3.12/develop/javascript-api/@arangodb/collection-object/#collectioninsertdata--options class=link>JavaScript API</a>
for details.</p><h3 id=arangodbpregel-removed><code>@arangodb/pregel</code> removed <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#arangodbpregel-removed class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <code>@arangodb/pregel</code> module of the JavaScript API has been removed in v3.12.0
as Pregel is no longer supported.</p><h3 id=db_executetransaction-deprecated><code>db._executeTransaction()</code> deprecated <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#db_executetransaction-deprecated class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>JavaScript Transactions and thus the <code>db._executeTransaction()</code> method is
deprecated from v3.12.0 onward and will be removed in a future version.
The <code>db._createTransaction()</code> method for starting Stream Transactions is unaffected.</p><h3 id=arangodbrequest-certificate-validation><code>@arangodb/request</code> certificate validation <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#arangodbrequest-certificate-validation class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.11.11, v3.12.2</small></p><p>The <code>@arangodb/request</code> module now supports two additional options for making
HTTPS requests:</p><ul><li><code>verifyCertificates</code> (optional): if set to <code>true</code>, the server certificate of
the remote server is verified using the default certificate store of the system.
Default: <code>false</code>.</li><li><code>verifyDepth</code> (optional): limit the maximum length of the certificate chain
that counts as valid. Default: <code>10</code>.</li></ul><h3 id=stream-transactions-api-1>Stream Transactions API <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#stream-transactions-api-1 class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p><small>Introduced in: v3.12.1</small></p><p>A <code>skipFastLockRound</code> option has been added to the <code>db._createTransaction()</code>
method that lets you disable the fast lock round for Stream Transactions.
The option defaults to <code>false</code> so that fast locking is tried.</p><p>See the <a href=/3.12/develop/transactions/stream-transactions/#javascript-api class=link>JavaScript API</a>
for details.</p><h4 id=query-plan-cache-module>Query plan cache module <a href=/3.12/release-notes/version-3.12/api-changes-in-3-12/#query-plan-cache-module class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h4><p><small>Introduced in: v3.12.4</small></p><p>The new <code>@arangodb/aql/plan-cache</code> module lets you list the entries (<code>.toArray()</code>)
and clear (<code>.clear()</code>) the AQL execution plan cache in the JavaScript API.</p><p>See <a href=/3.12/aql/execution-and-performance/caching-query-plans/#interfaces class=link>The execution plan cache for AQL queries</a>
for details.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.12/release-notes/version-3.12/incompatible-changes-in-3-12/><i class="fas fa-chevron-left fa-fw"></i><p>Incompatible changes in 3.12</p></a></span><span class=next><a class="nav nav-next link" href=/3.12/release-notes/version-3.11/><p>Version 3.11</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.12/release-notes/version-3.12/api-changes-in-3-12.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#http-restful-api>HTTP RESTful API</a></div><div class=level-3><a href=#behavior-changes>Behavior changes</a></div><div class=level-4><a href=#velocystream-protocol-removed>VelocyStream protocol removed</a></div><div class=level-4><a href=#http-headers>HTTP headers</a></div><div class=level-4><a href=#--databaseextended-names-enabled-by-default><code>--database.extended-names</code> enabled by default</a></div><div class=level-4><a href=#collection-api>Collection API</a></div><div class=level-4><a href=#index-api>Index API</a></div><div class=level-5><a href=#stored-values-can-contain-the-_id-attribute>Stored values can contain the <code>_id</code> attribute</a></div><div class=level-4><a href=#optimizer-rule-changes>Optimizer rule changes</a></div><div class=level-4><a href=#gharial-api>Gharial API</a></div><div class=level-4><a href=#validation-of-smartgraphattribute-in-smartgraphs>Validation of <code>smartGraphAttribute</code> in SmartGraphs</a></div><div class=level-4><a href=#limit-to-the-number-of-databases-in-a-deployment>Limit to the number of databases in a deployment</a></div><div class=level-4><a href=#adjustable-stream-transaction-size>Adjustable Stream Transaction size</a></div><div class=level-4><a href=#analyzer-api>Analyzer API</a></div><div class=level-4><a href=#adjustable-writeconcern-for-collections-with-distributeshardslike>Adjustable <code>writeConcern</code> for collections with <code>distributeShardsLike</code></a></div><div class=level-4><a href=#log-api>Log API</a></div><div class=level-4><a href=#error-code-12-removed>Error code <code>12</code> removed</a></div><div class=level-4><a href=#mmap-log-topic-removed><code>mmap</code> log topic removed</a></div><div class=level-3><a href=#endpoint-return-value-changes>Endpoint return value changes</a></div><div class=level-4><a href=#storage-engine-api>Storage engine API</a></div><div class=level-3><a href=#endpoints-added>Endpoints added</a></div><div class=level-4><a href=#effective-and-available-startup-options>Effective and available startup options</a></div><div class=level-4><a href=#available-key-generators>Available key generators</a></div><div class=level-4><a href=#shard-usage-metrics>Shard usage metrics</a></div><div class=level-4><a href=#reset-log-levels>Reset log levels</a></div><div class=level-4><a href=#query-plan-cache-api>Query plan cache API</a></div><div class=level-3><a href=#endpoints-augmented>Endpoints augmented</a></div><div class=level-4><a href=#view-api>View API</a></div><div class=level-4><a href=#document-api>Document API</a></div><div class=level-4><a href=#cursor-api>Cursor API</a></div><div class=level-5><a href=#documentlookups-and-seeks-statistics><code>documentLookups</code> and <code>seeks</code> statistics</a></div><div class=level-4><a href=#query-plan-cache-attributes>Query plan cache attributes</a></div><div class=level-4><a href=#index-api-1>Index API</a></div><div class=level-5><a href=#optimizetopk-for-inverted-indexes><code>optimizeTopK</code> for inverted indexes</a></div><div class=level-5><a href=#multi-dimensional-indexes>Multi-dimensional indexes</a></div><div class=level-5><a href=#progress-indication-on-the-index-generation>Progress indication on the index generation</a></div><div class=level-4><a href=#vector-indexes-experimental>Vector indexes (experimental)</a></div><div class=level-4><a href=#optimizer-rule-descriptions>Optimizer rule descriptions</a></div><div class=level-4><a href=#query-parsing-api>Query parsing API</a></div><div class=level-4><a href=#metrics-api>Metrics API</a></div><div class=level-4><a href=#stream-transactions-api>Stream Transactions API</a></div><div class=level-4><a href=#log-api-1>Log API</a></div><div class=level-3><a href=#endpoints-deprecated>Endpoints deprecated</a></div><div class=level-4><a href=#javascript-transactions-api>JavaScript Transactions API</a></div><div class=level-3><a href=#endpoints-removed>Endpoints removed</a></div><div class=level-4><a href=#database-target-version-api>Database target version API</a></div><div class=level-4><a href=#javascript-based-traversal-using-_apitraversal>JavaScript-based traversal using <code>/_api/traversal</code></a></div><div class=level-4><a href=#pregel-api>Pregel API</a></div><div class=level-4><a href=#batch-request-api>Batch request API</a></div><div class=level-2><a href=#javascript-api>JavaScript API</a></div><div class=level-3><a href=#collection-creation>Collection creation</a></div><div class=level-3><a href=#arangodbgraphtraversal-module><code>@arangodb/graph/traversal</code> module</a></div><div class=level-3><a href=#collection-object><code>collection</code> object</a></div><div class=level-3><a href=#arangodbpregel-removed><code>@arangodb/pregel</code> removed</a></div><div class=level-3><a href=#db_executetransaction-deprecated><code>db._executeTransaction()</code> deprecated</a></div><div class=level-3><a href=#arangodbrequest-certificate-validation><code>@arangodb/request</code> certificate validation</a></div><div class=level-3><a href=#stream-transactions-api-1>Stream Transactions API</a></div><div class=level-4><a href=#query-plan-cache-module>Query plan cache module</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>