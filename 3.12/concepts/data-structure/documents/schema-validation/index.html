<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1743774193></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="How to enforce attributes and their data types for documents of individual collections using JSON Schema"><meta property="og:url" content="http://localhost/3.12/concepts/data-structure/documents/schema-validation/"><meta property="og:title" content="Schema Validation"><meta property="og:type" content="website"><meta property="og:description" content="How to enforce attributes and their data types for documents of individual collections using JSON Schema"><meta name=docsearch:version content="3.12"><title>Schema Validation | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1743774193 defer></script>
<script src=/js/featherlight.min.js?1743774193 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"},{alias:"3.11",deprecated:!1,name:"3.11",version:"3.11.13"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.4"}</script><script src=/js/codeblocks.js?1743774193 defer></script>
<script src=/js/theme.js?1743774193 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.12"><a itemprop=item class=link href=/3.12/><span itemprop=name class=breadcrumb-entry>3.12.4</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Concepts"><a itemprop=item class=link href=/3.12/concepts/><span itemprop=name class=breadcrumb-entry>Concepts</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Data Structure"><a itemprop=item class=link href=/3.12/concepts/data-structure/><span itemprop=name class=breadcrumb-entry>Data Structure</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Documents"><a itemprop=item class=link href=/3.12/concepts/data-structure/documents/><span itemprop=name class=breadcrumb-entry>Documents</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Schema Validation"><a itemprop=item class=link href=/3.12/concepts/data-structure/documents/schema-validation/><span itemprop=name class=breadcrumb-entry>Schema Validation</span></a></li></ol></nav><article class=default><hgroup><h1>Schema Validation</h1><p class=lead>How to enforce attributes and their data types for documents of individual collections using JSON Schema</p></hgroup><p>While ArangoDB is schema-less, it allows to enforce certain document structures
on the collection level. The desired structure can be described in the popular
<a href=https://json-schema.org/ target=_blank rel="noopener noreferrer" class=link>JSON Schema</a>&nbsp;<i class="fas fa-external-link-alt"></i> format (draft-4, without support for
remote schemas for security reasons). The level of validation and a custom error
message can be configured. The system attributes <code>_key</code>, <code>_id</code>, <code>_rev</code>, <code>_from</code>
and <code>_to</code> are ignored by the schema validation.</p><h2 id=enable-schema-validation-for-a-collection>Enable schema validation for a collection <a href=/3.12/concepts/data-structure/documents/schema-validation/#enable-schema-validation-for-a-collection class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Schema validation can be managed via the JavaScript API, typically
using <em>arangosh</em>, as well as via the HTTP interface.</p><p>To enable schema validation either pass the <code>schema</code> property on collection
creation or when updating the properties of an existing collection. It expects an
object with the following attributes: <code>rule</code>, <code>level</code> and <code>message</code>.</p><ul><li>The <code>rule</code> attribute must contain the JSON Schema description.</li><li><code>level</code> controls when the validation is applied.</li><li><code>message</code> sets the message that is used when validation fails.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>schema</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>rule</span><span class=o>:</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=nx>properties</span><span class=o>:</span> <span class=p>{</span> <span class=nx>nums</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;array&#34;</span><span class=p>,</span> <span class=nx>items</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;number&#34;</span><span class=p>,</span> <span class=nx>maximum</span><span class=o>:</span> <span class=mi>6</span> <span class=p>}</span> <span class=p>}</span> <span class=p>},</span> 
</span></span><span class=line><span class=cl>    <span class=nx>additionalProperties</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;string&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>required</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;nums&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>level</span><span class=o>:</span> <span class=s2>&#34;moderate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>message</span><span class=o>:</span> <span class=s2>&#34;The document does not contain an array of numbers in attribute &#39;nums&#39;, or one of the numbers is greater than 6.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Create a new collection with schema */</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>_create</span><span class=p>(</span><span class=s2>&#34;schemaCollection&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=s2>&#34;schema&#34;</span><span class=o>:</span> <span class=nx>schema</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Update the schema of an existing collection */</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>schemaCollection</span><span class=p>.</span><span class=nx>properties</span><span class=p>({</span> <span class=s2>&#34;schema&#34;</span><span class=o>:</span> <span class=nx>schema</span> <span class=p>});</span></span></span></code></pre></div><p>To remove an existing schema from a collection, a schema value of either <code>null</code>
or <code>{}</code> (empty object) can be stored:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/* Remove the schema of an existing collection */</span>
</span></span><span class=line><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>schemaCollection</span><span class=p>.</span><span class=nx>properties</span><span class=p>({</span> <span class=s2>&#34;schema&#34;</span><span class=o>:</span> <span class=kc>null</span> <span class=p>});</span></span></span></code></pre></div><h2 id=json-schema-rule>JSON Schema Rule <a href=/3.12/concepts/data-structure/documents/schema-validation/#json-schema-rule class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The <code>rule</code> must be a valid JSON Schema object as outlined in the
<a href=https://json-schema.org/specification.html target=_blank rel="noopener noreferrer" class=link>specification</a>&nbsp;<i class="fas fa-external-link-alt"></i>.
See <a href=https://json-schema.org/understanding-json-schema/reference/object.html target=_blank rel="noopener noreferrer" class=link>Understanding JSON Schema</a>&nbsp;<i class="fas fa-external-link-alt"></i>
for a user guide on how to write JSON Schema descriptions.</p><p>System attributes are invisible to the schema validation, i.e. <code>_key</code>, <code>_rev</code> and <code>_id</code>
(in edge collections additionally <code>_from</code> and <code>_to</code>) do not need to be
specified in the schema. You may set <code>additionalProperties: false</code> to only
allow attributes described by the schema. System attributes do not fall under
this restriction.</p><p>Attributes with numeric values always have the type <code>"number"</code>, even if they are
whole numbers (and internally use an <code>integer</code> type). If you want to restrict an
attribute to integer values, use <code>"type": "number"</code> together with <code>"multipleOf": 1</code>.</p><div class="box notices cstyle security"><div class=box-content-container><div class=box-content><i class="fas fa-shield-alt"></i><div class=box-text>Remote schemas are not supported for security reasons.</div></div></div></div><h2 id=levels>Levels <a href=/3.12/concepts/data-structure/documents/schema-validation/#levels class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The level controls when the validation is triggered:</p><ul><li><code>none</code>: The rule is inactive and validation thus turned off.</li><li><code>new</code>: Only newly inserted documents are validated.</li><li><code>moderate</code>: New and modified documents must pass validation, except for
modified documents where the OLD value did not pass validation already.
This level is useful if you have documents which do not match your target
structure, but you want to stop the insertion of more invalid documents
and prohibit that valid documents are changed to invalid documents.</li><li><code>strict</code>: All new and modified document must strictly pass validation.
No exceptions are made (default).</li></ul><h2 id=error-message>Error message <a href=/3.12/concepts/data-structure/documents/schema-validation/#error-message class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>If the schema validation for a document fails, then a generic error is raised.
You may customize the error message via the <code>message</code> attribute to provide a
summary of what the expected document structure is or point out common mistakes.</p><p>The schema validation cannot pin-point which part of a rule made it fail because
it is difficult to determine and report for complex schemas. For example, when
using <code>not</code> and <code>anyOf</code>, this would result in trees of possible errors. You can
use tools like <a href=https://www.jsonschemavalidator.net/ target=_blank rel="noopener noreferrer" class=link>jsonschemavalidator.net</a>&nbsp;<i class="fas fa-external-link-alt"></i>
to examine schema validation issues.</p><h2 id=performance>Performance <a href=/3.12/concepts/data-structure/documents/schema-validation/#performance class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The schema validation is executed for data-modification operations according
to the levels described above. That means that it can slow down document
write operations, with more complex schemas typically taking more time for the
validation than very simple schemas.</p><h2 id=related-aql-functions>Related AQL functions <a href=/3.12/concepts/data-structure/documents/schema-validation/#related-aql-functions class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>The following AQL functions are available to work with schemas:</p><ul><li><a href=/3.12/aql/functions/miscellaneous/#schema_get class=link><code>SCHEMA_GET()</code></a></li><li><a href=/3.12/aql/functions/miscellaneous/#schema_validate class=link><code>SCHEMA_VALIDATE()</code></a></li></ul><h2 id=backup-and-restore>Backup and restore <a href=/3.12/concepts/data-structure/documents/schema-validation/#backup-and-restore class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Logical backups created with arangodump include the schema configuration, which
is a collection property.</p><p>When using arangorestore to restore to a collection with a defined schema,
no schema validation is executed.</p><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.12/concepts/data-structure/documents/><i class="fas fa-chevron-left fa-fw"></i><p>Documents</p></a></span><span class=next><a class="nav nav-next link" href=/3.12/concepts/data-structure/documents/computed-values/><p>Computed Values</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.12/concepts/data-structure/documents/schema-validation.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#enable-schema-validation-for-a-collection>Enable schema validation for a collection</a></div><div class=level-2><a href=#json-schema-rule>JSON Schema Rule</a></div><div class=level-2><a href=#levels>Levels</a></div><div class=level-2><a href=#error-message>Error message</a></div><div class=level-2><a href=#performance>Performance</a></div><div class=level-2><a href=#related-aql-functions>Related AQL functions</a></div><div class=level-2><a href=#backup-and-restore>Backup and restore</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>